<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>大数据 | VitePress</title>
    <meta name="description" content="A VitePress site">
    <link rel="stylesheet" href="/assets/style.ef7d46a0.css">
    <link rel="modulepreload" href="/assets/app.303cfecc.js">
    <link rel="modulepreload" href="/assets/study_bigdata_hdfs.md.35a7c82b.lean.js">
    
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <link rel="icon" href="/logo/vuetom-logo-m.png">
  <script></script>
  <script>(()=>{const e=["en-US","zh-CN"],t="vuetom_langs";localStorage.setItem(t,e)})();</script>
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-7722a5de><!--[--><!--]--><!--[--><span tabindex="-1" data-v-f44f02cf></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-f44f02cf> Skip to content </a><!--]--><!----><header class="VPNav" data-v-7722a5de data-v-fba0b3bf><div class="VPNavBar has-sidebar" data-v-fba0b3bf data-v-b72e200f><div class="container" data-v-b72e200f><div class="VPNavBarTitle has-sidebar" data-v-b72e200f data-v-f6bacefc><a class="title" href="/" data-v-f6bacefc><!--[--><!--]--><!----><!--[-->Laoshiren<!--]--><!--[--><!--]--></a></div><div class="content" data-v-b72e200f><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-b72e200f data-v-91256c89><span id="main-nav-aria-label" class="visually-hidden" data-v-91256c89>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="https://www.coderutil.com/" target="_blank" rel="noreferrer" data-v-91256c89 data-v-49b08bb6 data-v-139df792><!--[-->工具<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="https://www.1024bugs.com/" target="_blank" rel="noreferrer" data-v-91256c89 data-v-49b08bb6 data-v-139df792><!--[-->1024bugs<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="https://gitee.com/laoshiren1207" target="_blank" rel="noreferrer" data-v-91256c89 data-v-49b08bb6 data-v-139df792><!--[-->gitee<!--]--><!----></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-91256c89 data-v-a3bb6148><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-a3bb6148><span class="text" data-v-a3bb6148><!----> 外链 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-a3bb6148><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-a3bb6148><div class="VPMenu" data-v-a3bb6148 data-v-e0682420><div class="items" data-v-e0682420><!--[--><!--[--><div class="VPMenuGroup" data-v-e0682420 data-v-23b908db><!----><!--[--><!--[--><div class="VPMenuLink" data-v-23b908db data-v-63d68121><a class="VPLink link" href="https://www.baidu.com" target="_blank" rel="noreferrer" data-v-63d68121 data-v-139df792><!--[-->baidu<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-139df792><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-e0682420 data-v-23b908db><!----><!--[--><!--[--><div class="VPMenuLink" data-v-23b908db data-v-63d68121><a class="VPLink link" href="https://blog.csdn.net/weixin_42126468/" target="_blank" rel="noreferrer" data-v-63d68121 data-v-139df792><!--[-->csdn<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-139df792><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-23b908db data-v-63d68121><a class="VPLink link" href="https://space.bilibili.com/38038619" target="_blank" rel="noreferrer" data-v-63d68121 data-v-139df792><!--[-->bilibili<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-139df792><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-b72e200f data-v-fad7ddb9 data-v-a3bb6148><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-a3bb6148><span class="text" data-v-a3bb6148><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="option-icon" data-v-a3bb6148><path d="M0 0h24v24H0z" fill="none"></path><path d=" M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z " class="css-c4d79v"></path></svg>  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-a3bb6148><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-a3bb6148><div class="VPMenu" data-v-a3bb6148 data-v-e0682420><!----><!--[--><!--[--><div class="items" data-v-fad7ddb9><p class="title" data-v-fad7ddb9></p><!--[--><div class="VPMenuLink" data-v-fad7ddb9 data-v-63d68121><a class="VPLink link" href="/lang/zhcn.html" data-v-63d68121 data-v-139df792><!--[-->中文<!--]--><!----></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-b72e200f data-v-d1cba5ce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-d1cba5ce data-v-1917559d data-v-3a7122ab><span class="check" data-v-3a7122ab><span class="icon" data-v-3a7122ab><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-1917559d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-1917559d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-b72e200f data-v-4567f370 data-v-5bc35202><!--[--><a class="VPSocialLink" href="https://www.github.com/laoShiRen1207" target="_blank" rel="noopener" data-v-5bc35202 data-v-59463879><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-b72e200f data-v-4730c33e data-v-a3bb6148><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-a3bb6148><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-a3bb6148><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-a3bb6148><div class="VPMenu" data-v-a3bb6148 data-v-e0682420><!----><!--[--><!--[--><div class="group" data-v-4730c33e><p class="trans-title" data-v-4730c33e></p><!--[--><div class="VPMenuLink" data-v-4730c33e data-v-63d68121><a class="VPLink link" href="/lang/zhcn.html" data-v-63d68121 data-v-139df792><!--[-->中文<!--]--><!----></a></div><!--]--></div><div class="group" data-v-4730c33e><div class="item appearance" data-v-4730c33e><p class="label" data-v-4730c33e>Appearance</p><div class="appearance-action" data-v-4730c33e><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-4730c33e data-v-1917559d data-v-3a7122ab><span class="check" data-v-3a7122ab><span class="icon" data-v-3a7122ab><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-1917559d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-1917559d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-4730c33e><div class="item social-links" data-v-4730c33e><div class="VPSocialLinks social-links-list" data-v-4730c33e data-v-5bc35202><!--[--><a class="VPSocialLink" href="https://www.github.com/laoShiRen1207" target="_blank" rel="noopener" data-v-5bc35202 data-v-59463879><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-b72e200f data-v-96835b0d><span class="container" data-v-96835b0d><span class="top" data-v-96835b0d></span><span class="middle" data-v-96835b0d></span><span class="bottom" data-v-96835b0d></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-7722a5de data-v-e5e51a13><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-e5e51a13><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-e5e51a13><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-e5e51a13>Menu</span></button><a class="top-link" href="#" data-v-e5e51a13> Return to top </a></div><aside class="VPSidebar" data-v-7722a5de data-v-db43be72><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-db43be72><span class="visually-hidden" id="sidebar-aria-label" data-v-db43be72> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-db43be72><section class="VPSidebarGroup" data-v-db43be72 data-v-ee945d82><div class="title" data-v-ee945d82><h2 class="title-text" data-v-ee945d82>JavaSe</h2><div class="action" data-v-ee945d82><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-ee945d82><!--[--><!--[--><a class="VPLink link link" href="/study/java/base.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>基础</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/java/lock.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>lock</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/java/pattern.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>设计模式</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/java/feature.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>新特性</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/java/thread.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>多线程</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-db43be72><section class="VPSidebarGroup" data-v-db43be72 data-v-ee945d82><div class="title" data-v-ee945d82><h2 class="title-text" data-v-ee945d82>框架 framework</h2><div class="action" data-v-ee945d82><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-ee945d82><!--[--><!--[--><a class="VPLink link link" href="/study/framework/spring%E7%AC%AC1%E8%AE%B2.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>Spring第1讲</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/framework/spring%E7%AC%AC2%E8%AE%B2.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>Spring第2讲</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/framework/spring%E7%AC%AC3%E8%AE%B2.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>Spring第3讲</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/framework/spring%E7%AC%AC4%E8%AE%B2.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>Spring第4讲</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/framework/spring%E7%AC%AC5%E8%AE%B2.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>Spring第5讲</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/framework/spring%E7%AC%AC6%E8%AE%B2.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>Spring第6讲</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/framework/spring%E7%AC%AC7%E8%AE%B2.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>Spring第7讲</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/framework/spring%E7%AC%AC8%E8%AE%B2.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>Spring第8讲</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/framework/%E6%89%8B%E5%86%99%E4%B8%80%E4%B8%AAspring%E9%A1%B9%E7%9B%AE.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>Spring最终讲-手写</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/framework/mybatis%E7%AC%AC1%E8%AE%B2.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>Mybatis第1讲</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-db43be72><section class="VPSidebarGroup" data-v-db43be72 data-v-ee945d82><div class="title" data-v-ee945d82><h2 class="title-text" data-v-ee945d82>数据库</h2><div class="action" data-v-ee945d82><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-ee945d82><!--[--><!--[--><a class="VPLink link link" href="/study/database/mysql.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>mysql</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/database/redis.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>redis</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/database/es.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>elsatic search</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-db43be72><section class="VPSidebarGroup collapsible" data-v-db43be72 data-v-ee945d82><div class="title" role="button" data-v-ee945d82><h2 class="title-text" data-v-ee945d82>中间件</h2><div class="action" data-v-ee945d82><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-ee945d82><!--[--><!--[--><a class="VPLink link link" href="/study/middleware/mq.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>消息中间件</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/middleware/database-sharding-jdbc.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>分库分表中间件</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/middleware/flowable.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>flowable 工作流</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-db43be72><section class="VPSidebarGroup collapsible" data-v-db43be72 data-v-ee945d82><div class="title" role="button" data-v-ee945d82><h2 class="title-text" data-v-ee945d82>微服务</h2><div class="action" data-v-ee945d82><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-ee945d82><!--[--><!--[--><a class="VPLink link link" href="/study/cloud/index.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>微服务 - NETFILX</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/alibaba/index.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>微服务 - Alibaba</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-db43be72><section class="VPSidebarGroup collapsible" data-v-db43be72 data-v-ee945d82><div class="title" role="button" data-v-ee945d82><h2 class="title-text" data-v-ee945d82>容器化技术</h2><div class="action" data-v-ee945d82><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-ee945d82><!--[--><!--[--><a class="VPLink link link" href="/study/docker/index.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>docker</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-db43be72><section class="VPSidebarGroup collapsible" data-v-db43be72 data-v-ee945d82><div class="title" role="button" data-v-ee945d82><h2 class="title-text" data-v-ee945d82>JVM</h2><div class="action" data-v-ee945d82><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-ee945d82><!--[--><!--[--><a class="VPLink link link" href="/jvm/JVM01.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>JMM 内存管理</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-db43be72><section class="VPSidebarGroup collapsible" data-v-db43be72 data-v-ee945d82><div class="title" role="button" data-v-ee945d82><h2 class="title-text" data-v-ee945d82>大数据</h2><div class="action" data-v-ee945d82><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-ee945d82><!--[--><!--[--><a class="VPLink link link" href="/study/bigdata/datawarehouse.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>datawarehouse</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link active" href="/study/bigdata/hdfs.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>hdfs-hadoop</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-db43be72><section class="VPSidebarGroup collapsible" data-v-db43be72 data-v-ee945d82><div class="title" role="button" data-v-ee945d82><h2 class="title-text" data-v-ee945d82>算法</h2><div class="action" data-v-ee945d82><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-ee945d82><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-ee945d82><!--[--><!--[--><a class="VPLink link link" href="/study/algorithm/CommonAlgorithm.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>基础算法</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/study/algorithm/DP.html" style="padding-left:0px;" data-v-342a9b7e data-v-139df792><!--[--><span class="link-text" data-v-342a9b7e>动态规划</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-7722a5de data-v-abf49011><div class="VPDoc has-sidebar has-aside" data-v-abf49011 data-v-985bfe51><div class="container" data-v-985bfe51><div class="aside" data-v-985bfe51><div class="aside-curtain" data-v-985bfe51></div><div class="aside-container" data-v-985bfe51><div class="aside-content" data-v-985bfe51><div class="VPDocAside" data-v-985bfe51 data-v-a3717247><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-a3717247 data-v-a70227cd><div class="content" data-v-a70227cd><div class="outline-marker" data-v-a70227cd></div><div class="outline-title" data-v-a70227cd>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-a70227cd><span class="visually-hidden" id="doc-outline-aria-label" data-v-a70227cd> Table of Contents for current page </span><ul class="root" data-v-a70227cd data-v-0b0b7e64><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-a3717247></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-985bfe51><div class="content-container" data-v-985bfe51><!--[--><!--]--><main class="main" data-v-985bfe51><div style="position:relative;" class="vp-doc _study_bigdata_hdfs" data-v-985bfe51><div><h1 id="大数据" tabindex="-1">大数据 <a class="header-anchor" href="#大数据" aria-hidden="true">#</a></h1><nav class="table-of-contents"><ul><li><a href="#大数据4大特点">大数据4大特点</a></li><li><a href="#_1-概念">1 概念</a><ul><li><a href="#_1-1-hadoop-是什么">1.1 Hadoop 是什么？</a></li><li><a href="#_1-2-hadoop-的优势-4高">1.2 Hadoop 的优势(4高)</a></li><li><a href="#_1-3-hadoop-的组成">1.3 Hadoop 的组成</a></li><li><a href="#_1-4-大数据技术生态体系">1.4 大数据技术生态体系</a></li></ul></li><li><a href="#_2-生产集群搭建">2 生产集群搭建</a><ul><li><a href="#_2-1-准备工作">2.1 准备工作</a></li><li><a href="#_2-2-本地模式">2.2 本地模式</a></li><li><a href="#_2-3-完全分布式集群">2.3 完全分布式集群</a></li></ul></li><li><a href="#hdfs-产生背景">hdfs 产生背景</a><ul><li><a href="#hdfs-优缺点">hdfs 优缺点</a></li><li><a href="#组成">组成</a></li><li><a href="#文件块大小问题">文件块大小问题</a></li></ul></li><li><a href="#hdfs的shell相关操作">HDFS的shell相关操作</a><ul><li><a href="#基本语法">基本语法</a></li><li><a href="#命令大全">命令大全</a></li></ul></li><li><a href="#hdfs的客户端api">HDFS的客户端API</a><ul><li><a href="#依赖">依赖</a></li><li><a href="#基础配置">基础配置</a></li><li><a href="#创建文件夹">创建文件夹</a></li><li><a href="#上传文件">上传文件</a></li><li><a href="#下载文件">下载文件</a></li><li><a href="#删除文件">删除文件</a></li><li><a href="#文件重命名和移动">文件重命名和移动</a></li><li><a href="#文件详情查看">文件详情查看</a></li></ul></li><li><a href="#hdfs读写流程">HDFS读写流程</a><ul><li><a href="#hdfs的写数据流程">HDFS的写数据流程</a></li><li><a href="#hdfs的读数据流程">HDFS的读数据流程</a></li></ul></li><li><a href="#nn和2nn工作原理">NN和2NN工作原理</a><ul><li><a href="#工作机制">工作机制</a></li><li><a href="#fsimage和edits解析">Fsimage和Edits解析</a></li></ul></li><li><a href="#datanode工作机制">DataNode工作机制</a></li><li><a href="#mapreduce-概述">MapReduce 概述</a><ul><li><a href="#mapreduce-定义">MapReduce 定义</a></li><li><a href="#mapreduce-优缺点">MapReduce 优缺点</a></li><li><a href="#mapreduce-核心思想">MapReduce 核心思想</a></li><li><a href="#mapreduce-进程">MapReduce 进程</a></li><li><a href="#官方-wordcount-源码">官方 WordCount 源码</a></li><li><a href="#mapreduce-编程规范">MapReduce 编程规范</a></li></ul></li><li><a href="#序列化">序列化</a><ul><li><a href="#自定义序列化">自定义序列化</a></li></ul></li><li><a href="#mapreduce框架原理">MapReduce框架原理</a><ul><li><a href="#inputformat-数据输入">InputFormat 数据输入</a></li><li><a href="#mapreduce-工作流程">MapReduce 工作流程</a></li><li><a href="#mapreduce开发总结">MapReduce开发总结</a></li></ul></li><li><a href="#压缩">压缩</a><ul><li><a href="#mapper-压缩">Mapper 压缩</a></li><li><a href="#reduce压缩">Reduce压缩</a></li></ul></li><li><a href="#yarn-基础架构">Yarn 基础架构</a></li><li><a href="#yarn工作机制">YARN工作机制</a></li><li><a href="#yarn-调度器和调度算法">Yarn 调度器和调度算法</a><ul><li><a href="#先进先出调度器-fifo">先进先出调度器（FIFO）</a></li><li><a href="#容量调度器-capacity-scheduler">容量调度器（Capacity Scheduler）</a></li><li><a href="#公平调度器-fair-scheduler">公平调度器（Fair Scheduler）</a></li></ul></li><li><a href="#yarn-常用命令">Yarn 常用命令</a></li><li><a href="#yarn-生产环境核心参数">Yarn 生产环境核心参数</a><ul><li><a href="#resourcemanager-相关">ResourceManager 相关</a></li><li><a href="#nodemanager-相关">NodeManager 相关</a></li><li><a href="#containe-相关">Containe 相关</a></li></ul></li><li><a href="#tools">Tools</a></li></ul></nav><h2 id="大数据4大特点" tabindex="-1">大数据4大特点 <a class="header-anchor" href="#大数据4大特点" aria-hidden="true">#</a></h2><ol><li><code>Volume </code>(海量数据存储)</li><li><code>Velocity</code>(高速)</li><li><code>Variety</code>(多样性)</li><li><code>Value</code>(低价值密度 - 数据清洗)</li></ol><p>平台</p><p><code>Hadoop</code>,<code>Flume</code>,<code>Kafka</code>,<code>HBase</code>,<code>Spark</code>的等框架的平台搭建，集群性能监控，集群新能调优。</p><p>数据仓库</p><p><code>ETL</code>数据清洗，数据分析，数仓建模</p><p>实时指标的分析性能调优，数据挖掘。</p><h1 id="hadoop" tabindex="-1">Hadoop <a class="header-anchor" href="#hadoop" aria-hidden="true">#</a></h1><p><a href="http://hadoop.apache.org/" target="_blank" rel="noreferrer">Hadoop 官网</a></p><h2 id="_1-概念" tabindex="-1">1 概念 <a class="header-anchor" href="#_1-概念" aria-hidden="true">#</a></h2><h3 id="_1-1-hadoop-是什么" tabindex="-1">1.1 Hadoop 是什么？ <a class="header-anchor" href="#_1-1-hadoop-是什么" aria-hidden="true">#</a></h3><p><code>Hadoop</code>是一个由<code>Apache</code>基金会所开发的<strong>分布式系统基础架构</strong>。主要解决海量数据的<strong>存储</strong>和<strong>分析计算</strong>问题。</p><p><code>Hadoop</code>通常是指一个更广泛的概念--<strong><code>Hadoop</code>生态圈</strong></p><p><img src="https://img-blog.csdnimg.cn/333ef0d516e94f89a22e7c313881f7f9.png" alt="在这里插入图片描述"></p><h3 id="_1-2-hadoop-的优势-4高" tabindex="-1">1.2 Hadoop 的优势(4高) <a class="header-anchor" href="#_1-2-hadoop-的优势-4高" aria-hidden="true">#</a></h3><ol><li>高可靠性:<code>Hadoop</code>底层维护了多个数据副本，所以即使<code>Hadoop</code>某个计算元素或存储出现故障，也不会导致数据丢失。</li><li>高扩展性:在集群分配任务数据，可方便的扩展数以千计的节点。</li><li>高效性:在<code>MapReduce</code>是并行工作的加快任务处理速度。</li><li>高容错性:能够自动的将失败的任务重新分配。</li></ol><h3 id="_1-3-hadoop-的组成" tabindex="-1">1.3 Hadoop 的组成 <a class="header-anchor" href="#_1-3-hadoop-的组成" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/504c33d9bcb640bca82852e9e38b7f02.png" alt="在这里插入图片描述"></p><h4 id="_1-3-1-hdfs-架构概述" tabindex="-1">1.3.1 HDFS 架构概述 <a class="header-anchor" href="#_1-3-1-hdfs-架构概述" aria-hidden="true">#</a></h4><p><code>Hadoop Distributed File System</code>简称<code>HDFS</code>，是一个分布式文件系统。</p><ol><li><code>NameNode</code>(<code>nn</code>): 存储文件的元数据如文件名，文件目录接口，文件属性，以及每个文件的<strong>块列表</strong>和**块所在的<code>DataNode</code>**等。</li><li><code>DataNode</code>(<code>dn</code>): 在本地文件系统<strong>存储文件块数据</strong>，以及<strong>块数据的校验和</strong>。</li><li><code>Secondary NameNode</code>(<code>2nn</code>): 每隔一段时间对<code>NameNode</code>数据据备份。</li></ol><h4 id="_1-3-2-yarn架构概述" tabindex="-1">1.3.2 Yarn架构概述 <a class="header-anchor" href="#_1-3-2-yarn架构概述" aria-hidden="true">#</a></h4><p><code>Yet Another Resource Negotiator</code> 简称<code>Yarn </code>是<code>Hadoop</code>的资源管理器(主要管理<code>CPU</code>和内存)。</p><ol><li><code>ResouceManager</code>(<code>RM</code>): 整个集群资源的管理者。</li><li><code>NodeManager</code>(<code>NM</code>): 单节点服务器管理者。</li><li><code>ApplicationMaster</code>(<code>AM</code>): 单个任务运行的老大。</li><li><code>Container</code>: 容器，相当于一台独立的服务器，里面封装了任务运行所需要的资源。</li></ol><p><img src="https://img-blog.csdnimg.cn/222d8fe9ac8440e594cd6aaa6ba44f8e.png" alt="在这里插入图片描述"></p><h4 id="_1-3-3-mapreduce架构概述" tabindex="-1">1.3.3 MapReduce架构概述 <a class="header-anchor" href="#_1-3-3-mapreduce架构概述" aria-hidden="true">#</a></h4><p><code>MapReduce</code>将计算分为两个阶段<code>Map</code>和<code>Reduce</code>。</p><ol><li><code>Map</code>阶段: 并行处理输入数据。</li><li><code>Reduce</code>阶段: 对<code>Map</code>结果进行汇总。</li></ol><h3 id="_1-4-大数据技术生态体系" tabindex="-1">1.4 大数据技术生态体系 <a class="header-anchor" href="#_1-4-大数据技术生态体系" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/683c98019a7d487eba94d9b95af505f8.png" alt="在这里插入图片描述"></p><p>推荐系统: 用户搜索/购买记录到日志，<code>Flume</code>采集对应的日志交给<code>Kafka</code>做缓冲，然后交给<code>Flink</code>做实时计算，计算完成存储成文件/数据库 推荐业务读取计算完成的结果返回给前端。</p><h2 id="_2-生产集群搭建" tabindex="-1">2 生产集群搭建 <a class="header-anchor" href="#_2-生产集群搭建" aria-hidden="true">#</a></h2><h3 id="_2-1-准备工作" tabindex="-1">2.1 准备工作 <a class="header-anchor" href="#_2-1-准备工作" aria-hidden="true">#</a></h3><p>正常安装<code>centos7.5</code>最小版</p><p>修改<code>ip</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">vi /etc/sysconfig/network-scripts/ifcfg-ens33</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/4783521ddb9748ca98f1f565d71b7d9a.png" alt="在这里插入图片描述"></p><p>修改<code>host</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">vi /etc/hostname</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>应用重启网络服务，如果报错就重启虚拟机<code>reboot</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">systemctl restart network</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>安装<code>epel-release</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">yum install -y epel-release</span></span>
<span class="line"><span style="color:#676E95;"># 还需要安装 net-tools</span></span>
<span class="line"><span style="color:#A6ACCD;">yum install -y net-tools</span></span>
<span class="line"><span style="color:#676E95;"># vim 编辑器</span></span>
<span class="line"><span style="color:#A6ACCD;">yum install -y vim </span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>关闭防火墙</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">systemctl stop firewalld</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl disable firewalld.service</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>安装<code>jdk</code>，解压配置</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">tar -zxvf jdk</span><span style="color:#89DDFF;">***</span><span style="color:#A6ACCD;">.tar.gz</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>进入<code>/etc/profile.d</code>，创建一个<code>shell</code>脚本，然后执行<code>source /etc/profile</code>。</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># Java_Home jdk 8</span></span>
<span class="line"><span style="color:#C792EA;">export</span><span style="color:#A6ACCD;"> JAVA_HOME=/home/module/jdk1.8.0_152</span></span>
<span class="line"><span style="color:#C792EA;">export</span><span style="color:#A6ACCD;"> PATH=</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">PATH:</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">JAVA_HOME/bin</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>检查<code>java</code>安装</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">java -version</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">## 打印 </span></span>
<span class="line"><span style="color:#A6ACCD;">java version </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.8.0_152</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Java</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">TM</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> SE Runtime Environment </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">build 1.8.0_152-b16</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">Java HotSpot</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">TM</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> 64-Bit Server VM </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">build 25.152-b16, mixed mode</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>无密登录</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">ssh-keygen -t rsa</span></span>
<span class="line"><span style="color:#A6ACCD;">ssh-copy-id ip</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_2-1-1-安装hadoop-3-1-3" tabindex="-1">2.1.1 安装Hadoop 3.1.3 <a class="header-anchor" href="#_2-1-1-安装hadoop-3-1-3" aria-hidden="true">#</a></h4><p>解压缩</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">tar -zxvf hadoop-3.1.3.tar.gz </span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>进入<code>/etc/profile.d</code>，创建一个<code>shell</code>脚本，然后执行<code>source /etc/profile</code>。</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">cat /etc/profile.d/my_hadoop_env.sh </span></span>
<span class="line"><span style="color:#676E95;">#Hadoop hadoop 3.1.3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">export</span><span style="color:#A6ACCD;"> HADOOP_HOME=/home/module/hadoop-3.1.3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">export</span><span style="color:#A6ACCD;"> PATH=</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">PATH:</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">HADOOP_HOME/bin</span></span>
<span class="line"><span style="color:#C792EA;">export</span><span style="color:#A6ACCD;"> PATH=</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">PATH:</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">HADOOP_HOME/sbin</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>检查<code>hadoop</code>安装</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop</span></span>
<span class="line"><span style="color:#676E95;"># 打印</span></span>
<span class="line"><span style="color:#A6ACCD;">Usage: hadoop </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">OPTIONS</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> SUBCOMMAND </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">SUBCOMMAND OPTIONS</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> or    hadoop </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">OPTIONS</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> CLASSNAME </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">CLASSNAME OPTIONS</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">  where CLASSNAME is a user-provided Java class</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  OPTIONS is none or any of:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">buildpaths                       attempt to add class files from build tree</span></span>
<span class="line"><span style="color:#A6ACCD;">--config dir                     Hadoop config directory</span></span>
<span class="line"><span style="color:#A6ACCD;">--debug                          turn on shell script debug mode</span></span>
<span class="line"><span style="color:#A6ACCD;">--help                           usage information</span></span>
<span class="line"><span style="color:#A6ACCD;">hostnames list</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">,of,host,names</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">   hosts to use </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> slave mode</span></span>
<span class="line"><span style="color:#A6ACCD;">hosts filename                   list of hosts to use </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> slave mode</span></span>
<span class="line"><span style="color:#A6ACCD;">loglevel level                   </span><span style="color:#82AAFF;">set</span><span style="color:#A6ACCD;"> the log4j level </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> this </span><span style="color:#82AAFF;">command</span></span>
<span class="line"><span style="color:#A6ACCD;">workers                          turn on worker mode</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  SUBCOMMAND is one of:</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    Admin Commands:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">daemonlog     get/set the log level </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> each daemon</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    Client Commands:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">archive       create a Hadoop archive</span></span>
<span class="line"><span style="color:#A6ACCD;">checknative   check native Hadoop and compression libraries availability</span></span>
<span class="line"><span style="color:#A6ACCD;">classpath     prints the class path needed to get the Hadoop jar and the required libraries</span></span>
<span class="line"><span style="color:#A6ACCD;">conftest      validate configuration XML files</span></span>
<span class="line"><span style="color:#A6ACCD;">credential    interact with credential providers</span></span>
<span class="line"><span style="color:#A6ACCD;">distch        distributed metadata changer</span></span>
<span class="line"><span style="color:#A6ACCD;">distcp        copy file or directories recursively</span></span>
<span class="line"><span style="color:#A6ACCD;">dtutil        operations related to delegation tokens</span></span>
<span class="line"><span style="color:#A6ACCD;">envvars       display computed Hadoop environment variables</span></span>
<span class="line"><span style="color:#A6ACCD;">fs            run a generic filesystem user client</span></span>
<span class="line"><span style="color:#A6ACCD;">gridmix       submit a mix of synthetic job, modeling a profiled from production load</span></span>
<span class="line"><span style="color:#A6ACCD;">jar </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">jar</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">     run a jar file. NOTE: please use </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">yarn jar</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> to launch YARN applications, not this command.</span></span>
<span class="line"><span style="color:#A6ACCD;">jnipath       prints the java.library.path</span></span>
<span class="line"><span style="color:#A6ACCD;">kdiag         Diagnose Kerberos Problems</span></span>
<span class="line"><span style="color:#A6ACCD;">kerbname      show auth_to_local principal conversion</span></span>
<span class="line"><span style="color:#A6ACCD;">key           manage keys via the KeyProvider</span></span>
<span class="line"><span style="color:#A6ACCD;">rumenfolder   scale a rumen input trace</span></span>
<span class="line"><span style="color:#A6ACCD;">rumentrace    convert logs into a rumen trace</span></span>
<span class="line"><span style="color:#A6ACCD;">s3guard       manage metadata on S3</span></span>
<span class="line"><span style="color:#A6ACCD;">trace         view and modify Hadoop tracing settings</span></span>
<span class="line"><span style="color:#A6ACCD;">version       print the version</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    Daemon Commands:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">kms           run KMS, the Key Management Server</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">SUBCOMMAND may print </span><span style="color:#82AAFF;">help</span><span style="color:#A6ACCD;"> when invoked w/o parameters or with -h.</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p>以上就算安装成功。</p><h4 id="_2-1-2-hadoop-目录内容" tabindex="-1">2.1.2 hadoop 目录内容 <a class="header-anchor" href="#_2-1-2-hadoop-目录内容" aria-hidden="true">#</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> hadoop-3.1.3</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@hadoop1207 hadoop-3.1.3</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># ll</span></span>
<span class="line"><span style="color:#A6ACCD;">总用量 180</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 2 1000 1000    183 9月  12 2019 bin</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 3 1000 1000     20 9月  12 2019 etc</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 2 1000 1000    106 9月  12 2019 include</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 3 1000 1000     20 9月  12 2019 lib</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 4 1000 1000   4096 9月  12 2019 libexec</span></span>
<span class="line"><span style="color:#A6ACCD;">-rw-rw-r--. 1 1000 1000 147145 9月   4 2019 LICENSE.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">-rw-rw-r--. 1 1000 1000  21867 9月   4 2019 NOTICE.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">-rw-rw-r--. 1 1000 1000   1366 9月   4 2019 README.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 3 1000 1000   4096 9月  12 2019 sbin</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 4 1000 1000     31 9月  12 2019 share</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>bin 目录</strong> 一些命令的文件目录</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> bin/</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@hadoop1207 bin</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># ll</span></span>
<span class="line"><span style="color:#A6ACCD;">总用量 996</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 441936 9月  12 2019 container-executor</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000   8707 9月  12 2019 hadoop</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000  11265 9月  12 2019 hadoop.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000  11026 9月  12 2019 hdfs  			</span><span style="color:#676E95;"># 和资源存储相关的命令</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000   8081 9月  12 2019 hdfs.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000   6237 9月  12 2019 mapred			</span><span style="color:#676E95;"># 和计算相关的命令</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000   6311 9月  12 2019 mapred.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 483728 9月  12 2019 test-container-executor</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000  11888 9月  12 2019 yarn				</span><span style="color:#676E95;"># 和资源调度相关的命令</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000  12840 9月  12 2019 yarn.cmd</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>etc/hadoop 目录</strong> 存储一些配置文件，配置<code>hdfs</code>,<code>mapre </code>,<code>yarn</code></p><p><strong>sbin 目录</strong> 存储一些启动脚本</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> sbin/</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@hadoop1207 sbin</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># ll</span></span>
<span class="line"><span style="color:#A6ACCD;">总用量 108</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 2756 9月  12 2019 distribute-exclude.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 4 1000 1000   36 9月  12 2019 FederationStateStore</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1983 9月  12 2019 hadoop-daemon.sh			</span><span style="color:#676E95;"># 单节点服务器</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 2522 9月  12 2019 hadoop-daemons.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1542 9月  12 2019 httpfs.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1500 9月  12 2019 kms.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1841 9月  12 2019 mr-jobhistory-daemon.sh	</span><span style="color:#676E95;"># 启动历史服务器</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 2086 9月  12 2019 refresh-namenodes.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1779 9月  12 2019 start-all.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 2221 9月  12 2019 start-all.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1880 9月  12 2019 start-balancer.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1401 9月  12 2019 start-dfs.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 5170 9月  12 2019 start-dfs.sh  				</span><span style="color:#676E95;"># hdfs集群的启动命令</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1793 9月  12 2019 start-secure-dns.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1571 9月  12 2019 start-yarn.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 3342 9月  12 2019 start-yarn.sh				</span><span style="color:#676E95;"># 资源调度器命令</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1770 9月  12 2019 stop-all.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 2166 9月  12 2019 stop-all.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1783 9月  12 2019 stop-balancer.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1455 9月  12 2019 stop-dfs.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 3898 9月  12 2019 stop-dfs.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1756 9月  12 2019 stop-secure-dns.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1642 9月  12 2019 stop-yarn.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 3083 9月  12 2019 stop-yarn.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1982 9月  12 2019 workers.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1814 9月  12 2019 yarn-daemon.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 2328 9月  12 2019 yarn-daemons.sh</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="_2-2-本地模式" tabindex="-1">2.2 本地模式 <a class="header-anchor" href="#_2-2-本地模式" aria-hidden="true">#</a></h3><p>不借助<code>hdfs</code>将文件存储再服务器内部。</p><p>创建一个文件，随便写一些内容，统计每个单词出现频率。</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">cat laoshireninput/word.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">laoshiren</span></span>
<span class="line"><span style="color:#A6ACCD;">xiangdehua</span></span>
<span class="line"><span style="color:#A6ACCD;">laoshiren</span></span>
<span class="line"><span style="color:#A6ACCD;">zhoujielun</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>执行计算，必须指定一个输入路径，一个输出路径</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar wordcount laoshireninput/ ./laoshirenoutput</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> laoshirenoutput/</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@hadoop1207 laoshirenoutput</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># ll</span></span>
<span class="line"><span style="color:#A6ACCD;">总用量 4</span></span>
<span class="line"><span style="color:#A6ACCD;">-rw-r--r--. 1 root root 38 4月  25 01:18 part-r-00000			</span><span style="color:#676E95;"># 真正的数据</span></span>
<span class="line"><span style="color:#A6ACCD;">-rw-r--r--. 1 root root  0 4月  25 01:18 _SUCCESS				</span><span style="color:#676E95;"># 表示标记并没有数据</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">cat part-r-00000 </span></span>
<span class="line"><span style="color:#A6ACCD;">laoshiren	2</span></span>
<span class="line"><span style="color:#A6ACCD;">xiangdehua	1</span></span>
<span class="line"><span style="color:#A6ACCD;">zhoujielun	1</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_2-3-完全分布式集群" tabindex="-1">2.3 完全分布式集群 <a class="header-anchor" href="#_2-3-完全分布式集群" aria-hidden="true">#</a></h3><h4 id="_2-3-1-准备工作" tabindex="-1">2.3.1 准备工作 <a class="header-anchor" href="#_2-3-1-准备工作" aria-hidden="true">#</a></h4><p>在创建2个完全一致的虚拟机，可以不装<code>JDK</code>和<code>hadoop</code>，等后期使用<code>scp</code>拷贝过去。</p><p><img src="https://img-blog.csdnimg.cn/cfc2f17dea214b3dabecf500548fa1dc.png" alt="在这里插入图片描述"></p><p>拷贝<code>JDK</code>和<code>Hadoop</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">scp -r jdk1.8.0_152/ root@192.168.8.202:/root/module</span></span>
<span class="line"><span style="color:#676E95;"># scp 安全拷贝</span></span>
<span class="line"><span style="color:#676E95;"># -r 递归</span></span>
<span class="line"><span style="color:#676E95;"># 本地文件</span></span>
<span class="line"><span style="color:#676E95;"># 用户@主机:对应路径</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">scp -r hadoop-3.1.3/ root@192.168.8.202:/opt/modules</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>修改<code>/etc/hosts</code>文件，追加如下内容</p><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">172.31.10.201 hadoop201</span></span>
<span class="line"><span style="color:#A6ACCD;">172.31.10.202 hadoop202</span></span>
<span class="line"><span style="color:#A6ACCD;">172.31.10.203 hadoop203</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>安装 <code>rsync</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">yum install -y rsync </span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>同步脚本，用于同步机器配置文件</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;"># </span><span style="color:#89DDFF;">-lt</span><span style="color:#A6ACCD;"> 1 </span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> Not Enough Arguement</span><span style="color:#89DDFF;">!</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">exit</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> host </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> hadoop202 hadoop203 hadoop201</span></span>
<span class="line"><span style="color:#89DDFF;">do</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> ==================== </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">host ====================</span></span>
<span class="line"><span style="color:#89DDFF;"> </span><span style="color:#676E95;">#3. 遍历所有目录，挨个发送</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> file </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">@</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">do</span></span>
<span class="line"><span style="color:#89DDFF;"> </span><span style="color:#676E95;">#4. 判断文件是否存在</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-e</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">file </span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#89DDFF;"> </span><span style="color:#676E95;">#5. 获取父目录</span></span>
<span class="line"><span style="color:#A6ACCD;"> pdir=</span><span style="color:#89DDFF;">$(</span><span style="color:#C3E88D;">cd -P </span><span style="color:#89DDFF;">$(</span><span style="color:#C3E88D;">dirname </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">);</span><span style="color:#C3E88D;"> pwd</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;"> </span><span style="color:#676E95;">#6. 获取当前文件的名称</span></span>
<span class="line"><span style="color:#A6ACCD;"> fname=</span><span style="color:#89DDFF;">$(</span><span style="color:#C3E88D;">basename </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;"> ssh </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">host </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mkdir -p </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">pdir</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> rsync -av </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">pdir/</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">fname </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">host:</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">pdir</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">else</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">file does not exists</span><span style="color:#89DDFF;">!</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">fi</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">done</span></span>
<span class="line"><span style="color:#89DDFF;">done</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h4 id="_2-3-2-hadoop-配置文件" tabindex="-1">2.3.2 Hadoop 配置文件 <a class="header-anchor" href="#_2-3-2-hadoop-配置文件" aria-hidden="true">#</a></h4><table><thead><tr><th></th><th>hadoop201</th><th>hadoop202</th><th>hadoop203</th></tr></thead><tbody><tr><td>HDFS</td><td>NameNode DataNode</td><td>DataNode</td><td>SNN DataNode</td></tr><tr><td>YARN</td><td>NodeManager</td><td>ResourceManager NodeManager</td><td>NodeManager</td></tr></tbody></table><p>默认配置文件</p><p>核心配置文件 <code>core-site.xml</code></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml-stylesheet</span><span style="color:#C792EA;"> type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">text/xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">configuration.xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- 指定 NameNode 的地址 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">fs.defaultFS</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hdfs://hadoop201:8020</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- 指定 hadoop 数据的存储目录 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop.tmp.dir</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">/home/module/hadoop-3.1.3/data</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- 配置 HDFS 网页登录使用的静态用户为 atguigu --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop.http.staticuser.user</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">root</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>HDFS 配置文件<code>hdfs-site.xml</code></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml-stylesheet</span><span style="color:#C792EA;"> type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">text/xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">configuration.xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- nn web 端访问地址--&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">dfs.namenode.http-address</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop201:9870</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- 2nn web 端访问地址--&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">dfs.namenode.secondary.http-address</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop203:9868</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><code>YARN</code>配置文件<code>yarn-site.xml</code></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- 指定 MR 走 shuffle --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.nodemanager.aux-services</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce_shuffle</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- 指定 ResourceManager 的地址--&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.resourcemanager.hostname</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop202</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- 环境变量的继承 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.nodemanager.env-whitelist</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CO</span></span>
<span class="line"><span style="color:#A6ACCD;">            NF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAP</span></span>
<span class="line"><span style="color:#A6ACCD;">            RED_HOME</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.nodemanager.vmem-check-enabled</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">false</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.log-aggregation-enable</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">true</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- 设置日志聚集服务器地址 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.log.server.url</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">http://hadoop201:19888/jobhistory/logs</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- 设置日志保留时间为 7 天 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.log-aggregation.retain-seconds</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">604800</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>MapReduce 配置文件<code>mapred-site.xml</code></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml-stylesheet</span><span style="color:#C792EA;"> type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">text/xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">configuration.xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- 指定mapreduce 程序运行在yarn --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce.framework.name</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.app.mapreduce.am.env</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">HADOOP_MAPRED_HOME=/home/module/hadoop-3.1.3</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce.map.env</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">HADOOP_MAPRED_HOME=/home/module/hadoop-3.1.3</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce.reduce.env</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">HADOOP_MAPRED_HOME=/home/module/hadoop-3.1.3</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce.cluster.map.memory.mb</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">-1</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce.cluster.reduce.memory.mb</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">-1</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- 历史服务器端地址 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce.jobhistory.address</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop201:10020</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- 历史服务器 web 端地址 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce.jobhistory.webapp.address</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop201:19888</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p><code>vi workers</code></p><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop201</span></span>
<span class="line"><span style="color:#A6ACCD;">hadoop202</span></span>
<span class="line"><span style="color:#A6ACCD;">hadoop203</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>分发配置文件</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">xsync /home/module/hadoop-3.1.3/etc/hadoop</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>修改启动文件 <code>sbin/start-dfs.sh</code>和<code>sbin/stop-dfs.sh</code> 和<code>sbin/start-yarn.sh</code>和<code>sbin/stop-yarn.sh</code>，并分发<code>xsync /home/module/hadoop-3.1.3/sbin</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">#!/usr/bin/env bash</span></span>
<span class="line"><span style="color:#A6ACCD;">HDFS_DATANODE_USER=root</span></span>
<span class="line"><span style="color:#A6ACCD;">HADOOP_SECURE_DN_USER=hdfs</span></span>
<span class="line"><span style="color:#A6ACCD;">HDFS_NAMENODE_USER=root</span></span>
<span class="line"><span style="color:#A6ACCD;">HDFS_SECONDARYNAMENODE_USER=root</span></span>
<span class="line"><span style="color:#A6ACCD;">YARN_RESOURCEMANAGER_USER=root</span></span>
<span class="line"><span style="color:#A6ACCD;">HADOOP_SECURE_DN_USER=yarn</span></span>
<span class="line"><span style="color:#A6ACCD;">YARN_NODEMANAGER_USER=root</span></span>
<span class="line"><span style="color:#676E95;"># ...省略</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>集群初始化</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hdfs namenode -format</span></span>
<span class="line"><span style="color:#676E95;"># 启动hdfs</span></span>
<span class="line"><span style="color:#A6ACCD;">sbin/start-dfs.sh</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>到<code>hadoop202</code>机器 启动 <code>resouce manager</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">sbin/start-yarn.sh</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查看<code>http://hadoop201:9870</code>,<a href="http://hadoop201:9870" target="_blank" rel="noreferrer">地址</a></p><p>查看<code>http://hadoop202:8088</code>,<a href="http://hadoop202:8088" target="_blank" rel="noreferrer">地址</a></p><h4 id="_2-3-3-基础测试" tabindex="-1">2.3.3 基础测试 <a class="header-anchor" href="#_2-3-3-基础测试" aria-hidden="true">#</a></h4><p>创建目录</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -mkdir /wcinput</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上传文件</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -put /root/a.txt /wcinput</span></span>
<span class="line"><span style="color:#676E95;"># 输出</span></span>
<span class="line"><span style="color:#A6ACCD;">2021-05-05 13:15:51,994 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = </span><span style="color:#82AAFF;">false</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/4a44b09ef326419cacf0d9bbc2ddbbae.png" alt="在这里插入图片描述"></p><p>实际存储在</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">cat </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">HADOOP_HOME/data/dfs/data/current/BP-1065121377-192.168.8.201-1620119427494/current/finalized/subdir0/subdir0/blk_1073741825</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>wordcount</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar wordcount /wcinput /wcoutput</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>编写启动脚本</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">#!/bin/bash</span></span>
<span class="line"><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;"># </span><span style="color:#89DDFF;">-lt</span><span style="color:#A6ACCD;"> 1 </span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">No Args Input...</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">exit</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">fi</span></span>
<span class="line"><span style="color:#89DDFF;">case</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">1 </span><span style="color:#89DDFF;">in</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">start</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> =================== 启动 hadoop 集群 ===================</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> --------------- 启动 hdfs ---------------</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> ssh hadoop201 </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/home/module/hadoop-3.1.3/sbin/start-dfs.sh</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> --------------- 启动 yarn ---------------</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">ssh hadoop202 </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/home/module/hadoop-3.1.3/sbin/start-yarn.sh</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> --------------- 启动 historyserver ---------------</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> ssh hadoop201 </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/home/module/hadoop-3.1.3/bin/mapred --daemon start historyserver</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">stop</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> =================== 关闭 hadoop 集群 ===================</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> --------------- 关闭 historyserver ---------------</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> ssh hadoop201 </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/home/module/hadoop-3.1.3/bin/mapred --daemon stop historyserver</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> --------------- 关闭 yarn ---------------</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> ssh hadoop202 </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/home/module/hadoop-3.1.3/sbin/stop-yarn.sh</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> --------------- 关闭 hdfs ---------------</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> ssh hadoop201 </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/home/module/hadoop-3.1.3/sbin/stop-dfs.sh</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#89DDFF;">*)</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Input Args Error...</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#89DDFF;">esac</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h1 id="hdfs" tabindex="-1">HDFS <a class="header-anchor" href="#hdfs" aria-hidden="true">#</a></h1><h2 id="hdfs-产生背景" tabindex="-1">hdfs 产生背景 <a class="header-anchor" href="#hdfs-产生背景" aria-hidden="true">#</a></h2><p>随着数据量越来越大，在一个操作系统存不下所有的数据，那么就分配到更多的操作系 统管理的磁盘中，但是不方便管理和维护，迫切需要一种系统来管理多台机器上的文件，这 就是分布式文件管理系统。HDFS 只是分布式文件管理系统中的一种。</p><p>HDFS（Hadoop Distributed File System），它是一个文件系统，用于存储文件，通过目 录树来定位文件；其次，它是分布式的，由很多服务器联合起来实现其功能，集群中的服务 器有各自的角色。 HDFS 的使用场景：适合一次写入，多次读出的场景。一个文件经过创建、写入和关闭 之后就不需要改变。</p><h3 id="hdfs-优缺点" tabindex="-1">hdfs 优缺点 <a class="header-anchor" href="#hdfs-优缺点" aria-hidden="true">#</a></h3><p>优点</p><ol><li>高容错性</li></ol><ul><li>数据自动保存多个副本。它通过增加副本的形式，提高容错性。</li><li>某个副本丢失以后，他可以自动恢复。</li></ul><ol start="2"><li>适合处理大数据</li></ol><ul><li>数据规模：能够处理数据规模达到GB、TB、甚至PB级别的数据；</li><li>文件规模：能够处理百万规模以上的文件数量，数量相当之大。</li></ul><ol start="3"><li>可构建在廉价机器上，通过多副本机制，提高可靠性。</li></ol><p>缺点</p><ul><li><p>不适合低延时数据访问，比如毫秒级的存储数据，是做不到的。</p></li><li><p>无法高效的对大量小文件进行存储。</p><ul><li>存储大量小文件的话，它会占用NameNode大量的内存来存储文件目 录和 块信息。这样是不可取的，因为NameNode的内存总是有限的；</li><li>小文件存储的寻址时间会超过读取时间，它违反了HDFS的设计目标。</li><li>不支持并发写入、文件随机修改。</li></ul></li><li><p>一个文件只能有一个写，不允许多个线程同时写；</p></li><li><p>仅支持数据append（追加），不支持文件的随机修改</p></li></ul><h3 id="组成" tabindex="-1">组成 <a class="header-anchor" href="#组成" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/910e38c85fc94f068b22dc9650acec7b.png" alt="在这里插入图片描述"></p><p>NameNode(NN)：就是Master，它是一个主管、管理者。</p><ol><li>管理HDFS的名称空间；</li><li>配置副本策略；</li><li>管理数据块（Block）映射信息；</li><li>处理客户端读写请求。</li></ol><p>DataNode：就是Slave。NameNode下达命令，DataNode执行实际的操作。</p><ol><li>存储实际的数据块；</li><li>执行数据块的读/写操作。</li></ol><p>Client：就是客户端。</p><ol><li>文件切分。文件上传HDFS的时候，Client将文件切分成一个一个的Block，然后进行上传；（按照NameNode文件块分割）</li><li>与NameNode交互，获取文件的位置信息；</li><li>与DataNode交互，读取或者写入数据；</li><li>Client提供一些命令来管理HDFS，比如NameNode格式化；</li><li>Client可以通过一些命令来访问HDFS，比如对HDFS增删查改操作；</li></ol><p>Secondary NameNode：并非NameNode的热备。当NameNode挂掉的时候，它并不 能马上替换NameNode并提供服务。</p><ol><li>辅助NameNode，分担其工作量，比如定期合并Fsimage和Edits，并推送给NameNode ；</li><li>在紧急情况下，可辅助恢复NameNode。</li></ol><h3 id="文件块大小问题" tabindex="-1">文件块大小问题 <a class="header-anchor" href="#文件块大小问题" aria-hidden="true">#</a></h3><p>HDFS中的文件在物理上是分块存储（Block），块的大小可以通过配置参数 ( dfs.blocksize）来规定，默认大小在Hadoop2.x/3.x版本中是128M，1.x版本中是64M。</p><p><img src="https://img-blog.csdnimg.cn/609c8eab39804f349da7735354134ef2.png" alt="在这里插入图片描述"></p><p>思考：为什么块的大小不能设置太小，也不能设置太大？ （1）HDFS的块设置太小，会增加寻址时间，程序一直在找块的开始位置； （2）如果块设置的太大，从磁盘传输数据的时间会明显大于定位这个块开 始位置所需的时间。导致程序在处理这块数据时，会非常慢。 总结：HDFS块的大小设置主要取决于磁盘传输速率。</p><h2 id="hdfs的shell相关操作" tabindex="-1">HDFS的shell相关操作 <a class="header-anchor" href="#hdfs的shell相关操作" aria-hidden="true">#</a></h2><h3 id="基本语法" tabindex="-1">基本语法 <a class="header-anchor" href="#基本语法" aria-hidden="true">#</a></h3><p><code>hadoop fs 具体命令 </code>OR <code>hdfs dfs 具体命令</code> 两个是完全相同的。</p><p>各个模块启动停止HDFS</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">start-dfs.sh , stop-dfs.sh</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>各个模块启动停止yarn</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">start-yarn.sh , stop-yarn.sh</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>逐一启动和停止</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hdfs --daemon start/stop namenode/datanode/secondarynamenode</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">yarn --daemon start/stop resourcemanager/nodemanager</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="命令大全" tabindex="-1">命令大全 <a class="header-anchor" href="#命令大全" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-appendToFile </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localsrc</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">dst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-cat </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-ignoreCrc</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-chgrp </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-R</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> GROUP PATH...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-chmod </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-R</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">MODE</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">,MODE</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">... </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> OCTALMODE</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> PATH...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-chown </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-R</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">OWNER</span><span style="color:#89DDFF;">][</span><span style="color:#A6ACCD;">:</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">GROUP</span><span style="color:#89DDFF;">]]</span><span style="color:#A6ACCD;"> PATH...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-copyFromLocal </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-f</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-p</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localsrc</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">dst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-copyToLocal </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-p</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-ignoreCrc</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-crc</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localdst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-count </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-q</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-cp </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-f</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-p</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">dst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-df </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-h</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-du </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-s</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-h</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-get </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-p</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-ignoreCrc</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-crc</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localdst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-getmerge </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-nl</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localdst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-help </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">cmd ...</span><span style="color:#89DDFF;">]]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-ls </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-d</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-h</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-R</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-mkdir </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-p</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-moveFromLocal </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localsrc</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">dst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-moveToLocal </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localdst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-mv </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">dst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-put </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-f</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-p</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localsrc</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">dst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-rm </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-f</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-r</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">-R</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-skipTrash</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-rmdir </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">--ignore-fail-on-non-empty</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">dir</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">acl_spec</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;]]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-setrep </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-R</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-w</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">rep</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-stat </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">format</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-tail </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-f</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-test -</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">defsz</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-text </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-ignoreCrc</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h4 id="_1-上传和下载" tabindex="-1">1 上传和下载 <a class="header-anchor" href="#_1-上传和下载" aria-hidden="true">#</a></h4><ul><li>从本地<span style="color:red;">剪切粘贴</span>到 HDFS</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -moveFromLocal ./shuguo.txt /sanguo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>从本地文件系统中拷贝文件到 HDFS 路径去</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -copyFromLocal ./weiguo.txt /sanguo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>等同于<code>hadoop fs -put filePath dir</code></p><ul><li>追加文件到已存在的文件的末尾</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -appendToFile liubei.txt /sanguo/shuguo.txt</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>从hdfs 拷贝到本地</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -copyToLocal /sanguo/shuguo.txt ./downloadFile.txt</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>等同于<code>-get</code></p><h4 id="_2-其他操作" tabindex="-1">2 其他操作 <a class="header-anchor" href="#_2-其他操作" aria-hidden="true">#</a></h4><ul><li>list file</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -ls /sanguo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>显示文件内容</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -cat /sanguo/shuguo.txt</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>创建路径</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -mkdir /jinguo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>从 HDFS 的一个路径拷贝到 HDFS 的另一个路径</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -cp /sanguo/shuguo.txt  /jinguo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>移动文件</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;"> hadoop fs -mv /sanguo/wuguo.txt /jinguo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>显示一个文件的末尾 1kb 的数据</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -tail /jinguo/shuguo.txt</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>删除文件或文件夹</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;"> hadoop fs -rm /sanguo/shuguo.txt</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>递归删除目录及目录里面内容</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;"> hadoop fs -rm -r /sanguo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="hdfs的客户端api" tabindex="-1">HDFS的客户端API <a class="header-anchor" href="#hdfs的客户端api" aria-hidden="true">#</a></h2><h3 id="依赖" tabindex="-1">依赖 <a class="header-anchor" href="#依赖" aria-hidden="true">#</a></h3><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">project.hadoop.version</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">3.1.3</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">project.hadoop.version</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">org.apache.hadoop</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop-client</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">${project.hadoop.version}</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="基础配置" tabindex="-1">基础配置 <a class="header-anchor" href="#基础配置" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> configuration </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#C792EA;">FileSystem</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Before</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">init</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 1 获取文件系统</span></span>
<span class="line"><span style="color:#A6ACCD;">    configuration </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URI</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://hadoop201:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> configuration</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">InterruptedException</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">URISyntaxException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">After</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 3 关闭资源</span></span>
<span class="line"><span style="color:#A6ACCD;">        fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="创建文件夹" tabindex="-1">创建文件夹 <a class="header-anchor" href="#创建文件夹" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * 创建文件夹</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">testMkdir</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 2 创建目录</span></span>
<span class="line"><span style="color:#A6ACCD;">        fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mkdirs</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xiyou/huaguoshan/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="上传文件" tabindex="-1">上传文件 <a class="header-anchor" href="#上传文件" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * 上传文件</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">put</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> filePath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">D:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">IdeaExampleProjects</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">data-ware-house</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">hadoop</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">static</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">image</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">hadoop_0001.jpg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">copyFromLocalFile</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">filePath</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xiyou/huaguoshan</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/ff6e27eb8b8c463db7f400b0dae898c0.png" alt="在这里插入图片描述"></p><p>将 hdfs-site.xml 拷贝到项目的 resources 资源目录下</p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml-stylesheet</span><span style="color:#C792EA;"> type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">text/xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">configuration.xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">dfs.replication</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;"> 		</span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">1</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>参数优先级排序：（1）客户端代码中设置的值 <code>configuration.set(&quot;dfs.replication&quot;, &quot;2&quot;);</code> &gt;（2）ClassPath 下的用户自定义配置文 件 &gt;（3）然后是服务器的自定义配置（xxx-site.xml）&gt;（4）服务器的默认配置（xxx-default.xml）</p><h3 id="下载文件" tabindex="-1">下载文件 <a class="header-anchor" href="#下载文件" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * 文件下载</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">testGet</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">copyToLocalFile</span><span style="color:#89DDFF;">(false,</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xiyou/huaguoshan/hadoop_0001.jpg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">d:/sunwukong2.jpg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">true);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/c9219ee3ed134c198ee1b912b5f3f87c.png" alt="在这里插入图片描述"></p><p><code>useRawLocalFileSystem</code>:是否开启本地文件校验。设置为true，会生成一个本地文件，即文件名+.crc。将文件加上校验码，传输到客户端，然后在客户端做CRC加密算法进行校验。</p><h3 id="删除文件" tabindex="-1">删除文件 <a class="header-anchor" href="#删除文件" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * 文件删除</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">testDelete</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">delete</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xiyou/huaguoshan/hadoop_0002.png</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">                  </span><span style="color:#89DDFF;">true);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/8062cfdade4b4cc8814dc9a57a4abe1c.png" alt="在这里插入图片描述"></p><h3 id="文件重命名和移动" tabindex="-1">文件重命名和移动 <a class="header-anchor" href="#文件重命名和移动" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * 文件更名和移动</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">testMove</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">rename</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xiyou/huaGuoshan/hadoop_0001.jpg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xiyou/huaguoshan/hadoop_0003.jpg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="文件详情查看" tabindex="-1">文件详情查看 <a class="header-anchor" href="#文件详情查看" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * 文件详情查看</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">testFileList</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">RemoteIterator</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">LocatedFileStatus</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> fileRemoteIterator </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listFiles</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xiyou</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">while</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">fileRemoteIterator</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">hasNext</span><span style="color:#89DDFF;">())</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">LocatedFileStatus</span><span style="color:#A6ACCD;"> fileStatus </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fileRemoteIterator</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">next</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">========{}=========</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getPath</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Permission: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getPermission</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Owner: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getOwner</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Group: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getGroup</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Len: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLen</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ModificationTime: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">                     fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getModificationTime</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Replication: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getReplication</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">BlockSize: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBlockSize</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">filePathName: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">                     fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getPath</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">getName</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;">// 获取块信息</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">BlockLocation</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> blockLocations </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">                fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBlockLocations</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">            System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Arrays</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">blockLocations</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>第二个参数表示递归</p><p><img src="https://img-blog.csdnimg.cn/9062239c79ee45adb18722034aca1809.png" alt="在这里插入图片描述"></p><p><code>fileStatus.getBlockLocations() </code>表示文件的块信息</p><p><img src="https://img-blog.csdnimg.cn/c0501726a3ec4127a50ea8c73a79de60.png" alt="在这里插入图片描述"></p><h2 id="hdfs读写流程" tabindex="-1">HDFS读写流程 <a class="header-anchor" href="#hdfs读写流程" aria-hidden="true">#</a></h2><h3 id="hdfs的写数据流程" tabindex="-1">HDFS的写数据流程 <a class="header-anchor" href="#hdfs的写数据流程" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/287d5cb9ebc644d693c9c0152fbf6bbe.png" alt="在这里插入图片描述"></p><ol><li>客户端通过 Distributed FileSystem 模块向 NameNode 请求上传文件，NameNode 检查目标文件是否已存在，父目录是否存在。</li><li>NameNode 返回是否可以上传。</li><li>客户端请求第一个 Block 上传到哪几个 DataNode 服务器上。</li><li>NameNode 返回 3 个 DataNode 节点，分别为 dn1、dn2、dn3。</li><li>客户端通过 FSDataOutputStream 模块请求 dn1 上传数据，dn1 收到请求会继续调用dn2，然后 dn2 调用 dn3，将这个通信管道建立完成。</li><li>dn1、dn2、dn3 逐级应答客户端。</li><li>客户端开始往 dn1 上传第一个 Block（先从磁盘读取数据放到一个本地内存缓存），以 Packet 为单位，dn1 收到一个 Packet 就会传给 dn2，dn2 传给 dn3；dn1 每传一个 packet 会放入一个应答队列等待应答。</li><li>当一个 Block 传输完成之后，客户端再次请求 NameNode 上传第二个 Block 的服务器。（重复执行 3-7 步）。</li></ol><h4 id="网络拓扑-节点距离计算" tabindex="-1">网络拓扑-节点距离计算 <a class="header-anchor" href="#网络拓扑-节点距离计算" aria-hidden="true">#</a></h4><p>节点距离：两个节点到达最近的共同祖先的距离总和。</p><p><img src="https://img-blog.csdnimg.cn/1f9fbe1830724becb1a2f3b6283dacfb.png" alt="在这里插入图片描述"></p><h4 id="副本节点选择" tabindex="-1">副本节点选择 <a class="header-anchor" href="#副本节点选择" aria-hidden="true">#</a></h4><blockquote><p>For the common case, when the replication factor is three, HDFS’s placement policy is to <strong>put one replica on the local machine</strong> if the writer is on a datanode, otherwise on a random datanode, <strong>another replica on a node in a different (remote) rack</strong>, and <strong>the last on a different node in the same remote rack</strong>. This policy cuts the inter-rack write traffic which generally improves write performance. The chance of rack failure is far less than that of node failure; this policy does not impact data reliability and availability guarantees. However, it does reduce the aggregate network bandwidth used when reading data since a block is placed in only two unique racks rather than three. With this policy, the replicas of a file do not evenly distribute across the racks. One third of replicas are on one node, two thirds of replicas are on one rack, and the other third are evenly distributed across the remaining racks. This policy improves write performance without compromising data reliability or read performance.</p></blockquote><p><img src="https://img-blog.csdnimg.cn/a727f77317f446c5a3736bddedbb2e1c.png" alt="在这里插入图片描述"></p><p>第一个机架选择最近上传速度最快，第二个选择隔壁保证可靠性，第三个再次兼顾效率选择同机架上不同节点。</p><p><strong>源码说明</strong></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">org.apache.hadoop</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop-hdfs</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">${project.hadoop.version}</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>BlockPlacementPolicyDefault.chooseTargetInOrder</code></p><p><img src="https://img-blog.csdnimg.cn/6b1f70a7634145f2aee6a925baf913ea.png" alt="在这里插入图片描述"></p><p><img src="https://img-blog.csdnimg.cn/d8abe72746954b24aa26be309d303420.png" alt="在这里插入图片描述"></p><h3 id="hdfs的读数据流程" tabindex="-1">HDFS的读数据流程 <a class="header-anchor" href="#hdfs的读数据流程" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/8ae7b3aaf5644411bb08a8a2da143868.png" alt="在这里插入图片描述"></p><ol><li>客户端通过 DistributedFileSystem 向 NameNode 请求下载文件，NameNode 通过查询元数据，找到文件块所在的 DataNode 地址。</li><li>挑选一台 DataNode（就近原则，然后随机）服务器，请求读取数据。</li><li>DataNode 开始传输数据给客户端（从磁盘里面读取数据输入流，以 Packet 为单位来做校验）。</li><li>客户端以 Packet 为单位接收，先在本地缓存，然后写入目标文件。</li></ol><p>注意：在读取block数据的时候是串行读。</p><h2 id="nn和2nn工作原理" tabindex="-1">NN和2NN工作原理 <a class="header-anchor" href="#nn和2nn工作原理" aria-hidden="true">#</a></h2><h3 id="工作机制" tabindex="-1">工作机制 <a class="header-anchor" href="#工作机制" aria-hidden="true">#</a></h3><p>NameNode的元数据存储在内存还是磁盘中？如果存储在 NameNode 节点的磁盘中，因为经常需要进行随机访问，还有响应客户请求，必然是效率过低。因此，元数据需要存放在内存中。但如果只存在内存中，一旦断电，元数据丢失，整个集群就无法工作了。因此产生在磁盘中备份元数据的 FsImage。</p><p>这样又会带来新的问题，当在内存中的元数据更新时，如果同时更新 FsImage，就会导致效率过低，但如果不更新，就会发生一致性问题，一旦 NameNode 节点断电，就会产生数据丢失。因此，引入 Edits 文件（只进行追加操作，效率很高）。每当元数据有更新或者添加元数据时，修改内存中的元数据并追加到 Edits 中。这样，一旦 NameNode 节点断电，可以通过 FsImage 和 Edits 的合并，合成元数据。</p><p>但是，如果长时间添加数据到 Edits 中，会导致该文件数据过大，效率降低，而且一旦断电，恢复元数据需要的时间过长。因此，需要定期进行 FsImage 和 Edits 的合并，如果这个操作由NameNode节点完成，又会效率过低。因此，引入一个新的节点SecondaryNamenode，专门用于 FsImage 和 Edits 的合并。</p><p><img src="https://img-blog.csdnimg.cn/007ba5160c074fc19efd6e7388e57f6a.png" alt="在这里插入图片描述"></p><ul><li>第一阶段：NameNode 启动 <ol><li>第一次启动 NameNode 格式化后，创建 Fsimage 和 Edits 文件。如果不是第一次启动，直接加载编辑日志和镜像文件到内存。</li><li>客户端对元数据进行增删改的请求。</li><li>NameNode 记录操作日志，更新滚动日志。</li><li>NameNode 在内存中对元数据进行增删改。</li></ol></li><li>第二阶段：Secondary NameNode 工作 <ol><li>Secondary NameNode 询问 NameNode 是否需要 CheckPoint。直接带回 NameNode 是否检查结果。</li><li>Secondary NameNode 请求执行 CheckPoint。</li><li>NameNode 滚动正在写的 Edits 日志。</li><li>将滚动前的编辑日志和镜像文件拷贝到 Secondary NameNode</li><li>Secondary NameNode 加载编辑日志和镜像文件到内存，并合并。</li><li>生成新的镜像文件 fsimage.chkpoint。</li><li>拷贝 fsimage.chkpoint 到 NameNode。</li><li>NameNode 将 fsimage.chkpoint 重新命名成 fsimage。</li></ol></li></ul><h3 id="fsimage和edits解析" tabindex="-1">Fsimage和Edits解析 <a class="header-anchor" href="#fsimage和edits解析" aria-hidden="true">#</a></h3><p>NameNode被格式化之后，将在/opt/module/hadoop-3.1.3/data/tmp/dfs/name/current 目录中产生如下文件 （1）Fsimage文件：HDFS文件系统元数据的一个永久性的检查点，其中包含HDFS文件系统的所有目录和文件inode的序列化信息。</p><p>（2）Edits文件：存放HDFS文件系统的所有更新操作的路径，文件系统客户端执行的所有写操作首先会被记录到Edits文件中。</p><p>（3）seen_txid文件保存的是一个数字，就是最后一个edits_的数字。 （4）每 次NameNode启动的时候都会将Fsimage文件读入内存，加 载Edits里面的更新操作，保证内存中的元数据信息是最新的、同步的，可以看成NameNode启动的时候就将Fsimage和Edits文件进行了合并。</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hdfs oiv -p XML -i fsimage_0000000000000000025 -o /home/fsimage.xml</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">hdfs oev -p XML -i edits_0000000000000000012-0000000000000000013 -o /home/edits.xml</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="datanode工作机制" tabindex="-1">DataNode工作机制 <a class="header-anchor" href="#datanode工作机制" aria-hidden="true">#</a></h2><p><img src="https://img-blog.csdnimg.cn/563c0646f34e4aa6999342f7fb7e1ef9.png" alt="在这里插入图片描述"></p><ol><li>一个数据块在 DataNode 上以文件形式存储在磁盘上，包括两个文件，一个是数据本身，一个是元数据包括数据块的长度，块数据的校验和，以及时间戳。</li><li>DataNode 启动后向 NameNode 注册，通过后，周期性（6 小时）的向 NameNode 上报所有的块信息。</li><li>心跳是每 3 秒一次，心跳返回结果带有 NameNode 给该 DataNode 的命令如复制块数据到另一台机器，或删除某个数据块。如果超过 10 分钟没有收到某个 DataNode 的心跳，则认为该节点不可用。</li><li>集群运行中可以安全加入和退出一些机器。</li></ol><h1 id="mapreduce" tabindex="-1">MapReduce <a class="header-anchor" href="#mapreduce" aria-hidden="true">#</a></h1><h2 id="mapreduce-概述" tabindex="-1">MapReduce 概述 <a class="header-anchor" href="#mapreduce-概述" aria-hidden="true">#</a></h2><h3 id="mapreduce-定义" tabindex="-1">MapReduce 定义 <a class="header-anchor" href="#mapreduce-定义" aria-hidden="true">#</a></h3><p>MapReduce 是一个<strong>分布式运算程序</strong>的编程框架，是用户开发“基于 Hadoop 的数据分析应用”的核心框架。MapReduce 核心功能是将<strong>用户编写的业务逻辑代码和自带默认组件</strong>整合成一个完整的<strong>分布式运算程序</strong>，并发运行在一个 Hadoop 集群上。</p><h3 id="mapreduce-优缺点" tabindex="-1">MapReduce 优缺点 <a class="header-anchor" href="#mapreduce-优缺点" aria-hidden="true">#</a></h3><h4 id="优点" tabindex="-1">优点 <a class="header-anchor" href="#优点" aria-hidden="true">#</a></h4><ul><li>MapReduce 易于编程</li></ul><p><strong>它简单的实现一些接口，就可以完成一个分布式程序</strong>，这个分布式程序可以分布到大量廉价的 PC 机器上运行。也就是说你写一个分布式程序，跟写一个简单的串行程序是一模一样的。就是因为这个特点使得 MapReduce 编程变得非常流行。</p><ul><li>良好的扩展性</li></ul><p>当你的计算资源不能得到满足的时候，你可以通过<strong>简单的增加机器</strong>来扩展它的计算能力。</p><ul><li>高容错性</li></ul><p>MapReduce 设计的初衷就是使程序能够部署在廉价的 PC 机器上，这就要求它具有很高的容错性。比如<strong>其中一台机器挂了，它可以把上面的计算任务转移到另外一个节点上运行，不至于这个任务运行失败</strong>，而且这个过程不需要人工参与，而完全是由 Hadoop 内部完成的。</p><ul><li>适合 PB 级以上海量数据的离线处理</li></ul><p>可以实现上千台服务器集群并发工作，提供数据处理能力。</p><h4 id="缺点" tabindex="-1">缺点 <a class="header-anchor" href="#缺点" aria-hidden="true">#</a></h4><ul><li>不擅长实时计算</li></ul><p>MapReduce 无法像 MySQL 一样，在毫秒或者秒级内返回结果。</p><ul><li>不擅长流式计算</li></ul><p>流式计算的输入数据是动态的，而 MapReduce 的<strong>输入数据集是静态的</strong>，不能动态变化。这是因为 MapReduce 自身的设计特点决定了数据源必须是静态的。</p><ul><li>不擅长 DAG（有向无环图）计算</li></ul><p>多个应用程序存在依赖关系，后一个应用程序的输入为前一个的输出。在这种情况下，MapReduce 并不是不能做，而是使用后，<strong>每个 MapReduce 作业的输出结果都会写入到磁盘，会造成大量的磁盘 IO，导致性能非常的低下</strong>。</p><h3 id="mapreduce-核心思想" tabindex="-1">MapReduce 核心思想 <a class="header-anchor" href="#mapreduce-核心思想" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/8feec7754e67411abedb920d6b45f309.png" alt="在这里插入图片描述"></p><ul><li>分布式的运算程序往往需要分成至少 2 个阶段。</li><li>第一个阶段的 MapTask 并发实例，完全并行运行，互不相干。</li><li>第二个阶段的 ReduceTask 并发实例互不相干，但是他们的数据依赖于上一个阶段的所有 MapTask 并发实例的输出。</li><li>MapReduce 编程模型只能包含一个 Map 阶段和一个 Reduce 阶段，如果用户的业务逻辑非常复杂，那就只能多个 MapReduce 程序，串行运行。</li></ul><h3 id="mapreduce-进程" tabindex="-1">MapReduce 进程 <a class="header-anchor" href="#mapreduce-进程" aria-hidden="true">#</a></h3><p>一个完整的 MapReduce 程序在分布式运行时有三类实例进程：</p><ul><li>MrAppMaster：负责整个程序的过程调度及状态协调。</li><li>MapTask：负责 Map 阶段的整个数据处理流程。</li><li>ReduceTask：负责 Reduce 阶段的整个数据处理流程。</li></ul><h3 id="官方-wordcount-源码" tabindex="-1">官方 WordCount 源码 <a class="header-anchor" href="#官方-wordcount-源码" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:center;">Java 类型</th><th style="text-align:center;">Hadoop Writable 类型</th></tr></thead><tbody><tr><td style="text-align:center;">Boolean</td><td style="text-align:center;">BooleanWritable</td></tr><tr><td style="text-align:center;">Byte</td><td style="text-align:center;">ByteWritable</td></tr><tr><td style="text-align:center;">Int</td><td style="text-align:center;">IntWritable</td></tr><tr><td style="text-align:center;">Float</td><td style="text-align:center;">FloatWritable</td></tr><tr><td style="text-align:center;">Long</td><td style="text-align:center;">LongWritable</td></tr><tr><td style="text-align:center;">Double</td><td style="text-align:center;">DoubleWritable</td></tr><tr><td style="text-align:center;">String</td><td style="text-align:center;">Text</td></tr><tr><td style="text-align:center;">Map</td><td style="text-align:center;">MapWritable</td></tr><tr><td style="text-align:center;">Array</td><td style="text-align:center;">ArrayWritable</td></tr><tr><td style="text-align:center;">Null</td><td style="text-align:center;">NullWritable</td></tr></tbody></table><h3 id="mapreduce-编程规范" tabindex="-1">MapReduce 编程规范 <a class="header-anchor" href="#mapreduce-编程规范" aria-hidden="true">#</a></h3><p>用户编写的程序分成三个部分：Mapper、Reducer 和 Driver。</p><p>1．Mapper阶段</p><ul><li>用户自定义的Mapper要继承自己的父类</li><li>Mapper的输入数据是KV对的形式（KV的类型可自定义）</li><li>Mapper中的业务逻辑写在map()方法中</li><li>Mapper的输出数据是KV对的形式（KV的类型可自定义）</li><li>map()方法（MapTask进程）对每一个调用一次</li></ul><p>2．Reducer阶段</p><ul><li>用户自定义的Reducer要继承自己的父类</li><li>Reducer的输入数据类型对应Mapper的输出数据类型，也是KV</li><li>Reducer的业务逻辑写在reduce()方法中</li><li>ReduceTask进程对每一组相同k的组调用一次reduce()方法</li></ul><p>3．Driver阶段 相当于YARN集群的客户端，用于提交我们整个程序到YARN集群，提交的是封装了MapReduce程序相关运行参数的job对象</p><h4 id="mapper" tabindex="-1">Mapper <a class="header-anchor" href="#mapper" aria-hidden="true">#</a></h4><p>继承<code>org.apache.hadoop.mapreduce.Mapper</code></p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">package</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">mapreduce</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">IOException</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">classification</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">InterfaceAudience</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">classification</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">InterfaceStability</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">conf</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Configuration</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">RawComparator</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">compress</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">CompressionCodec</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">mapreduce</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">task</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">MapContextImpl</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">InterfaceAudience</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Public</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">InterfaceStability</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Stable</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Mapper</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">KEYIN</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">VALUEIN</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">KEYOUT</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">VALUEOUT</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">abstract</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Context</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">implements</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MapContext</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">KEYIN</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">VALUEIN</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">KEYOUT</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">VALUEOUT</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#676E95;">  /**</span></span>
<span class="line"><span style="color:#676E95;">   * Map阶段开始被调用一次.</span></span>
<span class="line"><span style="color:#676E95;">   */</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#C792EA;">protected</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setup</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#676E95;">  /**</span></span>
<span class="line"><span style="color:#676E95;">   * 每一对Key value 都会调用异常，所有的MRA都应该重写这个方法</span></span>
<span class="line"><span style="color:#676E95;">   */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">SuppressWarnings</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">unchecked</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">protected</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">map</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">KEYIN</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">VALUEIN</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">                     </span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">IOException</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">InterruptedException</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#89DDFF;">((</span><span style="color:#A6ACCD;">KEYOUT</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> key</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">VALUEOUT</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> value</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">  /**</span></span>
<span class="line"><span style="color:#676E95;">   * Map阶段结束之后执行一次</span></span>
<span class="line"><span style="color:#676E95;">   */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">protected</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">cleanup</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">context</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">run</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">IOException</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">InterruptedException</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  	</span><span style="color:#676E95;">// 初始化方法</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">setup</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">while</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">nextKeyValue</span><span style="color:#89DDFF;">())</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">// map </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#82AAFF;">map</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getCurrentKey</span><span style="color:#89DDFF;">(),</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getCurrentValue</span><span style="color:#89DDFF;">(),</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">finally</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">// 结束方法</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">cleanup</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">IntWritable</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Text</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">mapreduce</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Mapper</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">IOException</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WordCountMapper</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Mapper</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">Object</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Text</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Text</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">IntWritable</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">    /**</span></span>
<span class="line"><span style="color:#676E95;">     * Mapper&lt;KEYIN, VALUEIN, KEYOUT, VALUEOUT&gt;</span></span>
<span class="line"><span style="color:#676E95;">     *     KEYIN map阶段 输入的Key的类型</span></span>
<span class="line"><span style="color:#676E95;">     *     VALUEIN map阶段输入的value 类型 通常用String 也就是 hdfs 的 text 类型</span></span>
<span class="line"><span style="color:#676E95;">     *     KEYOUT 输入的Key 类型</span></span>
<span class="line"><span style="color:#676E95;">     *     VALUEOUT map 阶段输出的Key 类型</span></span>
<span class="line"><span style="color:#676E95;">     *     map(Key,value,context)</span></span>
<span class="line"><span style="color:#676E95;">     *     context</span></span>
<span class="line"><span style="color:#676E95;">     *</span></span>
<span class="line"><span style="color:#676E95;">     */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Text</span><span style="color:#A6ACCD;"> k </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Text</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">IntWritable</span><span style="color:#A6ACCD;"> v </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">IntWritable</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">protected</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">map</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Text</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">IOException</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">InterruptedException</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 1 获取一行</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> line </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> value</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 2 切割</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> words </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> line</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">split</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 3 输出</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> word </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> words</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            k</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">word</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">k</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> v</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h4 id="reducer" tabindex="-1">Reducer <a class="header-anchor" href="#reducer" aria-hidden="true">#</a></h4><p>继承<code>org.apache.hadoop.mapreduce.Reducer</code></p><p><img src="https://img-blog.csdnimg.cn/83406ca8165b4af4aac5e3db24b14c40.png" alt="在这里插入图片描述"></p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * 这个方法对每个 键 调用一次。</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">SuppressWarnings</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">unchecked</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#C792EA;">protected</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">reduce</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">KEYIN</span><span style="color:#A6ACCD;"> key</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Iterable</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">VALUEIN</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> values</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> c</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> throws IOException</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> InterruptedException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">for</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">VALUEIN</span><span style="color:#A6ACCD;"> value</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> values</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#89DDFF;">((</span><span style="color:#A6ACCD;">KEYOUT</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> key</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">VALUEOUT</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> value</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Job</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> throws IOException</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> ClassNotFoundException</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> InterruptedException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 1 获取配置信息以及获取 job 对象</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Job</span><span style="color:#A6ACCD;"> job </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getInstance</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 2 关联本 Driver 程序的 jar</span></span>
<span class="line"><span style="color:#A6ACCD;">    job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setJarByClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">WordCountLinuxJobDriver</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 3 关联 Mapper 和 Reducer 的 jar</span></span>
<span class="line"><span style="color:#A6ACCD;">    job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setMapperClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">WordCountMapper</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setReducerClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">WordCountReducer</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 4 设置 Mapper 输出的 kv 类型</span></span>
<span class="line"><span style="color:#A6ACCD;">    job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setMapOutputKeyClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Text</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setMapOutputValueClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">IntWritable</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 5 设置最终输出 kv 类型</span></span>
<span class="line"><span style="color:#A6ACCD;">    job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setOutputKeyClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Text</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setOutputValueClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">IntWritable</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 6 设置输入和输出路径</span></span>
<span class="line"><span style="color:#A6ACCD;">    FileInputFormat</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setInputPaths</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">]));</span></span>
<span class="line"><span style="color:#A6ACCD;">    FileOutputFormat</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setOutputPath</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">]));</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 7 提交 job</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">boolean</span><span style="color:#A6ACCD;"> result </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">waitForCompletion</span><span style="color:#89DDFF;">(true);</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">exit</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">result </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><code>hadoop jar xxx.jar xx.xx.xxx /input /output</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop jar hello-mapreduce.jar com.laoshiren.hello.hdfs.mapreduce.WordCountLinuxJobDriver /laoshiren/wordcount /laoshiren/output</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/7a47ba9403514379be52890ffd3302d4.png" alt="在这里插入图片描述"></p><p>具体代码看<code>hadoop/hello-mapreduce/../hdfs/mapreduce</code></p><h2 id="序列化" tabindex="-1">序列化 <a class="header-anchor" href="#序列化" aria-hidden="true">#</a></h2><p>为什么不用 Java 的序列化? Java 的序列化是一个重量级序列化框架（Serializable），一个对象被序列化后，会附带很多额外的信息（各种校验信息，Header，继承体系等），不便于在网络中高效传输。所以，Hadoop 自己开发了一套序列化机制（Writable）。</p><p>Hadoop 序列化特点：</p><ul><li>紧凑 ：高效使用存储空间。</li><li>快速：读写数据的额外开销小。</li><li>互操作：支持多语言的交互</li></ul><h3 id="自定义序列化" tabindex="-1">自定义序列化 <a class="header-anchor" href="#自定义序列化" aria-hidden="true">#</a></h3><p>具体实现 bean 对象序列化如下 。</p><ol><li>必须实现 Writable 接口<code>org.apache.hadoop.io.Writable</code></li><li>反序列化时，需要反射调用空参构造函数，所以必须有空参构造</li><li>重写序列化方法，重写反序列化方法</li><li>注意反序列化的顺序和序列化的顺序完全一致</li><li>要想把结果显示在文件中，需要重写<code>toString()</code>，可用&quot;\t&quot;分开，方便后续用。</li><li>如果需要将自定义的 bean 放在 key 中传输，则还需要实现 Comparable 接口，因为MapReduce 框中的 Shuffle 过程要求对 key 必须能排序。</li></ol><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">write</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataOutput</span><span style="color:#A6ACCD;"> out</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeUTF</span><span style="color:#89DDFF;">(this.</span><span style="color:#A6ACCD;">phoneNo</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeLong</span><span style="color:#89DDFF;">(this.</span><span style="color:#A6ACCD;">upStream</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeLong</span><span style="color:#89DDFF;">(this.</span><span style="color:#A6ACCD;">downloadStream</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeLong</span><span style="color:#89DDFF;">(this.</span><span style="color:#A6ACCD;">totalStream</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">readFields</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataInput</span><span style="color:#A6ACCD;"> in</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">phoneNo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> in</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readUTF</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">upStream </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> in</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readLong</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">downloadStream </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> in</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readLong</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">totalStream </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> in</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readLong</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">toString</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> phoneNo </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\t</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> upStream </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\t</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> downloadStream </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\t</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> totalStream</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>具体代码看<code>hadoop/hello-mapreduce/../hdfs/io</code></p><h2 id="mapreduce框架原理" tabindex="-1">MapReduce框架原理 <a class="header-anchor" href="#mapreduce框架原理" aria-hidden="true">#</a></h2><h3 id="inputformat-数据输入" tabindex="-1">InputFormat 数据输入 <a class="header-anchor" href="#inputformat-数据输入" aria-hidden="true">#</a></h3><h4 id="切片与-maptask-并行度决定机制" tabindex="-1">切片与 MapTask 并行度决定机制 <a class="header-anchor" href="#切片与-maptask-并行度决定机制" aria-hidden="true">#</a></h4><p>数据块：Block 是 HDFS 物理上把数据分成一块一块。数据块是 HDFS 存储数据单位。</p><p>数据切片：数据切片只是在逻辑上对输入进行分片，并不会在磁盘上将其切分成片进行存储。数据切片是 MapReduce 程序计算输入数据的单位，一个切片会对应启动一个MapTask。</p><ol><li>一个Job的Map阶段并行度由客户端在提交Job时的切片数决定</li><li>每一个Split切片分配一个MapTask并行实例处理</li><li>默认情况下，切片大小=BlockSize</li><li>切片时不考虑数据集整体，而是逐个针对每一个文件单独切片</li></ol><h4 id="job-提交流程源码和切片源码详解" tabindex="-1">Job 提交流程源码和切片源码详解 <a class="header-anchor" href="#job-提交流程源码和切片源码详解" aria-hidden="true">#</a></h4><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">waitForCompletion</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#82AAFF;">submit</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#676E95;">// 1 建立连接</span></span>
<span class="line"><span style="color:#82AAFF;">connect</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#676E95;">// 1）创建提交 Job 的代理</span></span>
<span class="line"><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Cluster</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">getConfiguration</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#676E95;">// （1）判断是本地运行环境还是 yarn 集群运行环境</span></span>
<span class="line"><span style="color:#82AAFF;">initialize</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">jobTrackAddr</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;">// 2 提交 job</span></span>
<span class="line"><span style="color:#A6ACCD;">submitter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">submitJobInternal</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Job</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">this</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> cluster</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;">// 1）创建给集群提交数据的 Stag 路径</span></span>
<span class="line"><span style="color:#C792EA;">Path</span><span style="color:#A6ACCD;"> jobStagingArea </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> JobSubmissionFiles</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getStagingDir</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">cluster</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;">// 2）获取 jobid ，并创建 Job 路径</span></span>
<span class="line"><span style="color:#C792EA;">JobID</span><span style="color:#A6ACCD;"> jobId </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> submitClient</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getNewJobID</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#676E95;">// 3）拷贝 jar 包到集群</span></span>
<span class="line"><span style="color:#82AAFF;">copyAndConfigureFiles</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> submitJobDir</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">rUploader</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">uploadFiles</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> jobSubmitDir</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;">// 4）计算切片，生成切片规划文件</span></span>
<span class="line"><span style="color:#82AAFF;">writeSplits</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> submitJobDir</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">maps </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">writeNewSplits</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">jobSubmitDir</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">input</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getSplits</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;">// 5）向 Stag 路径写 XML 配置文件</span></span>
<span class="line"><span style="color:#82AAFF;">writeConf</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> submitJobFile</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeXml</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;">// 6）提交 Job,返回提交状态</span></span>
<span class="line"><span style="color:#A6ACCD;">status </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> submitClient</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">submitJob</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">jobId</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">submitJobDir</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#89DDFF;">(),</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getCredentials</span><span style="color:#89DDFF;">());</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><ul><li><p>程序先找到你数据存储的目录。</p></li><li><p>开始遍历处理（规划切片）目录下的每一个文件</p></li><li><p>遍历第一个文件ss.txt</p><ul><li>获取文件大小fs.sizeOf(ss.txt)</li><li>计算切片大小computeSplitSize(Math.max(minSize,Math.min(maxSize,blocksize)))=blocksize=128M</li><li>默认情况下，切片大小=blocksize</li><li>开始切，形成第1个切片：ss.txt—0:128M 第2个切片ss.txt—128:256M 第3个切片ss.txt—256M:300M （每次切片时，都要判断切完剩下的部分是否大于块的1.1倍，不大于1.1倍就划分一块切片）</li><li>将切片信息写到一个切片规划文件中</li><li>整个切片的核心过程在getSplit()方法中完成</li><li>InputSplit只记录了切片的元数据信息，比如起始位置、长度以及所在的节点列表等。</li></ul></li><li><p>提交切片规划文件到YARN上，YARN上的MrAppMaster就可以根据切片规划文件计算开启MapTask个数。</p></li></ul><h3 id="mapreduce-工作流程" tabindex="-1">MapReduce 工作流程 <a class="header-anchor" href="#mapreduce-工作流程" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/070f1205d662436a805a844c2616d29c.png" alt="在这里插入图片描述"></p><p><img src="https://img-blog.csdnimg.cn/b28473ac4f134e339de05e8c60771b34.png" alt="在这里插入图片描述"></p><h4 id="partition" tabindex="-1">Partition <a class="header-anchor" href="#partition" aria-hidden="true">#</a></h4><p>默认分区是根据key的hashCode对ReduceTasks个数取模得到的。用户没法控制哪个key存储到哪个分区。</p><p><img src="https://img-blog.csdnimg.cn/4f06f40936af400abb13dbdb4388675a.png" alt="在这里插入图片描述"></p><p>具体代码看<code>hadoop/hello-mapreduce/../hdfs/partitioner</code></p><h4 id="outputformat" tabindex="-1">OutputFormat <a class="header-anchor" href="#outputformat" aria-hidden="true">#</a></h4><p>OutputFormat是MapReduce输出的基类，所有实现MapReduce输出都实现了 OutputFormat接口。</p><p><img src="https://img-blog.csdnimg.cn/7a18f76185e049e58e875cfb36e1ba77.png" alt="在这里插入图片描述"></p><p><img src="https://img-blog.csdnimg.cn/ddbd66e7321e4a909d85935c6c540844.png" alt="在这里插入图片描述"></p><p>继承OutputFormat 返回一个RecordWriter ,然后自定义RecordWrite就可以向DB等写。</p><p><img src="https://img-blog.csdnimg.cn/a187ba3becb8439a9ddd7e6f497d839e.png" alt="在这里插入图片描述"></p><p>在Driver加上<code>job.setOutputFormatClass(XXXOutputFormat.class);</code></p><p>具体代码看<code>hadoop/hello-mapreduce/../hdfs/outputformat</code></p><h4 id="reduce-join" tabindex="-1">Reduce Join <a class="header-anchor" href="#reduce-join" aria-hidden="true">#</a></h4><p>Map 端的主要工作：为来自不同表或文件的 key/value 对，打标签以区别不同来源的记录。然后用连接字段作为 key，其余部分和新加的标志作为 value，最后进行输出。 Reduce 端的主要工作：在 Reduce 端以连接字段作为 key 的分组已经完成，我们只需要在每一个分组当中将那些来源于不同文件的记录（在 Map 阶段已经打标志）分开，最后进行合并就 ok 了。</p><p><img src="https://img-blog.csdnimg.cn/d688562abe694052984226c219ba9ca2.png" alt="在这里插入图片描述"></p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TableBean</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">implements</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Writable</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//订单 id</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> id</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//产品 id</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> pid</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//产品数量</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> amount</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//产品名称</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> pname</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//判断是 order 表还是 pd 表的标志字段</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> flag</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>具体代码看<code>hadoop/hello-mapreduce/../hdfs/reducejoin</code></p><h4 id="map-join" tabindex="-1">Map Join <a class="header-anchor" href="#map-join" aria-hidden="true">#</a></h4><p>Map Join 适用于一张表十分小、一张表很大的场景。</p><ul><li>在 Mapper 的 setup 阶段，将文件读取到缓存集合中。</li><li>在 Driver 驱动类中加载缓存。</li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addCacheFile</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URI</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">file:///D:/IdeaExampleProjects/data-ware-house/env/example/join/input/dt.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Mapper</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Map</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> pdMap </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">HashMap</span><span style="color:#89DDFF;">&lt;&gt;();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#C792EA;">protected</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setup</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> throws IOException</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> InterruptedException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//通过缓存文件得到小表数据 pd.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">URI</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> cacheFiles </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getCacheFiles</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Path</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">cacheFiles</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">]);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//获取文件系统对象,并开流</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">FileSystem</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getConfiguration</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">FSDataInputStream</span><span style="color:#A6ACCD;"> fis </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">open</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//通过包装流转换为 reader,方便按行读取</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">BufferedReader</span><span style="color:#A6ACCD;"> reader </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">BufferedReader</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#82AAFF;">InputStreamReader</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">fis</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> line</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">while</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">StringUtils</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isNotEmpty</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">line </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> reader</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readLine</span><span style="color:#89DDFF;">()))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">//切割一行</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">//01 小米</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> split </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> line</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">split</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\t</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        pdMap</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">put</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">split</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">],</span><span style="color:#A6ACCD;"> split</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">]);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//关流</span></span>
<span class="line"><span style="color:#A6ACCD;">    IOUtils</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">closeStream</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">reader</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="mapreduce开发总结" tabindex="-1">MapReduce开发总结 <a class="header-anchor" href="#mapreduce开发总结" aria-hidden="true">#</a></h3><ol><li>输入接口是<code>Inputformat</code><ul><li>默认使用的实现类是：TextInputFormat 一次读一行文本，然后将该行的起始偏移量作为 key，行内容作为 value 返回。</li></ul></li><li>逻辑处理结构是<code>Mapper</code><ul><li>用户根据业务需求实现其中三个方法：map() setup() cleanup ()</li></ul></li><li><code>Partitioner</code>分区，<code>job.setNumReduceTasks(4);</code><ul><li>有默认实现 HashPartitioner，逻辑是根据 key 的哈希值和 numReduces 来返回一个分区号；<code>key.hashCode()&amp;Integer.MAXVALUE % numReduces</code></li></ul></li><li><code>Comparable</code> 排序</li><li><code>Combiner</code> 合并</li><li>逻辑处理接口：<code>Reducer</code><ul><li>用户根据业务需求实现其中三个方法：reduce() setup() cleanup ()</li></ul></li><li>输出数据接口：<code>OutputFormat</code><ul><li>默认实现类是 TextOutputFormat，功能逻辑是：将每一个 KV 对，向目标文本文件输出一行。</li></ul></li></ol><h2 id="压缩" tabindex="-1">压缩 <a class="header-anchor" href="#压缩" aria-hidden="true">#</a></h2><ul><li>压缩的好处和坏处 压缩的优点：以减少磁盘 IO、减少磁盘存储空间。 压缩的缺点：增加 CPU 开销。</li><li>压缩原则 <ul><li>运算密集型的 Job，少用压缩</li><li>IO 密集型的 Job，多用压缩</li></ul></li></ul><table><thead><tr><th style="text-align:center;">压缩格式</th><th style="text-align:center;">Hadoop 自带</th><th style="text-align:center;">算法</th><th style="text-align:center;">文件扩展名</th><th style="text-align:center;">是否可切片</th><th style="text-align:center;">换成压缩格式后，原来的程序是否需要修改</th><th style="text-align:center;">速度</th></tr></thead><tbody><tr><td style="text-align:center;">DEFLATE</td><td style="text-align:center;">是</td><td style="text-align:center;">DEFLATE</td><td style="text-align:center;">.deflate</td><td style="text-align:center;">否</td><td style="text-align:center;">和文本处理一样，不需要修改</td><td style="text-align:center;">快</td></tr><tr><td style="text-align:center;">Gzip</td><td style="text-align:center;">是</td><td style="text-align:center;">Gzip</td><td style="text-align:center;">.gz</td><td style="text-align:center;">否</td><td style="text-align:center;">和文本处理一样，不需要修改</td><td style="text-align:center;">一般</td></tr><tr><td style="text-align:center;">bzip2</td><td style="text-align:center;">是</td><td style="text-align:center;">bzip2</td><td style="text-align:center;">.bz2</td><td style="text-align:center;">是</td><td style="text-align:center;">和文本处理一样，不需要修改</td><td style="text-align:center;">慢</td></tr><tr><td style="text-align:center;">LZO</td><td style="text-align:center;">否</td><td style="text-align:center;">LZO</td><td style="text-align:center;">.lzo</td><td style="text-align:center;">是</td><td style="text-align:center;">需要建索引，还需要指定输入格式</td><td style="text-align:center;">一般</td></tr><tr><td style="text-align:center;">Snappy</td><td style="text-align:center;">是</td><td style="text-align:center;">Snappy</td><td style="text-align:center;">.snappy</td><td style="text-align:center;">否</td><td style="text-align:center;">和文本处理一样，不需要修改</td><td style="text-align:center;">极快</td></tr></tbody></table><h3 id="mapper-压缩" tabindex="-1">Mapper 压缩 <a class="header-anchor" href="#mapper-压缩" aria-hidden="true">#</a></h3><p>[文件] -&gt; mapper() -&gt; 压缩 -&gt; 传输 -&gt; 解压缩 -&gt; reducer()</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// 1 获取配置信息以及获取 job 对象</span></span>
<span class="line"><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#676E95;">// 开启 map 端输出压缩</span></span>
<span class="line"><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setBoolean</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mapreduce.map.output.compress</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true);</span></span>
<span class="line"><span style="color:#676E95;">// 设置 map 端输出压缩方式</span></span>
<span class="line"><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setClass</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mapreduce.map.output.compress.codec</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> BZip2Codec</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> CompressionCodec</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="reduce压缩" tabindex="-1">Reduce压缩 <a class="header-anchor" href="#reduce压缩" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// 设置 reduce 端输出压缩开启</span></span>
<span class="line"><span style="color:#A6ACCD;">FileOutputFormat</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setCompressOutput</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true);</span></span>
<span class="line"><span style="color:#676E95;">// 设置压缩的方式</span></span>
<span class="line"><span style="color:#A6ACCD;">FileOutputFormat</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setOutputCompressorClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> BZip2Codec</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>具体代码看<code>hadoop/hello-mapreduce/../hdfs/zip</code></p><h1 id="yarn" tabindex="-1">YARN <a class="header-anchor" href="#yarn" aria-hidden="true">#</a></h1><p>Yarn 是一个资源调度平台，负责为运算程序提供服务器运算资源，相当于一个分布式的操作系统平台，而 MapReduce 等运算程序则相当于运行于操作系统之上的应用程序。</p><h2 id="yarn-基础架构" tabindex="-1">Yarn 基础架构 <a class="header-anchor" href="#yarn-基础架构" aria-hidden="true">#</a></h2><p>YARN 主要由 ResourceManager、NodeManager、ApplicationMaster 和 Container 等组件构成。</p><p><strong>ResourceManager 主要作用如下</strong></p><ol><li>处理客户端请求</li><li>监控 NodeManager</li><li>启动或监控 ApplicationMaster</li><li>资源的分配与调度</li></ol><p><strong>NodeManager（NM）主要作用如下</strong></p><ol><li>管理单个节点上的资源</li><li>处理来自 ResourceManager 的命令</li><li>处理来自 ApplicationMaster 的命令</li></ol><p><strong>ApplicationMaster（AM）作用如下</strong></p><ol><li>为应用程序申请资源并分配给内部的任务</li><li>任务的监控与容错</li></ol><p><strong>Container</strong></p><p>Container 是 YARN 中的资源抽象，它封装了某个节点上的多维度资源，如内存、CPU、磁 盘、网络等。</p><p><img src="https://img-blog.csdnimg.cn/33facb058f114500b3b74ea5d6909943.png" alt="在这里插入图片描述"></p><h2 id="yarn工作机制" tabindex="-1">YARN工作机制 <a class="header-anchor" href="#yarn工作机制" aria-hidden="true">#</a></h2><p><img src="https://img-blog.csdnimg.cn/58fc20358e96479f860a947dbfa19537.png" alt="在这里插入图片描述"></p><ol><li>MR 程序提交到客户端所在的节点。<code>Job#waitForCompletion()</code> 创建 YarnRunner</li><li>Yarn 向 ResourceManager 申请一个 Application，RM 将该应用程序的资源路径返回给 YarnRunner 。</li><li>该程序将运行所需资源提交到 HDFS 上 。</li><li>程序资源提交完毕后，申请运行 mrAppMaster 。</li><li>RM 将用户的请求初始化成一个 Task ，放入调度队列。</li><li>其中一个 NodeManager 领取到 Task 任务。</li><li>该 NodeManager 创建容器 Container，并产生 MRAppmaster。</li><li>Container 从 HDFS 上拷贝资源到本地。</li><li>MRAppmaster 向 RM 申请运行 MapTask 资源。</li><li>RM 将运行 MapTask 任务分配给另外两个 NodeManager，另两个 NodeManager 分别领取任务并创建容器。</li><li>MR 向两个接收到任务的 NodeManager 发送程序启动脚本，这两个 NodeManager分别启动 MapTask，MapTask 对数据分区排序。</li><li>MrAppMaster 等待所有 MapTask 运行完毕后，向 RM 申请容器，运行 ReduceTask。</li><li>ReduceTask 向 MapTask 获取相应分区的数据。</li><li>程序运行完毕后，MR 会向 RM 申请注销自己。</li></ol><h2 id="yarn-调度器和调度算法" tabindex="-1">Yarn 调度器和调度算法 <a class="header-anchor" href="#yarn-调度器和调度算法" aria-hidden="true">#</a></h2><p>目前，Hadoop 作业调度器主要有三种：FIFO、容量（Capacity Scheduler）和公平（Fair Scheduler）。Apache Hadoop3.1.3 默认的资源调度器是 Capacity Scheduler。CDH 框架默认调度器是 Fair Scheduler。</p><h3 id="先进先出调度器-fifo" tabindex="-1">先进先出调度器（FIFO） <a class="header-anchor" href="#先进先出调度器-fifo" aria-hidden="true">#</a></h3><p>FIFO 调度器（First In First Out）：单队列，根据提交作业的先后顺序，先来先服务。</p><h3 id="容量调度器-capacity-scheduler" tabindex="-1">容量调度器（Capacity Scheduler） <a class="header-anchor" href="#容量调度器-capacity-scheduler" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/93c2fa56748541ccbe1b73aaa1ee8a65.png" alt="在这里插入图片描述"></p><ol><li>多队列：每个队列可配置一定的资源量，每个队列采用FIFO调度策略。</li><li>容量保证：管理员可为每个队列设置资源最低保证和资源使用上限</li><li>灵活性：如果一个队列中的资源有剩余，可以暂时共享给那些需要资源的队列，而一旦该队列有新的应用程序提交，则其他队列借调的资源会归还给该队列。</li><li>多租户： <ul><li>支持多用户共享集群和多应用程序同时运行。</li><li>为了防止同一个用户的作业独占队列中的资源，该调度器会对同一用户提交的作业所占资源量进行限定。</li></ul></li></ol><p><strong>容量调度器资源分配算法</strong></p><p><img src="https://img-blog.csdnimg.cn/6625724dffad459ab6204811ec5482b4.png" alt="在这里插入图片描述"></p><h3 id="公平调度器-fair-scheduler" tabindex="-1">公平调度器（Fair Scheduler） <a class="header-anchor" href="#公平调度器-fair-scheduler" aria-hidden="true">#</a></h3><h2 id="yarn-常用命令" tabindex="-1">Yarn 常用命令 <a class="header-anchor" href="#yarn-常用命令" aria-hidden="true">#</a></h2><p>**查询任务列表 **</p><p><code>yarn application -list -appStates finished</code></p><p>states: [NEW, NEW_SAVING, SUBMITTED, ACCEPTED, RUNNING, FINISHED, FAILED, KILLED]</p><p><img src="https://img-blog.csdnimg.cn/f5b65a284a2144bea9bf3faf03d03e8d.png" alt="在这里插入图片描述"></p><p><strong>杀死应用程序</strong></p><p><code>yarn application -kill [application ID]</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">yarn application -kill application_1640246979505_0001</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">2021-12-23 17:33:02,104 INFO client.RMProxy: Connecting to ResourceManager at hadoop202/172.31.10.202:8032</span></span>
<span class="line"><span style="color:#A6ACCD;">Application application_1640246979505_0001 has already finished </span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>查看日志</strong></p><p><code>yarn logs -applicationId application_1640246979505_0001</code></p><p><strong>查看尝试运行的任务</strong></p><p><code>yarn applicationattempt -list application_1640246979505_0002</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">2021-12-23 17:42:29,838 INFO client.RMProxy: Connecting to ResourceManager at hadoop202/172.31.10.202:8032</span></span>
<span class="line"><span style="color:#A6ACCD;">Total number of application attempts :1</span></span>
<span class="line"><span style="color:#A6ACCD;">         ApplicationAttempt-Id	               State	                    AM-Container-Id	                       Tracking-URL</span></span>
<span class="line"><span style="color:#A6ACCD;">appattempt_1640246979505_0002_000001	            FINISHED	container_1640246979505_0002_01_000001	http://hadoop202:8088/proxy/application_1640246979505_0002/</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>ApplicationAttemp 状态</strong></p><p><code>yarn applicationattempt -status appattempt_1640246979505_0002_000001</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">2021-12-23 20:17:51,948 INFO client.RMProxy: Connecting to ResourceManager at hadoop202/172.31.10.202:8032</span></span>
<span class="line"><span style="color:#A6ACCD;">Application Attempt Report </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">	ApplicationAttempt-Id </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> appattempt_1640246979505_0002_000001</span></span>
<span class="line"><span style="color:#A6ACCD;">	State </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> FINISHED</span></span>
<span class="line"><span style="color:#A6ACCD;">	AMContainer </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> container_1640246979505_0002_01_000001</span></span>
<span class="line"><span style="color:#A6ACCD;">	Tracking-URL </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> http://hadoop202:8088/proxy/application_1640246979505_0002/</span></span>
<span class="line"><span style="color:#A6ACCD;">	RPC Port </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> 35243</span></span>
<span class="line"><span style="color:#A6ACCD;">	AM Host </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> hadoop203</span></span>
<span class="line"><span style="color:#A6ACCD;">	Diagnostics </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>查看 container 日志</strong></p><p><code>yarn logs -applicationId application_1640246979505_0002 -containerId container_1640246979505_0002_01_000001 </code></p><p><strong>yarn node 查看节点状态</strong></p><p><code>yarn node -list all</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">2021-12-23 20:19:35,826 INFO client.RMProxy: Connecting to ResourceManager at hadoop202/172.31.10.202:8032</span></span>
<span class="line"><span style="color:#A6ACCD;">Total Nodes:3</span></span>
<span class="line"><span style="color:#A6ACCD;">         Node-Id	     Node-State	Node-Http-Address	Number-of-Running-Containers</span></span>
<span class="line"><span style="color:#A6ACCD;"> hadoop201:35523	        RUNNING	   hadoop201:8042	                           0</span></span>
<span class="line"><span style="color:#A6ACCD;"> hadoop203:39840	        RUNNING	   hadoop203:8042	                           0</span></span>
<span class="line"><span style="color:#A6ACCD;"> hadoop202:40982	        RUNNING	   hadoop202:8042	                           0</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>yarn rmadmin 更新配置</strong></p><p>加载队列配置：<code>yarn rmadmin -refreshQueues</code></p><p><strong>yarn queue 查看队列</strong></p><p><code>yarn queue -status default</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">2021-12-23 20:22:16,517 INFO client.RMProxy: Connecting to ResourceManager at hadoop202/172.31.10.202:8032</span></span>
<span class="line"><span style="color:#A6ACCD;">Queue Information </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">Queue Name </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> default</span></span>
<span class="line"><span style="color:#A6ACCD;">	State </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> RUNNING</span></span>
<span class="line"><span style="color:#A6ACCD;">	Capacity </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> 100.0%</span></span>
<span class="line"><span style="color:#A6ACCD;">	Current Capacity </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> .0%</span></span>
<span class="line"><span style="color:#A6ACCD;">	Maximum Capacity </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> 100.0%</span></span>
<span class="line"><span style="color:#A6ACCD;">	Default Node Label expression </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">DEFAULT_PARTITION</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">	Accessible Node Labels </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#A6ACCD;">	Preemption </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> disabled</span></span>
<span class="line"><span style="color:#A6ACCD;">	Intra-queue Preemption </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> disabled</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="yarn-生产环境核心参数" tabindex="-1">Yarn 生产环境核心参数 <a class="header-anchor" href="#yarn-生产环境核心参数" aria-hidden="true">#</a></h2><h3 id="resourcemanager-相关" tabindex="-1">ResourceManager 相关 <a class="header-anchor" href="#resourcemanager-相关" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:left;">配置</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">yarn.resourcemanager.scheduler.class</td><td style="text-align:left;">配置调度器，默认容量</td></tr><tr><td style="text-align:left;">yarn.resourcemanager.scheduler.client.thread-count</td><td style="text-align:left;">ResourceManager处理调度器请求的线程数量，默认50</td></tr></tbody></table><h3 id="nodemanager-相关" tabindex="-1">NodeManager 相关 <a class="header-anchor" href="#nodemanager-相关" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:left;">配置</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">yarn.nodemanager.resource.detect-hardware-capabilities</td><td style="text-align:left;">是否让yarn自己检测硬件进行配置，默认false</td></tr><tr><td style="text-align:left;">yarn.nodemanager.resource.count-logical-processors-as-cores</td><td style="text-align:left;">是否将虚拟核数当作CPU核数，默认false</td></tr><tr><td style="text-align:left;">yarn.nodemanager.resource.pcores-vcores-multiplier</td><td style="text-align:left;">虚拟核数和物理核数乘数，例如：4核8线程，该参数就应设为2，默认1.0</td></tr><tr><td style="text-align:left;">yarn.nodemanager.resource.memory-mb</td><td style="text-align:left;">NodeManager使用内存，默认8G</td></tr><tr><td style="text-align:left;">yarn.nodemanager.resource.system-reserved-memory-mb</td><td style="text-align:left;">NodeManager为系统保留多少内存,以上二个参数配置一个即可</td></tr><tr><td style="text-align:left;">yarn.nodemanager.resource.cpu-vcores</td><td style="text-align:left;">NodeManager使用CPU核数，默认8个</td></tr><tr><td style="text-align:left;">yarn.nodemanager.pmem-check-enabled</td><td style="text-align:left;">是否开启物理内存检查限制container，默认打开</td></tr><tr><td style="text-align:left;">yarn.nodemanager.vmem-check-enabled</td><td style="text-align:left;">是否开启虚拟内存检查限制container，默认打开</td></tr><tr><td style="text-align:left;">yarn.nodemanager.vmem-pmem-ratio</td><td style="text-align:left;">虚拟内存物理内存比例，默认2.1</td></tr></tbody></table><h3 id="containe-相关" tabindex="-1">Containe 相关 <a class="header-anchor" href="#containe-相关" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:left;">配置</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">yarn.scheduler.minimum-allocation-mb</td><td style="text-align:left;">容器最最小内存，默认1G</td></tr><tr><td style="text-align:left;">yarn.scheduler.maximum-allocation-mb</td><td style="text-align:left;">容器最最大内存，默认8G</td></tr><tr><td style="text-align:left;">yarn.scheduler.minimum-allocation-vcores</td><td style="text-align:left;">容器最小CPU核数，默认1个</td></tr><tr><td style="text-align:left;">yarn.scheduler.maximum-allocation-vcores</td><td style="text-align:left;">容器最大CPU核数，默认4个</td></tr></tbody></table><h2 id="tools" tabindex="-1">Tools <a class="header-anchor" href="#tools" aria-hidden="true">#</a></h2><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">util</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Tool</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">conf</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Configuration</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WordCountTools</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">implements</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Tool</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">run</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">Job</span><span style="color:#A6ACCD;"> job </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getInstance</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">waitForCompletion</span><span style="color:#89DDFF;">(true)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setConf</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> conf</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getConf</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> conf</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">conf</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Configuration</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">util</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Tool</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">util</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">ToolRunner</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">util</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Arrays</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WordCountDriver</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Tool</span><span style="color:#A6ACCD;"> tool</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 1. 创建配置文件</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 2. 判断是否有 tool 接口</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">switch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">]){</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">case</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">wordcount</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">                tool </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">WordCountTools</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">break</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">default:</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">throw</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">RuntimeException</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> No such tool: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> args</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 3. 用 Tool 执行程序</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// Arrays.copyOfRange 将老数组的元素放到新数组里面</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> run </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ToolRunner</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">run</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> tool</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Arrays</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">copyOfRange</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> args</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">        System</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">exit</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">run</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><div class="language-shell script"><button title="Copy Code" class="copy"></button><span class="lang">shell script</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">yarn jar hello-yarn.jar com.laoshiren.hello.yarn.tools.WordCountDriver wordcount /input /output</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-985bfe51 data-v-e307488e><div class="edit-info" data-v-e307488e><!----><div class="last-updated" data-v-e307488e><p class="VPLastUpdated" data-v-e307488e data-v-113508ec>Last updated: <time datetime="2023-04-06T06:51:47.000Z" data-v-113508ec></time></p></div></div><div class="prev-next" data-v-e307488e><div class="pager" data-v-e307488e><a class="pager-link prev" href="/study/bigdata/datawarehouse.html" data-v-e307488e><span class="desc" data-v-e307488e>Previous page</span><span class="title" data-v-e307488e>datawarehouse</span></a></div><div class="has-prev pager" data-v-e307488e><a class="pager-link next" href="/study/algorithm/CommonAlgorithm.html" data-v-e307488e><span class="desc" data-v-e307488e>Next page</span><span class="title" data-v-e307488e>基础算法</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-7722a5de data-v-a7e87a59><div class="container" data-v-a7e87a59><p class="message" data-v-a7e87a59>Released under the MIT License.</p><p class="copyright" data-v-a7e87a59>Copyright © 2018-present Laoshiren</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"0001_01-设计秒杀系统时应该注意的5个架构原则.md\":\"848213bb\",\"0001_03-二八原则：有针对性地处理好系统的“热点数据”.md\":\"652531b8\",\"0001_04-流量削峰这事应该怎么做？.md\":\"11cd13be\",\"0001_05-影响性能的因素有哪些？又该如何提高系统的性能？.md\":\"e6ee2c92\",\"0001_06-秒杀系统“减库存”设计的核心逻辑.md\":\"9a9af3b5\",\"0001_07-准备plan b：如何设计兜底方案？.md\":\"48d033da\",\"0002_00开篇_00-开篇词-为什么你要学习高并发系统设计？.md\":\"ce12b4cf\",\"0002_01基础_01-高并发系统：它的通用设计方法是什么？.md\":\"be66f3d0\",\"0002_01基础_02-架构分层：我们为什么一定要这么做？.md\":\"041f3d45\",\"0002_01基础_03-系统设计目标（一）：如何提升系统性能？.md\":\"7f07df42\",\"0002_01基础_04-系统设计目标（二）：系统怎样做到高可用？.md\":\"18a96f20\",\"0002_01基础_05-系统设计目标（三）：如何让系统易于扩展？.md\":\"4a10fe82\",\"0002_02演进-数据库_07-池化技术：如何减少频繁创建数据库连接的性能损耗？.md\":\"8c8706c8\",\"0002_02演进-数据库_08-数据库优化方案（一）：查询请求增加时，如何做主从分离？.md\":\"a89b6e20\",\"0002_02演进-数据库_09-数据库优化方案（二）：写入数据量增加时，如何实现分库分表？.md\":\"bcf9aaca\",\"0002_02演进-数据库_10-发号器：如何保证分库分表后id的全局唯一性？.md\":\"b7a417db\",\"0002_02演进-数据库_11-nosql：在高并发场景下，数据库和nosql如何做到互补？.md\":\"3af98b23\",\"0002_03演进-缓存_12-缓存：数据库成为瓶颈后，动态数据的查询要如何加速？.md\":\"36c0ce01\",\"0002_03演进-缓存_13-缓存的使用姿势（一）：如何选择缓存的读写策略？.md\":\"61c7fca4\",\"0002_03演进-缓存_14-缓存的使用姿势（二）：缓存如何做到高可用？.md\":\"716fe02a\",\"0002_03演进-缓存_15-缓存的使用姿势（三）：缓存穿透了怎么办？.md\":\"2f90714d\",\"0002_03演进-缓存_16-cdn：静态资源如何加速？.md\":\"721761e8\",\"0002_03演进-缓存_加餐-数据的签约应该如何做？.md\":\"c330d8c2\",\"0002_04演进-消息队列_17-消息队列：秒杀如何处理每秒上万的下单请求？.md\":\"46d1fb8b\",\"0002_04演进-消息队列_18-消息投递：如何保证消息仅仅被消费一次？.md\":\"b91c0102\",\"0002_04演进-消息队列_19-消息队列如何降低消息队列系统中消息的延迟？.md\":\"55d00d3d\",\"0002_04演进-消息队列_20-当问到项目经历时，面试官究竟想要了解什么？.md\":\"586ca428\",\"0002_05演进-分布式服务_21-系统架构：每秒1万次请求的系统要做服务化拆分吗？.md\":\"5673e10d\",\"0002_05演进-分布式服务_22-微服务架构：微服务化后系统架构要如何改造？.md\":\"865f574c\",\"0002_05演进-分布式服务_23-rpc框架：10万qps下如何实现毫秒级的服务调用？.md\":\"99677b58\",\"0002_05演进-分布式服务_24-注册中心：分布式系统如何寻址？.md\":\"f7da0f54\",\"0002_05演进-分布式服务_25-分布式trace：横跨几十个分布式组件的慢请求要如何排查？.md\":\"568f778e\",\"0002_05演进-分布式服务_26-负载均衡：怎样提升系统的横向扩展能力？.md\":\"3210f592\",\"0002_05演进-分布式服务_27-api网关：系统的门面要如何做呢？.md\":\"8915ca6f\",\"0002_05演进-分布式服务_28-多机房部署：跨地域的分布式系统如何做？.md\":\"3d3122fd\",\"0002_05演进-分布式服务_29-service mesh：如何屏蔽服务化系统的服务治理细节？.md\":\"b38c42fb\",\"0002_06演进-维护_30-给系统加上眼睛：服务端监控要怎么做？.md\":\"59c04bc4\",\"0002_06演进-维护_31-应用性能管理：用户的使用体验应该如何监控？.md\":\"8f4507cd\",\"0002_06演进-维护_32-压力测试：怎样设计全链路压力测试平台？.md\":\"7d2829f6\",\"0002_06演进-维护_33-配置管理：成千上万的配置项要如何管理？.md\":\"82020c39\",\"0002_06演进-维护_34-降级熔断：如何屏蔽非核心系统故障的影响？.md\":\"82cf91f2\",\"0002_06演进-维护_35-流量控制：高并发系统中我们如何操纵流量？.md\":\"80f44f96\",\"0002_07实战_37-计数系统设计（一）：面对海量数据的计数器要如何做？.md\":\"f8736722\",\"0002_07实战_38-计数系统设计（二）：50万qps下如何设计未读数系统？.md\":\"10ffe3e4\",\"0002_07实战_39-信息流设计（一）：通用信息流系统的推模式要如何做？.md\":\"2c737152\",\"0002_07实战_40-信息流设计（二）：通用信息流系统的拉模式要如何做？.md\":\"d5d26598\",\"0002_08结束_结束语-学不可以已.md\":\"998f2b52\",\"readme.md\":\"e8cfcf96\",\"articles_live.md\":\"74406a7e\",\"articles_study.md\":\"84b3a525\",\"book_index.md\":\"d126f2fd\",\"cloud_alibaba_nacos.md\":\"2d44c74a\",\"cloud_alibaba_seata.md\":\"eb0fe896\",\"cloud_alibaba_sentinel.md\":\"a13241fb\",\"cloud_alibaba_stream.md\":\"22bcbd8a\",\"cloud_netflix_config.md\":\"0c4d1306\",\"cloud_netflix_eureka.md\":\"3c37f036\",\"cloud_netflix_gateway.md\":\"c7236e8a\",\"cloud_netflix_hystrix.md\":\"73de811f\",\"cloud_netflix_loadbalancer.md\":\"c79ad60d\",\"guide_config.md\":\"acf0ea3a\",\"guide_dark.md\":\"1e23b031\",\"guide_index.md\":\"a59b0c39\",\"guide_info.md\":\"180ad34c\",\"guide_lang.md\":\"ca6987c1\",\"guide_prodir.md\":\"ea9e499d\",\"guide_question.md\":\"d12e4711\",\"guide_start.md\":\"c2532e63\",\"index.md\":\"862a59ca\",\"jvm_jvm01.md\":\"1464a76e\",\"member_index.md\":\"9481831d\",\"mq_rabbit_rabbitmq.md\":\"6da17e92\",\"mq_rocket_rocketmq.md\":\"fb711775\",\"study_algorithm_commonalgorithm.md\":\"83f5576a\",\"study_algorithm_dp.md\":\"31d48461\",\"study_alibaba_index.md\":\"0732c11e\",\"study_bigdata_datawarehouse.md\":\"cbb0a773\",\"study_bigdata_hdfs.md\":\"35a7c82b\",\"study_cloud_index.md\":\"2d2c2096\",\"study_database_es.md\":\"2d18d35e\",\"study_database_mysql.md\":\"d93d2e16\",\"study_database_redis.md\":\"660be3a1\",\"study_docker_index.md\":\"6b7b0750\",\"study_framework_mybatis第1讲.md\":\"f70ec519\",\"study_framework_spring第1讲.md\":\"7f0669e6\",\"study_framework_spring第2讲.md\":\"10c74da8\",\"study_framework_spring第3讲.md\":\"5c647151\",\"study_framework_spring第4讲.md\":\"18e6836e\",\"study_framework_spring第5讲.md\":\"e20c7542\",\"study_framework_spring第6讲.md\":\"8e4bcb1c\",\"study_framework_spring第7讲.md\":\"b957c8b7\",\"study_framework_spring第8讲.md\":\"29dafb13\",\"study_framework_手写一个spring项目.md\":\"fa32b152\",\"study_java_base.md\":\"3eab3c21\",\"study_java_feature.md\":\"930f2ce9\",\"study_java_lock.md\":\"1bfd3849\",\"study_java_pattern.md\":\"3ac1f7e3\",\"study_java_pattern_readme.behavior.md\":\"3d88b0d8\",\"study_java_pattern_readme.creative.md\":\"aac51ba3\",\"study_java_pattern_readme.structural.md\":\"9b490602\",\"study_java_pattern_oop.md\":\"86e87f66\",\"study_java_thread.md\":\"b6a7881b\",\"study_middleware_database-sharding-jdbc.md\":\"e19e542f\",\"study_middleware_flowable.md\":\"552b3b7c\",\"study_middleware_mq.md\":\"ead7fe36\"}")</script>
    <script type="module" async src="/assets/app.303cfecc.js"></script>
    
  </body>
</html>