import{_ as s,o as n,c as a,a as l}from"./app.303cfecc.js";const i=JSON.parse('{"title":"Spring \u7B2C\u516B\u8BB2 MVC","description":"","frontmatter":{},"headers":[{"level":2,"title":"DispatcherServlet","slug":"dispatcherservlet","link":"#dispatcherservlet","children":[]},{"level":2,"title":"DispatcherServlet \u521D\u59CB\u5316\u65F6\u673A","slug":"dispatcherservlet-\u521D\u59CB\u5316\u65F6\u673A","link":"#dispatcherservlet-\u521D\u59CB\u5316\u65F6\u673A","children":[]},{"level":2,"title":"DispatcherServlet \u521D\u59CB\u5316","slug":"dispatcherservlet-\u521D\u59CB\u5316","link":"#dispatcherservlet-\u521D\u59CB\u5316","children":[{"level":3,"title":"RequestMappingHandlerMapping","slug":"requestmappinghandlermapping","link":"#requestmappinghandlermapping","children":[]},{"level":3,"title":"RequestMappingHandlerAdapter","slug":"requestmappinghandleradapter","link":"#requestmappinghandleradapter","children":[]}]},{"level":2,"title":"\u81EA\u5B9A\u4E49HandlerMethodArgumentResolver","slug":"\u81EA\u5B9A\u4E49handlermethodargumentresolver","link":"#\u81EA\u5B9A\u4E49handlermethodargumentresolver","children":[]},{"level":2,"title":"\u81EA\u5B9A\u4E49HandlerMethodReturnValueHandler","slug":"\u81EA\u5B9A\u4E49handlermethodreturnvaluehandler","link":"#\u81EA\u5B9A\u4E49handlermethodreturnvaluehandler","children":[]},{"level":2,"title":"MVC \u5904\u7406\u6D41\u7A0B","slug":"mvc-\u5904\u7406\u6D41\u7A0B","link":"#mvc-\u5904\u7406\u6D41\u7A0B","children":[]}],"relativePath":"study/framework/spring\u7B2C8\u8BB2.md","lastUpdated":1680763907000}'),p={name:"study/framework/spring\u7B2C8\u8BB2.md"},e=l(`<h1 id="spring-\u7B2C\u516B\u8BB2-mvc" tabindex="-1">Spring \u7B2C\u516B\u8BB2 MVC <a class="header-anchor" href="#spring-\u7B2C\u516B\u8BB2-mvc" aria-hidden="true">#</a></h1><nav class="table-of-contents"><ul><li><a href="#dispatcherservlet">DispatcherServlet</a></li><li><a href="#dispatcherservlet-\u521D\u59CB\u5316\u65F6\u673A">DispatcherServlet \u521D\u59CB\u5316\u65F6\u673A</a></li><li><a href="#dispatcherservlet-\u521D\u59CB\u5316">DispatcherServlet \u521D\u59CB\u5316</a><ul><li><a href="#requestmappinghandlermapping">RequestMappingHandlerMapping</a></li><li><a href="#requestmappinghandleradapter">RequestMappingHandlerAdapter</a></li></ul></li><li><a href="#\u81EA\u5B9A\u4E49handlermethodargumentresolver">\u81EA\u5B9A\u4E49HandlerMethodArgumentResolver</a></li><li><a href="#\u81EA\u5B9A\u4E49handlermethodreturnvaluehandler">\u81EA\u5B9A\u4E49HandlerMethodReturnValueHandler</a></li><li><a href="#mvc-\u5904\u7406\u6D41\u7A0B">MVC \u5904\u7406\u6D41\u7A0B</a></li></ul></nav><p>pom.xml \u51C6\u5907</p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">project</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://maven.apache.org/POM/4.0.0</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">         </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">xsi</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">         </span><span style="color:#C792EA;">xsi</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">schemaLocation</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">modelVersion</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">4.0.0</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">modelVersion</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">parent</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">org.springframework.boot</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">spring-boot-starter-parent</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">2.5.5</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">relativePath</span><span style="color:#89DDFF;">/&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">parent</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">org.laoshiren</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">spring-bean-init</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">1.0-SNAPSHOT</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">properties</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">maven.compiler.source</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">8</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">maven.compiler.source</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">maven.compiler.target</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">8</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">maven.compiler.target</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">aspectj.version</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">1.9.7</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">aspectj.version</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">properties</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">dependencies</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">org.springframework.boot</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">spring-boot-starter-web</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">org.projectlombok</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">lombok</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">dependencies</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">project</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h2 id="dispatcherservlet" tabindex="-1">DispatcherServlet <a class="header-anchor" href="#dispatcherservlet" aria-hidden="true">#</a></h2><p>\u4EC0\u4E48\u662FDispatcherServlet\uFF1F DispatcherServlet\u662F\u524D\u7F6E\u63A7\u5236\u5668\uFF0C\u914D\u7F6E\u5728web.xml\u6587\u4EF6\u4E2D\u7684\u3002\u62E6\u622A\u5339\u914D\u7684\u8BF7\u6C42\uFF0CServlet\u62E6\u622A\u5339\u914D\u89C4\u5219\u8981\u81EA\u5DF1\u5B9A\u4E49\uFF0C\u628A\u62E6\u622A\u4E0B\u6765\u7684\u8BF7\u6C42\uFF0C\u4F9D\u636E\u76F8\u5E94\u7684\u89C4\u5219\u5206\u53D1\u5230\u76EE\u6807Controller\u6765\u5904\u7406\u3002</p><p><img src="https://pic.img.ski/1675666417.png" alt="a.png"></p><p>\u6211\u4EEC\u5C31\u770B\u770B\u5982\u4F55\u914D\u7F6E\u5728spring \u4E2D\u5982\u4F55\u914D\u7F6E</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DispatchServletInit</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u652F\u6301\u5185\u5D4Cweb \u5BB9\u5668</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">AnnotationConfigServletWebServerApplicationContext</span><span style="color:#A6ACCD;"> context </span><span style="color:#89DDFF;">=</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">AnnotationConfigServletWebServerApplicationContext</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">WebConfig</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Configuration</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">ComponentScan</span></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WebConfig</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u5185\u5D4Cweb\u5BB9\u5668\u7684\u914D\u7F6E\u7C7B \u67093\u9879\u662F\u5FC5\u987B\u914D\u7F6E\u7684</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 1. \u5185\u5D4Cweb \u5BB9\u5668\u5DE5\u5382</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Bean</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">TomcatServletWebServerFactory</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">tomcatServletWebServerFactory</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">TomcatServletWebServerFactory</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 2. DispatchServlet</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Bean</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DispatcherServlet</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">dispatcherServlet</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DispatcherServlet</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 3. \u6CE8\u518CBean \u5C06DispatchServlet \u6CE8\u518C\u5230web \u5BB9\u5668\u4E2D</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Bean</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DispatcherServletRegistrationBean</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">dispatcherServletRegistrationBean</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">DispatcherServlet</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">dispatcherServlet</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DispatcherServletRegistrationBean</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dispatcherServlet</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>\u53EF\u4EE5\u76F4\u63A5\u8BBF\u95EE<code>localhost:8080</code></p><h2 id="dispatcherservlet-\u521D\u59CB\u5316\u65F6\u673A" tabindex="-1">DispatcherServlet \u521D\u59CB\u5316\u65F6\u673A <a class="header-anchor" href="#dispatcherservlet-\u521D\u59CB\u5316\u65F6\u673A" aria-hidden="true">#</a></h2><p>\u521D\u6B21\u8BBF\u95EE\u6211\u4EEC\u76F4\u63A5\u62A5\u9519\uFF0C\u6BD5\u7ADF\u91CC\u9762\u4EC0\u4E48\u4E5F\u6CA1\u5199\uFF0C\u4F46\u662F\u6211\u4EEC\u8FD8\u662F\u770B\u5230\u4E86 \u521D\u59CB\u5316 <code>Initializing Spring DispatcherServlet &#39;dispatcherServlet&#39;</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">\u4E8C\u6708 05, 2023 10:32:57 \u4E0B\u5348 org.apache.catalina.core.ApplicationContext log</span></span>
<span class="line"><span style="color:#A6ACCD;">\u4FE1\u606F: Initializing Spring DispatcherServlet </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dispatcherServlet</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">22:32:57.857 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">http-nio-8080-exec-1</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> INFO org.springframework.web.servlet.DispatcherServlet - Initializing Servlet </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dispatcherServlet</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">22:32:57.881 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">http-nio-8080-exec-1</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> DEBUG _org.springframework.web.servlet.HandlerMapping.Mappings - </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> {}</span></span>
<span class="line"><span style="color:#A6ACCD;">22:32:58.164 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">http-nio-8080-exec-1</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> DEBUG org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter - ControllerAdvice beans: none</span></span>
<span class="line"><span style="color:#A6ACCD;">22:32:58.196 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">http-nio-8080-exec-1</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> DEBUG org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - ControllerAdvice beans: none</span></span>
<span class="line"><span style="color:#A6ACCD;">22:32:58.210 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">http-nio-8080-exec-1</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> DEBUG org.springframework.web.servlet.DispatcherServlet - enableLoggingRequestDetails=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">false</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">: request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data</span></span>
<span class="line"><span style="color:#A6ACCD;">22:32:58.210 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">http-nio-8080-exec-1</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> INFO org.springframework.web.servlet.DispatcherServlet - Completed initialization </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> 353 ms</span></span>
<span class="line"><span style="color:#A6ACCD;">22:32:58.219 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">http-nio-8080-exec-1</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> DEBUG org.springframework.web.servlet.DispatcherServlet - GET </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">, parameters={}</span></span>
<span class="line"><span style="color:#A6ACCD;">22:32:58.227 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">http-nio-8080-exec-1</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> WARN org.springframework.web.servlet.PageNotFound - No mapping </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> GET /</span></span>
<span class="line"><span style="color:#A6ACCD;">22:32:58.228 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">http-nio-8080-exec-1</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> DEBUG org.springframework.web.servlet.DispatcherServlet - Completed 404 NOT_FOUND</span></span>
<span class="line"><span style="color:#A6ACCD;">22:32:58.256 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">http-nio-8080-exec-2</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> DEBUG org.springframework.web.servlet.DispatcherServlet - GET </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/favicon.ico</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">, parameters={}</span></span>
<span class="line"><span style="color:#A6ACCD;">22:32:58.256 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">http-nio-8080-exec-2</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> WARN org.springframework.web.servlet.PageNotFound - No mapping </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> GET /favicon.ico</span></span>
<span class="line"><span style="color:#A6ACCD;">22:32:58.256 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">http-nio-8080-exec-2</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> DEBUG org.springframework.web.servlet.DispatcherServlet - Completed 404 NOT_FOUND</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>\u5F53\u6211\u4EEC\u542F\u52A8\u9879\u76EE\u7684\u65F6\u5019\uFF0C\u53D1\u73B0\u5E76\u4E0D\u662F\u4E00\u5F00\u59CB\u5C31\u521D\u59CB\u5316\u7684\uFF0C\u800C\u662F\u5728\u7B2C\u4E00\u6B21\u8BF7\u6C42\u7684\u65F6\u5019\u624D\u5F00\u59CB\u521D\u59CB\u5316\uFF0C\u8BE6\u60C5\u770B<code>DispatcherServlet#onRefresh()</code> \u7684\u8C03\u7528\u94FE\u8DEF \uFF0C\u90A3\u5982\u4F55\u8BBE\u7F6Etomcat \u4E00\u542F\u52A8\u5C31\u521D\u59CB\u5316DispatcherServlet \u5462\uFF1F</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WebConfig</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Bean</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DispatcherServletRegistrationBean</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">dispatcherServletRegistrationBean</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">DispatcherServlet</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">dispatcherServlet</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">DispatcherServletRegistrationBean</span><span style="color:#A6ACCD;"> registrationBean </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DispatcherServletRegistrationBean</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dispatcherServlet</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// tomcat\u542F\u52A8\u65F6 \u5C31\u521D\u59CB\u5316\uFF0C\u5982\u679C\u4F7F\u7528\u591A\u4E2AServlet \u90A3\u6570\u5B57\u5C31\u4EE3\u8868\u4F18\u5148\u7EA7</span></span>
<span class="line"><span style="color:#A6ACCD;">        registrationBean</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setLoadOnStartup</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> registrationBean</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>\u9ED8\u8BA4\u503C\u5C31\u662F-1 \u5373\u4E0D\u521D\u59CB\u5316</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ServletRegistrationBean</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">T</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Servlet</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DynamicRegistrationBean</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">ServletRegistration</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Dynamic</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> loadOnStartup </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u5728springboot \u9879\u76EE\u4E2D\u4F7F\u7528<code>spring.mvc.servlet.load-on-startup=1</code></p><h2 id="dispatcherservlet-\u521D\u59CB\u5316" tabindex="-1">DispatcherServlet \u521D\u59CB\u5316 <a class="header-anchor" href="#dispatcherservlet-\u521D\u59CB\u5316" aria-hidden="true">#</a></h2><p>\u6211\u4EEC\u7C97\u770B\u4E00\u4E0B<code>DispatcherServlet#onRefresh()</code></p><p><img src="https://pic.img.ski/1675610029.png" alt="DispatcherServlet#onRefresh.png"></p><h3 id="requestmappinghandlermapping" tabindex="-1">RequestMappingHandlerMapping <a class="header-anchor" href="#requestmappinghandlermapping" aria-hidden="true">#</a></h3><p>\u4EC0\u4E48\u662F<code>RequestMappingHandlerMapping</code>\uFF1F \u4ED6\u5176\u5B9E\u662F\u89E3\u6790<code>@RequestMapping</code> \u6D3E\u751F\u6CE8\u89E3\u5EFA\u7ACB\u8BF7\u6C42\u8DEF\u5F84\u548C\u5904\u7406\u5668\u6620\u5C04\u5173\u7CFB\u3002\u6839\u636E\u8BF7\u6C42\u5FEB\u901F\u627E\u5230\u54EA\u4E2A\u63A7\u5236\u5668\u7684\u54EA\u4E2A\u65B9\u6CD5\u8FDB\u884C\u5904\u7406\u3002</p><p>\u7B2C\u4E00\u6B65\u5C31\u662F\u8986\u76D6\u6389\u9ED8\u8BA4\u914D\u7F6E</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Configuration</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">ComponentScan</span></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WebConfig1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u52A0\u5165RequestMappingHandlerMapping</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Bean</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">RequestMappingHandlerMapping</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">requestMappingHandlerMapping</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">RequestMappingHandlerMapping</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>\u5176\u6B21\u968F\u4FBF\u5B9A\u4E49\u4E00\u4E2AController</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Slf4j</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Controller</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TestController</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">GetMapping</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/get</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">ModelAndView</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">        log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">get</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">PostMapping</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/post</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">ModelAndView</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">post</span><span style="color:#89DDFF;">(@</span><span style="color:#C792EA;">RequestParam</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#A6ACCD;">        log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">post {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> name</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">PutMapping</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/put</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">ModelAndView</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">put</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">        log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">put</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">RequestMapping</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/request</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">ModelAndView</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">request</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">        log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">request</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>\u5728\u5BB9\u5668\u4E2D\u67E5\u627E<code>RequestMappingHandlerMapping</code></p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RequestMappingHandlerMappingMain</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">AnnotationConfigServletWebServerApplicationContext</span><span style="color:#A6ACCD;"> context </span><span style="color:#89DDFF;">=</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">AnnotationConfigServletWebServerApplicationContext</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">WebConfig1</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u7528\u4E8E\u89E3\u6790 @Request @GetMapping \u6D3E\u751F\u6CE8\u89E3 \u5E76\u5B58\u50A8\u63A7\u5236\u5668\u65B9\u6CD5\u6620\u5C04\u5173\u7CFB</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">RequestMappingHandlerMapping</span><span style="color:#A6ACCD;"> hm </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBean</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">RequestMappingHandlerMapping</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">Map</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">RequestMappingInfo</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">HandlerMethod</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> handlerMethods </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> hm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHandlerMethods</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        handlerMethods</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forEach</span><span style="color:#89DDFF;">((</span><span style="color:#A6ACCD;">k</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">v</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">-&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">k</span><span style="color:#89DDFF;">+</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> = </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">v</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">});</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u6839\u636E\u8BF7\u6C42\u83B7\u53D6\u63A7\u5236\u5668\u65B9\u6CD5</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">MockHttpServletRequest</span><span style="color:#A6ACCD;"> request </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MockHttpServletRequest</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">GET</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/get</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u8FD4\u56DE\u63A7\u5236\u5668\u65B9\u6CD5 \u5904\u7406\u5668\u6267\u884C\u94FE\uFF0C\uFF08\u63A7\u5236\u5668\u65B9\u6CD5\uFF0C\u62E6\u622A\u5668\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">HandlerExecutionChain</span><span style="color:#A6ACCD;"> handlerChain </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> hm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHandler</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">request</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">handlerChain</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>\u5982\u679C\u6CA1\u6709<code>MockHttpServletRequest</code>\u7C7B\uFF0C\u5C06 <code>&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</code> scope \u4FEE\u6539\u6210 compile</p><h3 id="requestmappinghandleradapter" tabindex="-1">RequestMappingHandlerAdapter <a class="header-anchor" href="#requestmappinghandleradapter" aria-hidden="true">#</a></h3><p>\u4F5C\u7528\u5C31\u662F\u8C03\u7528\u63A7\u5236\u5668\u65B9\u6CD5</p><p>\u4E00\u6837\u9996\u5148\u8986\u76D6\u6389\u9ED8\u8BA4\u914D\u7F6E\uFF0C\u56E0\u4E3A\u9700\u8981\u8C03\u7528 invokeHandlerMethod() \u65B9\u6CD5\uFF0C\u4F46\u662F\u9ED8\u8BA4\u5B9E\u73B0\u53C8\u662Fprotected \u4FEE\u9970\u7684\u65E0\u6CD5\u8C03\u7528\uFF0C\u6240\u4EE5\u8981\u91CD\u5199RequestMappingHandlerAdapter</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MyRequestMappingHandlerAdapter</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RequestMappingHandlerAdapter</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u4EC5\u4EC5\u4FEE\u6539\u8BBF\u95EE\u4FEE\u9970\u7B26</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">ModelAndView</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">invokeHandlerMethod</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">HttpServletRequest</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">request</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">HttpServletResponse</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">response</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">HandlerMethod</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">handlerMethod</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> super</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">invokeHandlerMethod</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">request</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> response</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> handlerMethod</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Configuration</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">ComponentScan</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">basePackages</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">com.laoshiren.app.controller</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WebConfig2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Bean</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">RequestMappingHandlerAdapter</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">requestMappingHandlerAdapter</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MyRequestMappingHandlerAdapter</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RequestMappingHandlerMappingMain</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">AnnotationConfigServletWebServerApplicationContext</span><span style="color:#A6ACCD;"> context </span><span style="color:#89DDFF;">=</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">AnnotationConfigServletWebServerApplicationContext</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">WebConfig2</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">RequestMappingHandlerMapping</span><span style="color:#A6ACCD;"> hm </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBean</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">RequestMappingHandlerMapping</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u6839\u636E\u8BF7\u6C42\u83B7\u53D6\u63A7\u5236\u5668\u65B9\u6CD5</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">MockHttpServletRequest</span><span style="color:#A6ACCD;"> request </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MockHttpServletRequest</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">GET</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/get</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u8BBE\u7F6E\u53C2\u6570</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// request.setParameter(&quot;name&quot;,&quot;laoshiren&quot;);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u8FD4\u56DE\u63A7\u5236\u5668\u65B9\u6CD5 \u5904\u7406\u5668\u6267\u884C\u94FE\uFF0C\uFF08\u63A7\u5236\u5668\u65B9\u6CD5\uFF0C\u62E6\u622A\u5668\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">HandlerExecutionChain</span><span style="color:#A6ACCD;"> handlerChain </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> hm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHandler</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">request</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">MyRequestMappingHandlerAdapter</span><span style="color:#A6ACCD;"> adapter </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBean</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">MyRequestMappingHandlerAdapter</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">ModelAndView</span><span style="color:#A6ACCD;"> modelAndView </span><span style="color:#89DDFF;">=</span></span>
<span class="line"><span style="color:#A6ACCD;">                adapter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">invokeHandlerMethod</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#89DDFF;">                        </span><span style="color:#676E95;">// \u8BF7\u6C42</span></span>
<span class="line"><span style="color:#A6ACCD;">                        request</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">                        </span><span style="color:#676E95;">// \u54CD\u5E94</span></span>
<span class="line"><span style="color:#A6ACCD;">                        </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MockHttpServletResponse</span><span style="color:#89DDFF;">(),</span></span>
<span class="line"><span style="color:#89DDFF;">                        </span><span style="color:#676E95;">// \u5BF9\u5E94\u7684handlerMethod</span></span>
<span class="line"><span style="color:#A6ACCD;">                        </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">HandlerMethod</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> handlerChain</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHandler</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">        System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">modelAndView</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="\u81EA\u5B9A\u4E49handlermethodargumentresolver" tabindex="-1">\u81EA\u5B9A\u4E49HandlerMethodArgumentResolver <a class="header-anchor" href="#\u81EA\u5B9A\u4E49handlermethodargumentresolver" aria-hidden="true">#</a></h2><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Target</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ElementType</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">PARAMETER</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Retention</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">RetentionPolicy</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">RUNTIME</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">interface</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Token</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u81EA\u5B9A\u4E49\u89E3\u6790\u5668</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenArgumentResolver</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">implements</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">HandlerMethodArgumentResolver</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u662F\u5426\u652F\u6301\u67D0\u4E2A\u53C2\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">boolean</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">supportsParameter</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">MethodParameter</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">parameter</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u53C2\u6570\u4E0A\u662F\u5426\u5B58\u5728@Token \u6CE8\u89E3</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> parameter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">hasParameterAnnotation</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Token</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u5177\u4F53\u89E3\u6790\u53C2\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">resolveArgument</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">MethodParameter</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">parameter</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                                  </span><span style="color:#C792EA;">ModelAndViewContainer</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">mavContainer</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">                                  </span><span style="color:#676E95;">// request Response \u5C01\u88C5</span></span>
<span class="line"><span style="color:#A6ACCD;">                                  </span><span style="color:#C792EA;">NativeWebRequest</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">webRequest</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                                  </span><span style="color:#C792EA;">WebDataBinderFactory</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">binderFactory</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> token </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> webRequest</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHeader</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">token</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> token</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>\u5C06\u81EA\u5B9A\u4E49\u89E3\u6790\u5668\u6CE8\u518C\u5230adapter\u4E0A</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Configuration</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">ComponentScan</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">basePackages</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">com.laoshiren.app.controller</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WebConfig2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Bean</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">RequestMappingHandlerAdapter</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">requestMappingHandlerAdapter</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">MyRequestMappingHandlerAdapter</span><span style="color:#A6ACCD;"> myRequestMappingHandlerAdapter </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MyRequestMappingHandlerAdapter</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u8BF7\u6C42\u53C2\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">TokenArgumentResolver</span><span style="color:#A6ACCD;"> argumentResolver </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">TokenArgumentResolver</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">HandlerMethodArgumentResolver</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> arrayList </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">ArrayList</span><span style="color:#89DDFF;">&lt;&gt;();</span></span>
<span class="line"><span style="color:#A6ACCD;">        arrayList</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">argumentResolver</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        myRequestMappingHandlerAdapter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setCustomArgumentResolvers</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">arrayList</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> myRequestMappingHandlerAdapter</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>\u6D4B\u8BD5</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RequestMappingHandlerMappingMain</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">AnnotationConfigServletWebServerApplicationContext</span><span style="color:#A6ACCD;"> context </span><span style="color:#89DDFF;">=</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">AnnotationConfigServletWebServerApplicationContext</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">WebConfig2</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">RequestMappingHandlerMapping</span><span style="color:#A6ACCD;"> hm </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBean</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">RequestMappingHandlerMapping</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u6839\u636E\u8BF7\u6C42\u83B7\u53D6\u63A7\u5236\u5668\u65B9\u6CD5</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">MockHttpServletRequest</span><span style="color:#A6ACCD;"> request </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MockHttpServletRequest</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">GET</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/get</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u8FD4\u56DE\u63A7\u5236\u5668\u65B9\u6CD5 \u5904\u7406\u5668\u6267\u884C\u94FE\uFF0C\uFF08\u63A7\u5236\u5668\u65B9\u6CD5\uFF0C\u62E6\u622A\u5668\uFF09</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// HandlerExecutionChain handlerChain = hm.getHandler(request);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">MyRequestMappingHandlerAdapter</span><span style="color:#A6ACCD;"> adapter </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBean</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">MyRequestMappingHandlerAdapter</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u53C2\u6570\u89E3\u6790\u5668 \uFF0CRequestBody Cookie \u7B49</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">HandlerMethodArgumentResolver</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> argumentResolvers </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> adapter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getArgumentResolvers</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">MockHttpServletRequest</span><span style="color:#A6ACCD;"> tokenRequest </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MockHttpServletRequest</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">GET</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/token</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        tokenRequest</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addHeader</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">token</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">laoshiren</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">HandlerExecutionChain</span><span style="color:#A6ACCD;"> handlerChainPost </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> hm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHandler</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">tokenRequest</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">ModelAndView</span><span style="color:#A6ACCD;"> modelAndViewToken </span><span style="color:#89DDFF;">=</span></span>
<span class="line"><span style="color:#A6ACCD;">                adapter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">invokeHandlerMethod</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#89DDFF;">                        </span><span style="color:#676E95;">// \u8BF7\u6C42</span></span>
<span class="line"><span style="color:#A6ACCD;">                        tokenRequest</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">                        </span><span style="color:#676E95;">// \u54CD\u5E94</span></span>
<span class="line"><span style="color:#A6ACCD;">                        </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MockHttpServletResponse</span><span style="color:#89DDFF;">(),</span></span>
<span class="line"><span style="color:#89DDFF;">                        </span><span style="color:#676E95;">// \u5BF9\u5E94\u7684handlerMethod</span></span>
<span class="line"><span style="color:#A6ACCD;">                        </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">HandlerMethod</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> handlerChainPost</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHandler</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="\u81EA\u5B9A\u4E49handlermethodreturnvaluehandler" tabindex="-1">\u81EA\u5B9A\u4E49HandlerMethodReturnValueHandler <a class="header-anchor" href="#\u81EA\u5B9A\u4E49handlermethodreturnvaluehandler" aria-hidden="true">#</a></h2><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Target</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ElementType</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">METHOD</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Retention</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">RetentionPolicy</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">RUNTIME</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">interface</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Yml</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u540C\u7406</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">YamlHandlerMethodReturnValueHandler</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">implements</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">HandlerMethodReturnValueHandler</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">final</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Yaml</span><span style="color:#A6ACCD;"> YAML </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Yaml</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">boolean</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">supportsReturnType</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">MethodParameter</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">returnType</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> returnType</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">hasParameterAnnotation</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Yml</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">handleReturnValue</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">returnValue</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">MethodParameter</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">returnType</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">ModelAndViewContainer</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">mavContainer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">NativeWebRequest</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">webRequest</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dump </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> YAML</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dump</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">returnValue</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;dump - </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> dump</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u83B7\u53D6\u54CD\u5E94</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">HttpServletResponse</span><span style="color:#A6ACCD;"> nativeResponse </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> webRequest</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getNativeResponse</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">HttpServletResponse</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u8BBE\u7F6E\u7F16\u7801</span></span>
<span class="line"><span style="color:#A6ACCD;">        nativeResponse</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setContentType</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">text/plain;charset=utf-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u8F93\u51FA</span></span>
<span class="line"><span style="color:#A6ACCD;">        nativeResponse</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getWriter</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dump</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u8BBE\u7F6E\u8BF7\u6C42\u5DF2\u7ECF\u5904\u7406\u5B8C\u6BD5</span></span>
<span class="line"><span style="color:#A6ACCD;">        mavContainer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setRequestHandled</span><span style="color:#89DDFF;">(true);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>\u6CE8\u518C\u5230Adapter</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Configuration</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">ComponentScan</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">basePackages</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">com.laoshiren.app.controller</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WebConfig2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Bean</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">RequestMappingHandlerAdapter</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">requestMappingHandlerAdapter</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">MyRequestMappingHandlerAdapter</span><span style="color:#A6ACCD;"> myRequestMappingHandlerAdapter </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MyRequestMappingHandlerAdapter</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u8BF7\u6C42\u53C2\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">TokenArgumentResolver</span><span style="color:#A6ACCD;"> argumentResolver </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">TokenArgumentResolver</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">HandlerMethodArgumentResolver</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> arrayList </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">ArrayList</span><span style="color:#89DDFF;">&lt;&gt;();</span></span>
<span class="line"><span style="color:#A6ACCD;">        arrayList</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">argumentResolver</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        myRequestMappingHandlerAdapter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setCustomArgumentResolvers</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">arrayList</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u54CD\u5E94\u53C2\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">YamlHandlerMethodReturnValueHandler</span><span style="color:#A6ACCD;"> returnValueHandler </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">YamlHandlerMethodReturnValueHandler</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">HandlerMethodReturnValueHandler</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> returnValueHandlers </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">ArrayList</span><span style="color:#89DDFF;">&lt;&gt;();</span></span>
<span class="line"><span style="color:#A6ACCD;">        returnValueHandlers</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">returnValueHandler</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        myRequestMappingHandlerAdapter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setCustomReturnValueHandlers</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">returnValueHandlers</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> myRequestMappingHandlerAdapter</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RequestMappingHandlerMappingMain</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">AnnotationConfigServletWebServerApplicationContext</span><span style="color:#A6ACCD;"> context </span><span style="color:#89DDFF;">=</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">AnnotationConfigServletWebServerApplicationContext</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">WebConfig2</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">RequestMappingHandlerMapping</span><span style="color:#A6ACCD;"> hm </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBean</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">RequestMappingHandlerMapping</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u6839\u636E\u8BF7\u6C42\u83B7\u53D6\u63A7\u5236\u5668\u65B9\u6CD5</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">MockHttpServletRequest</span><span style="color:#A6ACCD;"> request </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MockHttpServletRequest</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">GET</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/get</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u8FD4\u56DE\u63A7\u5236\u5668\u65B9\u6CD5 \u5904\u7406\u5668\u6267\u884C\u94FE\uFF0C\uFF08\u63A7\u5236\u5668\u65B9\u6CD5\uFF0C\u62E6\u622A\u5668\uFF09</span></span>
<span class="line"><span style="color:#676E95;">//        HandlerExecutionChain handlerChain = hm.getHandler(request);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">MyRequestMappingHandlerAdapter</span><span style="color:#A6ACCD;"> adapter </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBean</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">MyRequestMappingHandlerAdapter</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u53C2\u6570\u89E3\u6790\u5668 \uFF0CRequestBody Cookie \u7B49</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">HandlerMethodArgumentResolver</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> argumentResolvers </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> adapter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getArgumentResolvers</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-----</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u8FD4\u56DE\u503C\u89E3\u6790\u5668</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">HandlerMethodReturnValueHandler</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> returnValueHandlers </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> adapter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getReturnValueHandlers</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">MockHttpServletRequest</span><span style="color:#A6ACCD;"> yamlRequest </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MockHttpServletRequest</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">GET</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/yaml</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">HandlerExecutionChain</span><span style="color:#A6ACCD;"> handlerChainYaml </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> hm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHandler</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">yamlRequest</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">MockHttpServletResponse</span><span style="color:#A6ACCD;"> mockHttpServletResponse </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MockHttpServletResponse</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">ModelAndView</span><span style="color:#A6ACCD;"> modelAndViewYaml </span><span style="color:#89DDFF;">=</span></span>
<span class="line"><span style="color:#A6ACCD;">                adapter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">invokeHandlerMethod</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#89DDFF;">                        </span><span style="color:#676E95;">// \u8BF7\u6C42</span></span>
<span class="line"><span style="color:#A6ACCD;">                        yamlRequest</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">                        </span><span style="color:#676E95;">// \u54CD\u5E94</span></span>
<span class="line"><span style="color:#A6ACCD;">                        mockHttpServletResponse</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">                        </span><span style="color:#676E95;">// \u5BF9\u5E94\u7684handlerMethod</span></span>
<span class="line"><span style="color:#A6ACCD;">                        </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">HandlerMethod</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> handlerChainYaml</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHandler</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="mvc-\u5904\u7406\u6D41\u7A0B" tabindex="-1">MVC \u5904\u7406\u6D41\u7A0B <a class="header-anchor" href="#mvc-\u5904\u7406\u6D41\u7A0B" aria-hidden="true">#</a></h2><p>\u5230\u8FBE\u670D\u52A1\u5668\u5904\u7406\u6D41\u7A0B</p><ol><li>\u670D\u52A1\u5668\u63D0\u4F9B\u4E86DispatcherServlet \u4ED6\u4F7F\u7528\u7684\u662F\u6807\u51C6\u7684Servlet \u6280\u672F <ol><li>\u8DEF\u5F84\uFF1A\u9ED8\u8BA4\u6620\u5C04\u8DEF\u5F84\u4E3A <code>/</code> \u5373\u4F1A\u5339\u914D\u5230\u6240\u6709\u8BF7\u6C42URL\uFF0C\u53EF\u4F5C\u4E3A\u8BF7\u6C42\u7684\u7EDF\u4E00\u5165\u53E3\uFF0C\u4E5F\u88AB\u79F0\u4E4B\u4E3A\u524D\u63A7\u5236\u5668 <ol><li>JSP \u4E0D\u4F1A\u5339\u914D\u5230 DispatcherServlet</li><li>\u5176\u4ED6\u6709\u8DEF\u5F84\u7684Servlet \u5339\u914D\u4F18\u5148\u7EA7\u4E5F\u4F1A\u9AD8\u4E8EDispatcherServlet</li></ol></li><li>\u521B\u5EFA\uFF1A\u5728Boot \u4E2D\uFF0C\u7531 DispatcherServletAutoConfiguration \u8FD9\u4E2A\u81EA\u52A8\u914D\u7F6E\u7C7B\u63D0\u4F9B\u4E86 DispatcherServlet \u7684 Bean</li><li>\u521D\u59CB\u5316: DispatcherServlet \u521D\u59CB\u5316\u4F1A\u4F18\u5148\u627E\u5BB9\u5668\u91CC\u5BFB\u627E\u5404\u79CD\u7EC4\u4EF6\uFF0C\u4F5C\u4E3A\u6210\u5458\u53D8\u91CF <ol><li>HandlerMapping\uFF08RequestMappingHandlerMapping\uFF09 \u521D\u59CB\u5316\u8BB0\u5F55\u5404\u4E2AController \u5BF9\u5E94\u8BF7\u6C42\u8DEF\u5F84\u548C\u5BF9\u5E94\u7C7B\u65B9\u6CD5</li><li>HandlerAdapter\uFF08RequestMappingHandlerAdapter\uFF09 \u521D\u59CB\u5316\u65F6\u51C6\u5907\u53C2\u6570\u89E3\u6790\u5668\u3001\u8FD4\u56DE\u503C\u89E3\u6790\u5668\u3001\u6D88\u606F\u8F6C\u6362\u5668</li><li>HandlerExceptionResolver \u5F02\u5E38\u5904\u7406\u5668</li><li>ViewResolver \u89C6\u56FE\u89E3\u6790\u5668</li></ol></li></ol></li><li>DispatcherServlet \u4F1A\u5229\u7528 RequestMappingHandlerMapping \u67E5\u627E\u5BF9\u5E94\u7684HandlerMapping <ol><li>\u6839\u636E\u8DEF\u5F84\u627E\u5230@ReuqstMapping \u5BF9\u5E94\u7684\u63A7\u5236\u5668\u65B9\u6CD5</li><li>\u63A7\u5236\u5668\u65B9\u6CD5\u88AB\u5C01\u88C5\u4E3A HandlerMethod \u5BF9\u8C61\uFF0C\u5E76\u7ED3\u5408\u5339\u914D\u5230\u7684\u62E6\u622A\u5668\uFF08Interceptor\uFF09 \u4E00\u8D77\u8FD4\u56DE\u7ED9 DispatcherServlet</li><li>HandlerMethod \u548C\u62E6\u622A\u5668\u5408\u5728\u4E00\u8D77\u6210\u4E3AHandlerExecutionChain\uFF08\u8C03\u7528\u94FE\uFF09\u5BF9\u8C61</li></ol></li><li>DispatcherServlet \u5F00\u59CB\u5904\u7406\u8BF7\u6C42 <ol><li>\u8C03\u7528Interceptor \u7684 preHandle</li><li>RequestMappingHandlerAdapter \u8C03\u7528invokeHandlerMethod \u65B9\u6CD5</li><li>\u8C03\u7528Interceptor \u7684 postHandle</li><li>\u5904\u7406\u5F02\u5E38\u6216\u89C6\u56FE\u6E32\u67D3 <ul><li>\u5982\u679C 1~3 \u51FA\u73B0\u5F02\u5E38\uFF0C\u8D70 ExceptionHandlerExceptionResolver \u5904\u7406\u5F02\u5E38\u6D41\u7A0B <ul><li>@ControllerAdvice \u5168\u5C40\u589E\u5F3A\u70B95\uFE0F\u20E3\uFF1A@ExceptionHandler \u5F02\u5E38\u5904\u7406</li></ul></li><li>\u6B63\u5E38\uFF0C\u8D70\u89C6\u56FE\u89E3\u6790\u53CA\u6E32\u67D3\u6D41\u7A0B</li></ul></li><li>\u8C03\u7528\u62E6\u622A\u5668\u7684 afterCompletion \u65B9\u6CD5</li></ol></li></ol>`,54),o=[e];function r(t,c,D,y,F,A){return n(),a("div",null,o)}const b=s(p,[["render",r]]);export{i as __pageData,b as default};
