import{_ as s,o as n,c as a,a as l}from"./app.303cfecc.js";const C=JSON.parse('{"title":"\u5927\u6570\u636E","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u5927\u6570\u636E4\u5927\u7279\u70B9","slug":"\u5927\u6570\u636E4\u5927\u7279\u70B9","link":"#\u5927\u6570\u636E4\u5927\u7279\u70B9","children":[]},{"level":2,"title":"1 \u6982\u5FF5","slug":"_1-\u6982\u5FF5","link":"#_1-\u6982\u5FF5","children":[{"level":3,"title":"1.1 Hadoop \u662F\u4EC0\u4E48\uFF1F","slug":"_1-1-hadoop-\u662F\u4EC0\u4E48","link":"#_1-1-hadoop-\u662F\u4EC0\u4E48","children":[]},{"level":3,"title":"1.2 Hadoop \u7684\u4F18\u52BF(4\u9AD8)","slug":"_1-2-hadoop-\u7684\u4F18\u52BF-4\u9AD8","link":"#_1-2-hadoop-\u7684\u4F18\u52BF-4\u9AD8","children":[]},{"level":3,"title":"1.3 Hadoop \u7684\u7EC4\u6210","slug":"_1-3-hadoop-\u7684\u7EC4\u6210","link":"#_1-3-hadoop-\u7684\u7EC4\u6210","children":[]},{"level":3,"title":"1.4 \u5927\u6570\u636E\u6280\u672F\u751F\u6001\u4F53\u7CFB","slug":"_1-4-\u5927\u6570\u636E\u6280\u672F\u751F\u6001\u4F53\u7CFB","link":"#_1-4-\u5927\u6570\u636E\u6280\u672F\u751F\u6001\u4F53\u7CFB","children":[]}]},{"level":2,"title":"2 \u751F\u4EA7\u96C6\u7FA4\u642D\u5EFA","slug":"_2-\u751F\u4EA7\u96C6\u7FA4\u642D\u5EFA","link":"#_2-\u751F\u4EA7\u96C6\u7FA4\u642D\u5EFA","children":[{"level":3,"title":"2.1 \u51C6\u5907\u5DE5\u4F5C","slug":"_2-1-\u51C6\u5907\u5DE5\u4F5C","link":"#_2-1-\u51C6\u5907\u5DE5\u4F5C","children":[]},{"level":3,"title":"2.2 \u672C\u5730\u6A21\u5F0F","slug":"_2-2-\u672C\u5730\u6A21\u5F0F","link":"#_2-2-\u672C\u5730\u6A21\u5F0F","children":[]},{"level":3,"title":"2.3 \u5B8C\u5168\u5206\u5E03\u5F0F\u96C6\u7FA4","slug":"_2-3-\u5B8C\u5168\u5206\u5E03\u5F0F\u96C6\u7FA4","link":"#_2-3-\u5B8C\u5168\u5206\u5E03\u5F0F\u96C6\u7FA4","children":[]}]},{"level":2,"title":"hdfs \u4EA7\u751F\u80CC\u666F","slug":"hdfs-\u4EA7\u751F\u80CC\u666F","link":"#hdfs-\u4EA7\u751F\u80CC\u666F","children":[{"level":3,"title":"hdfs \u4F18\u7F3A\u70B9","slug":"hdfs-\u4F18\u7F3A\u70B9","link":"#hdfs-\u4F18\u7F3A\u70B9","children":[]},{"level":3,"title":"\u7EC4\u6210","slug":"\u7EC4\u6210","link":"#\u7EC4\u6210","children":[]},{"level":3,"title":"\u6587\u4EF6\u5757\u5927\u5C0F\u95EE\u9898","slug":"\u6587\u4EF6\u5757\u5927\u5C0F\u95EE\u9898","link":"#\u6587\u4EF6\u5757\u5927\u5C0F\u95EE\u9898","children":[]}]},{"level":2,"title":"HDFS\u7684shell\u76F8\u5173\u64CD\u4F5C","slug":"hdfs\u7684shell\u76F8\u5173\u64CD\u4F5C","link":"#hdfs\u7684shell\u76F8\u5173\u64CD\u4F5C","children":[{"level":3,"title":"\u57FA\u672C\u8BED\u6CD5","slug":"\u57FA\u672C\u8BED\u6CD5","link":"#\u57FA\u672C\u8BED\u6CD5","children":[]},{"level":3,"title":"\u547D\u4EE4\u5927\u5168","slug":"\u547D\u4EE4\u5927\u5168","link":"#\u547D\u4EE4\u5927\u5168","children":[]}]},{"level":2,"title":"HDFS\u7684\u5BA2\u6237\u7AEFAPI","slug":"hdfs\u7684\u5BA2\u6237\u7AEFapi","link":"#hdfs\u7684\u5BA2\u6237\u7AEFapi","children":[{"level":3,"title":"\u4F9D\u8D56","slug":"\u4F9D\u8D56","link":"#\u4F9D\u8D56","children":[]},{"level":3,"title":"\u57FA\u7840\u914D\u7F6E","slug":"\u57FA\u7840\u914D\u7F6E","link":"#\u57FA\u7840\u914D\u7F6E","children":[]},{"level":3,"title":"\u521B\u5EFA\u6587\u4EF6\u5939","slug":"\u521B\u5EFA\u6587\u4EF6\u5939","link":"#\u521B\u5EFA\u6587\u4EF6\u5939","children":[]},{"level":3,"title":"\u4E0A\u4F20\u6587\u4EF6","slug":"\u4E0A\u4F20\u6587\u4EF6","link":"#\u4E0A\u4F20\u6587\u4EF6","children":[]},{"level":3,"title":"\u4E0B\u8F7D\u6587\u4EF6","slug":"\u4E0B\u8F7D\u6587\u4EF6","link":"#\u4E0B\u8F7D\u6587\u4EF6","children":[]},{"level":3,"title":"\u5220\u9664\u6587\u4EF6","slug":"\u5220\u9664\u6587\u4EF6","link":"#\u5220\u9664\u6587\u4EF6","children":[]},{"level":3,"title":"\u6587\u4EF6\u91CD\u547D\u540D\u548C\u79FB\u52A8","slug":"\u6587\u4EF6\u91CD\u547D\u540D\u548C\u79FB\u52A8","link":"#\u6587\u4EF6\u91CD\u547D\u540D\u548C\u79FB\u52A8","children":[]},{"level":3,"title":"\u6587\u4EF6\u8BE6\u60C5\u67E5\u770B","slug":"\u6587\u4EF6\u8BE6\u60C5\u67E5\u770B","link":"#\u6587\u4EF6\u8BE6\u60C5\u67E5\u770B","children":[]}]},{"level":2,"title":"HDFS\u8BFB\u5199\u6D41\u7A0B","slug":"hdfs\u8BFB\u5199\u6D41\u7A0B","link":"#hdfs\u8BFB\u5199\u6D41\u7A0B","children":[{"level":3,"title":"HDFS\u7684\u5199\u6570\u636E\u6D41\u7A0B","slug":"hdfs\u7684\u5199\u6570\u636E\u6D41\u7A0B","link":"#hdfs\u7684\u5199\u6570\u636E\u6D41\u7A0B","children":[]},{"level":3,"title":"HDFS\u7684\u8BFB\u6570\u636E\u6D41\u7A0B","slug":"hdfs\u7684\u8BFB\u6570\u636E\u6D41\u7A0B","link":"#hdfs\u7684\u8BFB\u6570\u636E\u6D41\u7A0B","children":[]}]},{"level":2,"title":"NN\u548C2NN\u5DE5\u4F5C\u539F\u7406","slug":"nn\u548C2nn\u5DE5\u4F5C\u539F\u7406","link":"#nn\u548C2nn\u5DE5\u4F5C\u539F\u7406","children":[{"level":3,"title":"\u5DE5\u4F5C\u673A\u5236","slug":"\u5DE5\u4F5C\u673A\u5236","link":"#\u5DE5\u4F5C\u673A\u5236","children":[]},{"level":3,"title":"Fsimage\u548CEdits\u89E3\u6790","slug":"fsimage\u548Cedits\u89E3\u6790","link":"#fsimage\u548Cedits\u89E3\u6790","children":[]}]},{"level":2,"title":"DataNode\u5DE5\u4F5C\u673A\u5236","slug":"datanode\u5DE5\u4F5C\u673A\u5236","link":"#datanode\u5DE5\u4F5C\u673A\u5236","children":[]},{"level":2,"title":"MapReduce \u6982\u8FF0","slug":"mapreduce-\u6982\u8FF0","link":"#mapreduce-\u6982\u8FF0","children":[{"level":3,"title":"MapReduce \u5B9A\u4E49","slug":"mapreduce-\u5B9A\u4E49","link":"#mapreduce-\u5B9A\u4E49","children":[]},{"level":3,"title":"MapReduce \u4F18\u7F3A\u70B9","slug":"mapreduce-\u4F18\u7F3A\u70B9","link":"#mapreduce-\u4F18\u7F3A\u70B9","children":[]},{"level":3,"title":"MapReduce \u6838\u5FC3\u601D\u60F3","slug":"mapreduce-\u6838\u5FC3\u601D\u60F3","link":"#mapreduce-\u6838\u5FC3\u601D\u60F3","children":[]},{"level":3,"title":"MapReduce \u8FDB\u7A0B","slug":"mapreduce-\u8FDB\u7A0B","link":"#mapreduce-\u8FDB\u7A0B","children":[]},{"level":3,"title":"\u5B98\u65B9 WordCount \u6E90\u7801","slug":"\u5B98\u65B9-wordcount-\u6E90\u7801","link":"#\u5B98\u65B9-wordcount-\u6E90\u7801","children":[]},{"level":3,"title":"MapReduce \u7F16\u7A0B\u89C4\u8303","slug":"mapreduce-\u7F16\u7A0B\u89C4\u8303","link":"#mapreduce-\u7F16\u7A0B\u89C4\u8303","children":[]}]},{"level":2,"title":"\u5E8F\u5217\u5316","slug":"\u5E8F\u5217\u5316","link":"#\u5E8F\u5217\u5316","children":[{"level":3,"title":"\u81EA\u5B9A\u4E49\u5E8F\u5217\u5316","slug":"\u81EA\u5B9A\u4E49\u5E8F\u5217\u5316","link":"#\u81EA\u5B9A\u4E49\u5E8F\u5217\u5316","children":[]}]},{"level":2,"title":"MapReduce\u6846\u67B6\u539F\u7406","slug":"mapreduce\u6846\u67B6\u539F\u7406","link":"#mapreduce\u6846\u67B6\u539F\u7406","children":[{"level":3,"title":"InputFormat \u6570\u636E\u8F93\u5165","slug":"inputformat-\u6570\u636E\u8F93\u5165","link":"#inputformat-\u6570\u636E\u8F93\u5165","children":[]},{"level":3,"title":"MapReduce \u5DE5\u4F5C\u6D41\u7A0B","slug":"mapreduce-\u5DE5\u4F5C\u6D41\u7A0B","link":"#mapreduce-\u5DE5\u4F5C\u6D41\u7A0B","children":[]},{"level":3,"title":"MapReduce\u5F00\u53D1\u603B\u7ED3","slug":"mapreduce\u5F00\u53D1\u603B\u7ED3","link":"#mapreduce\u5F00\u53D1\u603B\u7ED3","children":[]}]},{"level":2,"title":"\u538B\u7F29","slug":"\u538B\u7F29","link":"#\u538B\u7F29","children":[{"level":3,"title":"Mapper \u538B\u7F29","slug":"mapper-\u538B\u7F29","link":"#mapper-\u538B\u7F29","children":[]},{"level":3,"title":"Reduce\u538B\u7F29","slug":"reduce\u538B\u7F29","link":"#reduce\u538B\u7F29","children":[]}]},{"level":2,"title":"Yarn \u57FA\u7840\u67B6\u6784","slug":"yarn-\u57FA\u7840\u67B6\u6784","link":"#yarn-\u57FA\u7840\u67B6\u6784","children":[]},{"level":2,"title":"YARN\u5DE5\u4F5C\u673A\u5236","slug":"yarn\u5DE5\u4F5C\u673A\u5236","link":"#yarn\u5DE5\u4F5C\u673A\u5236","children":[]},{"level":2,"title":"Yarn \u8C03\u5EA6\u5668\u548C\u8C03\u5EA6\u7B97\u6CD5","slug":"yarn-\u8C03\u5EA6\u5668\u548C\u8C03\u5EA6\u7B97\u6CD5","link":"#yarn-\u8C03\u5EA6\u5668\u548C\u8C03\u5EA6\u7B97\u6CD5","children":[{"level":3,"title":"\u5148\u8FDB\u5148\u51FA\u8C03\u5EA6\u5668\uFF08FIFO\uFF09","slug":"\u5148\u8FDB\u5148\u51FA\u8C03\u5EA6\u5668-fifo","link":"#\u5148\u8FDB\u5148\u51FA\u8C03\u5EA6\u5668-fifo","children":[]},{"level":3,"title":"\u5BB9\u91CF\u8C03\u5EA6\u5668\uFF08Capacity Scheduler\uFF09","slug":"\u5BB9\u91CF\u8C03\u5EA6\u5668-capacity-scheduler","link":"#\u5BB9\u91CF\u8C03\u5EA6\u5668-capacity-scheduler","children":[]},{"level":3,"title":"\u516C\u5E73\u8C03\u5EA6\u5668\uFF08Fair Scheduler\uFF09","slug":"\u516C\u5E73\u8C03\u5EA6\u5668-fair-scheduler","link":"#\u516C\u5E73\u8C03\u5EA6\u5668-fair-scheduler","children":[]}]},{"level":2,"title":"Yarn \u5E38\u7528\u547D\u4EE4","slug":"yarn-\u5E38\u7528\u547D\u4EE4","link":"#yarn-\u5E38\u7528\u547D\u4EE4","children":[]},{"level":2,"title":"Yarn \u751F\u4EA7\u73AF\u5883\u6838\u5FC3\u53C2\u6570","slug":"yarn-\u751F\u4EA7\u73AF\u5883\u6838\u5FC3\u53C2\u6570","link":"#yarn-\u751F\u4EA7\u73AF\u5883\u6838\u5FC3\u53C2\u6570","children":[{"level":3,"title":"ResourceManager \u76F8\u5173","slug":"resourcemanager-\u76F8\u5173","link":"#resourcemanager-\u76F8\u5173","children":[]},{"level":3,"title":"NodeManager \u76F8\u5173","slug":"nodemanager-\u76F8\u5173","link":"#nodemanager-\u76F8\u5173","children":[]},{"level":3,"title":"Containe \u76F8\u5173","slug":"containe-\u76F8\u5173","link":"#containe-\u76F8\u5173","children":[]}]},{"level":2,"title":"Tools","slug":"tools","link":"#tools","children":[]}],"relativePath":"study/bigdata/hdfs.md","lastUpdated":1680763907000}'),p={name:"study/bigdata/hdfs.md"},e=l(`<h1 id="\u5927\u6570\u636E" tabindex="-1">\u5927\u6570\u636E <a class="header-anchor" href="#\u5927\u6570\u636E" aria-hidden="true">#</a></h1><nav class="table-of-contents"><ul><li><a href="#\u5927\u6570\u636E4\u5927\u7279\u70B9">\u5927\u6570\u636E4\u5927\u7279\u70B9</a></li><li><a href="#_1-\u6982\u5FF5">1 \u6982\u5FF5</a><ul><li><a href="#_1-1-hadoop-\u662F\u4EC0\u4E48">1.1 Hadoop \u662F\u4EC0\u4E48\uFF1F</a></li><li><a href="#_1-2-hadoop-\u7684\u4F18\u52BF-4\u9AD8">1.2 Hadoop \u7684\u4F18\u52BF(4\u9AD8)</a></li><li><a href="#_1-3-hadoop-\u7684\u7EC4\u6210">1.3 Hadoop \u7684\u7EC4\u6210</a></li><li><a href="#_1-4-\u5927\u6570\u636E\u6280\u672F\u751F\u6001\u4F53\u7CFB">1.4 \u5927\u6570\u636E\u6280\u672F\u751F\u6001\u4F53\u7CFB</a></li></ul></li><li><a href="#_2-\u751F\u4EA7\u96C6\u7FA4\u642D\u5EFA">2 \u751F\u4EA7\u96C6\u7FA4\u642D\u5EFA</a><ul><li><a href="#_2-1-\u51C6\u5907\u5DE5\u4F5C">2.1 \u51C6\u5907\u5DE5\u4F5C</a></li><li><a href="#_2-2-\u672C\u5730\u6A21\u5F0F">2.2 \u672C\u5730\u6A21\u5F0F</a></li><li><a href="#_2-3-\u5B8C\u5168\u5206\u5E03\u5F0F\u96C6\u7FA4">2.3 \u5B8C\u5168\u5206\u5E03\u5F0F\u96C6\u7FA4</a></li></ul></li><li><a href="#hdfs-\u4EA7\u751F\u80CC\u666F">hdfs \u4EA7\u751F\u80CC\u666F</a><ul><li><a href="#hdfs-\u4F18\u7F3A\u70B9">hdfs \u4F18\u7F3A\u70B9</a></li><li><a href="#\u7EC4\u6210">\u7EC4\u6210</a></li><li><a href="#\u6587\u4EF6\u5757\u5927\u5C0F\u95EE\u9898">\u6587\u4EF6\u5757\u5927\u5C0F\u95EE\u9898</a></li></ul></li><li><a href="#hdfs\u7684shell\u76F8\u5173\u64CD\u4F5C">HDFS\u7684shell\u76F8\u5173\u64CD\u4F5C</a><ul><li><a href="#\u57FA\u672C\u8BED\u6CD5">\u57FA\u672C\u8BED\u6CD5</a></li><li><a href="#\u547D\u4EE4\u5927\u5168">\u547D\u4EE4\u5927\u5168</a></li></ul></li><li><a href="#hdfs\u7684\u5BA2\u6237\u7AEFapi">HDFS\u7684\u5BA2\u6237\u7AEFAPI</a><ul><li><a href="#\u4F9D\u8D56">\u4F9D\u8D56</a></li><li><a href="#\u57FA\u7840\u914D\u7F6E">\u57FA\u7840\u914D\u7F6E</a></li><li><a href="#\u521B\u5EFA\u6587\u4EF6\u5939">\u521B\u5EFA\u6587\u4EF6\u5939</a></li><li><a href="#\u4E0A\u4F20\u6587\u4EF6">\u4E0A\u4F20\u6587\u4EF6</a></li><li><a href="#\u4E0B\u8F7D\u6587\u4EF6">\u4E0B\u8F7D\u6587\u4EF6</a></li><li><a href="#\u5220\u9664\u6587\u4EF6">\u5220\u9664\u6587\u4EF6</a></li><li><a href="#\u6587\u4EF6\u91CD\u547D\u540D\u548C\u79FB\u52A8">\u6587\u4EF6\u91CD\u547D\u540D\u548C\u79FB\u52A8</a></li><li><a href="#\u6587\u4EF6\u8BE6\u60C5\u67E5\u770B">\u6587\u4EF6\u8BE6\u60C5\u67E5\u770B</a></li></ul></li><li><a href="#hdfs\u8BFB\u5199\u6D41\u7A0B">HDFS\u8BFB\u5199\u6D41\u7A0B</a><ul><li><a href="#hdfs\u7684\u5199\u6570\u636E\u6D41\u7A0B">HDFS\u7684\u5199\u6570\u636E\u6D41\u7A0B</a></li><li><a href="#hdfs\u7684\u8BFB\u6570\u636E\u6D41\u7A0B">HDFS\u7684\u8BFB\u6570\u636E\u6D41\u7A0B</a></li></ul></li><li><a href="#nn\u548C2nn\u5DE5\u4F5C\u539F\u7406">NN\u548C2NN\u5DE5\u4F5C\u539F\u7406</a><ul><li><a href="#\u5DE5\u4F5C\u673A\u5236">\u5DE5\u4F5C\u673A\u5236</a></li><li><a href="#fsimage\u548Cedits\u89E3\u6790">Fsimage\u548CEdits\u89E3\u6790</a></li></ul></li><li><a href="#datanode\u5DE5\u4F5C\u673A\u5236">DataNode\u5DE5\u4F5C\u673A\u5236</a></li><li><a href="#mapreduce-\u6982\u8FF0">MapReduce \u6982\u8FF0</a><ul><li><a href="#mapreduce-\u5B9A\u4E49">MapReduce \u5B9A\u4E49</a></li><li><a href="#mapreduce-\u4F18\u7F3A\u70B9">MapReduce \u4F18\u7F3A\u70B9</a></li><li><a href="#mapreduce-\u6838\u5FC3\u601D\u60F3">MapReduce \u6838\u5FC3\u601D\u60F3</a></li><li><a href="#mapreduce-\u8FDB\u7A0B">MapReduce \u8FDB\u7A0B</a></li><li><a href="#\u5B98\u65B9-wordcount-\u6E90\u7801">\u5B98\u65B9 WordCount \u6E90\u7801</a></li><li><a href="#mapreduce-\u7F16\u7A0B\u89C4\u8303">MapReduce \u7F16\u7A0B\u89C4\u8303</a></li></ul></li><li><a href="#\u5E8F\u5217\u5316">\u5E8F\u5217\u5316</a><ul><li><a href="#\u81EA\u5B9A\u4E49\u5E8F\u5217\u5316">\u81EA\u5B9A\u4E49\u5E8F\u5217\u5316</a></li></ul></li><li><a href="#mapreduce\u6846\u67B6\u539F\u7406">MapReduce\u6846\u67B6\u539F\u7406</a><ul><li><a href="#inputformat-\u6570\u636E\u8F93\u5165">InputFormat \u6570\u636E\u8F93\u5165</a></li><li><a href="#mapreduce-\u5DE5\u4F5C\u6D41\u7A0B">MapReduce \u5DE5\u4F5C\u6D41\u7A0B</a></li><li><a href="#mapreduce\u5F00\u53D1\u603B\u7ED3">MapReduce\u5F00\u53D1\u603B\u7ED3</a></li></ul></li><li><a href="#\u538B\u7F29">\u538B\u7F29</a><ul><li><a href="#mapper-\u538B\u7F29">Mapper \u538B\u7F29</a></li><li><a href="#reduce\u538B\u7F29">Reduce\u538B\u7F29</a></li></ul></li><li><a href="#yarn-\u57FA\u7840\u67B6\u6784">Yarn \u57FA\u7840\u67B6\u6784</a></li><li><a href="#yarn\u5DE5\u4F5C\u673A\u5236">YARN\u5DE5\u4F5C\u673A\u5236</a></li><li><a href="#yarn-\u8C03\u5EA6\u5668\u548C\u8C03\u5EA6\u7B97\u6CD5">Yarn \u8C03\u5EA6\u5668\u548C\u8C03\u5EA6\u7B97\u6CD5</a><ul><li><a href="#\u5148\u8FDB\u5148\u51FA\u8C03\u5EA6\u5668-fifo">\u5148\u8FDB\u5148\u51FA\u8C03\u5EA6\u5668\uFF08FIFO\uFF09</a></li><li><a href="#\u5BB9\u91CF\u8C03\u5EA6\u5668-capacity-scheduler">\u5BB9\u91CF\u8C03\u5EA6\u5668\uFF08Capacity Scheduler\uFF09</a></li><li><a href="#\u516C\u5E73\u8C03\u5EA6\u5668-fair-scheduler">\u516C\u5E73\u8C03\u5EA6\u5668\uFF08Fair Scheduler\uFF09</a></li></ul></li><li><a href="#yarn-\u5E38\u7528\u547D\u4EE4">Yarn \u5E38\u7528\u547D\u4EE4</a></li><li><a href="#yarn-\u751F\u4EA7\u73AF\u5883\u6838\u5FC3\u53C2\u6570">Yarn \u751F\u4EA7\u73AF\u5883\u6838\u5FC3\u53C2\u6570</a><ul><li><a href="#resourcemanager-\u76F8\u5173">ResourceManager \u76F8\u5173</a></li><li><a href="#nodemanager-\u76F8\u5173">NodeManager \u76F8\u5173</a></li><li><a href="#containe-\u76F8\u5173">Containe \u76F8\u5173</a></li></ul></li><li><a href="#tools">Tools</a></li></ul></nav><h2 id="\u5927\u6570\u636E4\u5927\u7279\u70B9" tabindex="-1">\u5927\u6570\u636E4\u5927\u7279\u70B9 <a class="header-anchor" href="#\u5927\u6570\u636E4\u5927\u7279\u70B9" aria-hidden="true">#</a></h2><ol><li><code>Volume </code>(\u6D77\u91CF\u6570\u636E\u5B58\u50A8)</li><li><code>Velocity</code>(\u9AD8\u901F)</li><li><code>Variety</code>(\u591A\u6837\u6027)</li><li><code>Value</code>(\u4F4E\u4EF7\u503C\u5BC6\u5EA6 - \u6570\u636E\u6E05\u6D17)</li></ol><p>\u5E73\u53F0</p><p><code>Hadoop</code>,<code>Flume</code>,<code>Kafka</code>,<code>HBase</code>,<code>Spark</code>\u7684\u7B49\u6846\u67B6\u7684\u5E73\u53F0\u642D\u5EFA\uFF0C\u96C6\u7FA4\u6027\u80FD\u76D1\u63A7\uFF0C\u96C6\u7FA4\u65B0\u80FD\u8C03\u4F18\u3002</p><p>\u6570\u636E\u4ED3\u5E93</p><p><code>ETL</code>\u6570\u636E\u6E05\u6D17\uFF0C\u6570\u636E\u5206\u6790\uFF0C\u6570\u4ED3\u5EFA\u6A21</p><p>\u5B9E\u65F6\u6307\u6807\u7684\u5206\u6790\u6027\u80FD\u8C03\u4F18\uFF0C\u6570\u636E\u6316\u6398\u3002</p><h1 id="hadoop" tabindex="-1">Hadoop <a class="header-anchor" href="#hadoop" aria-hidden="true">#</a></h1><p><a href="http://hadoop.apache.org/" target="_blank" rel="noreferrer">Hadoop \u5B98\u7F51</a></p><h2 id="_1-\u6982\u5FF5" tabindex="-1">1 \u6982\u5FF5 <a class="header-anchor" href="#_1-\u6982\u5FF5" aria-hidden="true">#</a></h2><h3 id="_1-1-hadoop-\u662F\u4EC0\u4E48" tabindex="-1">1.1 Hadoop \u662F\u4EC0\u4E48\uFF1F <a class="header-anchor" href="#_1-1-hadoop-\u662F\u4EC0\u4E48" aria-hidden="true">#</a></h3><p><code>Hadoop</code>\u662F\u4E00\u4E2A\u7531<code>Apache</code>\u57FA\u91D1\u4F1A\u6240\u5F00\u53D1\u7684<strong>\u5206\u5E03\u5F0F\u7CFB\u7EDF\u57FA\u7840\u67B6\u6784</strong>\u3002\u4E3B\u8981\u89E3\u51B3\u6D77\u91CF\u6570\u636E\u7684<strong>\u5B58\u50A8</strong>\u548C<strong>\u5206\u6790\u8BA1\u7B97</strong>\u95EE\u9898\u3002</p><p><code>Hadoop</code>\u901A\u5E38\u662F\u6307\u4E00\u4E2A\u66F4\u5E7F\u6CDB\u7684\u6982\u5FF5--<strong><code>Hadoop</code>\u751F\u6001\u5708</strong></p><p><img src="https://img-blog.csdnimg.cn/333ef0d516e94f89a22e7c313881f7f9.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h3 id="_1-2-hadoop-\u7684\u4F18\u52BF-4\u9AD8" tabindex="-1">1.2 Hadoop \u7684\u4F18\u52BF(4\u9AD8) <a class="header-anchor" href="#_1-2-hadoop-\u7684\u4F18\u52BF-4\u9AD8" aria-hidden="true">#</a></h3><ol><li>\u9AD8\u53EF\u9760\u6027:<code>Hadoop</code>\u5E95\u5C42\u7EF4\u62A4\u4E86\u591A\u4E2A\u6570\u636E\u526F\u672C\uFF0C\u6240\u4EE5\u5373\u4F7F<code>Hadoop</code>\u67D0\u4E2A\u8BA1\u7B97\u5143\u7D20\u6216\u5B58\u50A8\u51FA\u73B0\u6545\u969C\uFF0C\u4E5F\u4E0D\u4F1A\u5BFC\u81F4\u6570\u636E\u4E22\u5931\u3002</li><li>\u9AD8\u6269\u5C55\u6027:\u5728\u96C6\u7FA4\u5206\u914D\u4EFB\u52A1\u6570\u636E\uFF0C\u53EF\u65B9\u4FBF\u7684\u6269\u5C55\u6570\u4EE5\u5343\u8BA1\u7684\u8282\u70B9\u3002</li><li>\u9AD8\u6548\u6027:\u5728<code>MapReduce</code>\u662F\u5E76\u884C\u5DE5\u4F5C\u7684\u52A0\u5FEB\u4EFB\u52A1\u5904\u7406\u901F\u5EA6\u3002</li><li>\u9AD8\u5BB9\u9519\u6027:\u80FD\u591F\u81EA\u52A8\u7684\u5C06\u5931\u8D25\u7684\u4EFB\u52A1\u91CD\u65B0\u5206\u914D\u3002</li></ol><h3 id="_1-3-hadoop-\u7684\u7EC4\u6210" tabindex="-1">1.3 Hadoop \u7684\u7EC4\u6210 <a class="header-anchor" href="#_1-3-hadoop-\u7684\u7EC4\u6210" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/504c33d9bcb640bca82852e9e38b7f02.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h4 id="_1-3-1-hdfs-\u67B6\u6784\u6982\u8FF0" tabindex="-1">1.3.1 HDFS \u67B6\u6784\u6982\u8FF0 <a class="header-anchor" href="#_1-3-1-hdfs-\u67B6\u6784\u6982\u8FF0" aria-hidden="true">#</a></h4><p><code>Hadoop Distributed File System</code>\u7B80\u79F0<code>HDFS</code>\uFF0C\u662F\u4E00\u4E2A\u5206\u5E03\u5F0F\u6587\u4EF6\u7CFB\u7EDF\u3002</p><ol><li><code>NameNode</code>(<code>nn</code>): \u5B58\u50A8\u6587\u4EF6\u7684\u5143\u6570\u636E\u5982\u6587\u4EF6\u540D\uFF0C\u6587\u4EF6\u76EE\u5F55\u63A5\u53E3\uFF0C\u6587\u4EF6\u5C5E\u6027\uFF0C\u4EE5\u53CA\u6BCF\u4E2A\u6587\u4EF6\u7684<strong>\u5757\u5217\u8868</strong>\u548C**\u5757\u6240\u5728\u7684<code>DataNode</code>**\u7B49\u3002</li><li><code>DataNode</code>(<code>dn</code>): \u5728\u672C\u5730\u6587\u4EF6\u7CFB\u7EDF<strong>\u5B58\u50A8\u6587\u4EF6\u5757\u6570\u636E</strong>\uFF0C\u4EE5\u53CA<strong>\u5757\u6570\u636E\u7684\u6821\u9A8C\u548C</strong>\u3002</li><li><code>Secondary NameNode</code>(<code>2nn</code>): \u6BCF\u9694\u4E00\u6BB5\u65F6\u95F4\u5BF9<code>NameNode</code>\u6570\u636E\u636E\u5907\u4EFD\u3002</li></ol><h4 id="_1-3-2-yarn\u67B6\u6784\u6982\u8FF0" tabindex="-1">1.3.2 Yarn\u67B6\u6784\u6982\u8FF0 <a class="header-anchor" href="#_1-3-2-yarn\u67B6\u6784\u6982\u8FF0" aria-hidden="true">#</a></h4><p><code>Yet Another Resource Negotiator</code> \u7B80\u79F0<code>Yarn </code>\u662F<code>Hadoop</code>\u7684\u8D44\u6E90\u7BA1\u7406\u5668(\u4E3B\u8981\u7BA1\u7406<code>CPU</code>\u548C\u5185\u5B58)\u3002</p><ol><li><code>ResouceManager</code>(<code>RM</code>): \u6574\u4E2A\u96C6\u7FA4\u8D44\u6E90\u7684\u7BA1\u7406\u8005\u3002</li><li><code>NodeManager</code>(<code>NM</code>): \u5355\u8282\u70B9\u670D\u52A1\u5668\u7BA1\u7406\u8005\u3002</li><li><code>ApplicationMaster</code>(<code>AM</code>): \u5355\u4E2A\u4EFB\u52A1\u8FD0\u884C\u7684\u8001\u5927\u3002</li><li><code>Container</code>: \u5BB9\u5668\uFF0C\u76F8\u5F53\u4E8E\u4E00\u53F0\u72EC\u7ACB\u7684\u670D\u52A1\u5668\uFF0C\u91CC\u9762\u5C01\u88C5\u4E86\u4EFB\u52A1\u8FD0\u884C\u6240\u9700\u8981\u7684\u8D44\u6E90\u3002</li></ol><p><img src="https://img-blog.csdnimg.cn/222d8fe9ac8440e594cd6aaa6ba44f8e.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h4 id="_1-3-3-mapreduce\u67B6\u6784\u6982\u8FF0" tabindex="-1">1.3.3 MapReduce\u67B6\u6784\u6982\u8FF0 <a class="header-anchor" href="#_1-3-3-mapreduce\u67B6\u6784\u6982\u8FF0" aria-hidden="true">#</a></h4><p><code>MapReduce</code>\u5C06\u8BA1\u7B97\u5206\u4E3A\u4E24\u4E2A\u9636\u6BB5<code>Map</code>\u548C<code>Reduce</code>\u3002</p><ol><li><code>Map</code>\u9636\u6BB5: \u5E76\u884C\u5904\u7406\u8F93\u5165\u6570\u636E\u3002</li><li><code>Reduce</code>\u9636\u6BB5: \u5BF9<code>Map</code>\u7ED3\u679C\u8FDB\u884C\u6C47\u603B\u3002</li></ol><h3 id="_1-4-\u5927\u6570\u636E\u6280\u672F\u751F\u6001\u4F53\u7CFB" tabindex="-1">1.4 \u5927\u6570\u636E\u6280\u672F\u751F\u6001\u4F53\u7CFB <a class="header-anchor" href="#_1-4-\u5927\u6570\u636E\u6280\u672F\u751F\u6001\u4F53\u7CFB" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/683c98019a7d487eba94d9b95af505f8.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u63A8\u8350\u7CFB\u7EDF: \u7528\u6237\u641C\u7D22/\u8D2D\u4E70\u8BB0\u5F55\u5230\u65E5\u5FD7\uFF0C<code>Flume</code>\u91C7\u96C6\u5BF9\u5E94\u7684\u65E5\u5FD7\u4EA4\u7ED9<code>Kafka</code>\u505A\u7F13\u51B2\uFF0C\u7136\u540E\u4EA4\u7ED9<code>Flink</code>\u505A\u5B9E\u65F6\u8BA1\u7B97\uFF0C\u8BA1\u7B97\u5B8C\u6210\u5B58\u50A8\u6210\u6587\u4EF6/\u6570\u636E\u5E93 \u63A8\u8350\u4E1A\u52A1\u8BFB\u53D6\u8BA1\u7B97\u5B8C\u6210\u7684\u7ED3\u679C\u8FD4\u56DE\u7ED9\u524D\u7AEF\u3002</p><h2 id="_2-\u751F\u4EA7\u96C6\u7FA4\u642D\u5EFA" tabindex="-1">2 \u751F\u4EA7\u96C6\u7FA4\u642D\u5EFA <a class="header-anchor" href="#_2-\u751F\u4EA7\u96C6\u7FA4\u642D\u5EFA" aria-hidden="true">#</a></h2><h3 id="_2-1-\u51C6\u5907\u5DE5\u4F5C" tabindex="-1">2.1 \u51C6\u5907\u5DE5\u4F5C <a class="header-anchor" href="#_2-1-\u51C6\u5907\u5DE5\u4F5C" aria-hidden="true">#</a></h3><p>\u6B63\u5E38\u5B89\u88C5<code>centos7.5</code>\u6700\u5C0F\u7248</p><p>\u4FEE\u6539<code>ip</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">vi /etc/sysconfig/network-scripts/ifcfg-ens33</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/4783521ddb9748ca98f1f565d71b7d9a.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u4FEE\u6539<code>host</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">vi /etc/hostname</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u5E94\u7528\u91CD\u542F\u7F51\u7EDC\u670D\u52A1\uFF0C\u5982\u679C\u62A5\u9519\u5C31\u91CD\u542F\u865A\u62DF\u673A<code>reboot</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">systemctl restart network</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u5B89\u88C5<code>epel-release</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">yum install -y epel-release</span></span>
<span class="line"><span style="color:#676E95;"># \u8FD8\u9700\u8981\u5B89\u88C5 net-tools</span></span>
<span class="line"><span style="color:#A6ACCD;">yum install -y net-tools</span></span>
<span class="line"><span style="color:#676E95;"># vim \u7F16\u8F91\u5668</span></span>
<span class="line"><span style="color:#A6ACCD;">yum install -y vim </span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u5173\u95ED\u9632\u706B\u5899</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">systemctl stop firewalld</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl disable firewalld.service</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u5B89\u88C5<code>jdk</code>\uFF0C\u89E3\u538B\u914D\u7F6E</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">tar -zxvf jdk</span><span style="color:#89DDFF;">***</span><span style="color:#A6ACCD;">.tar.gz</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u8FDB\u5165<code>/etc/profile.d</code>\uFF0C\u521B\u5EFA\u4E00\u4E2A<code>shell</code>\u811A\u672C\uFF0C\u7136\u540E\u6267\u884C<code>source /etc/profile</code>\u3002</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># Java_Home jdk 8</span></span>
<span class="line"><span style="color:#C792EA;">export</span><span style="color:#A6ACCD;"> JAVA_HOME=/home/module/jdk1.8.0_152</span></span>
<span class="line"><span style="color:#C792EA;">export</span><span style="color:#A6ACCD;"> PATH=</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">PATH:</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">JAVA_HOME/bin</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u68C0\u67E5<code>java</code>\u5B89\u88C5</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">java -version</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">## \u6253\u5370 </span></span>
<span class="line"><span style="color:#A6ACCD;">java version </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.8.0_152</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Java</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">TM</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> SE Runtime Environment </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">build 1.8.0_152-b16</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">Java HotSpot</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">TM</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> 64-Bit Server VM </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">build 25.152-b16, mixed mode</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u65E0\u5BC6\u767B\u5F55</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">ssh-keygen -t rsa</span></span>
<span class="line"><span style="color:#A6ACCD;">ssh-copy-id ip</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_2-1-1-\u5B89\u88C5hadoop-3-1-3" tabindex="-1">2.1.1 \u5B89\u88C5Hadoop 3.1.3 <a class="header-anchor" href="#_2-1-1-\u5B89\u88C5hadoop-3-1-3" aria-hidden="true">#</a></h4><p>\u89E3\u538B\u7F29</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">tar -zxvf hadoop-3.1.3.tar.gz </span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u8FDB\u5165<code>/etc/profile.d</code>\uFF0C\u521B\u5EFA\u4E00\u4E2A<code>shell</code>\u811A\u672C\uFF0C\u7136\u540E\u6267\u884C<code>source /etc/profile</code>\u3002</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">cat /etc/profile.d/my_hadoop_env.sh </span></span>
<span class="line"><span style="color:#676E95;">#Hadoop hadoop 3.1.3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">export</span><span style="color:#A6ACCD;"> HADOOP_HOME=/home/module/hadoop-3.1.3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">export</span><span style="color:#A6ACCD;"> PATH=</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">PATH:</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">HADOOP_HOME/bin</span></span>
<span class="line"><span style="color:#C792EA;">export</span><span style="color:#A6ACCD;"> PATH=</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">PATH:</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">HADOOP_HOME/sbin</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u68C0\u67E5<code>hadoop</code>\u5B89\u88C5</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop</span></span>
<span class="line"><span style="color:#676E95;"># \u6253\u5370</span></span>
<span class="line"><span style="color:#A6ACCD;">Usage: hadoop </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">OPTIONS</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> SUBCOMMAND </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">SUBCOMMAND OPTIONS</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> or    hadoop </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">OPTIONS</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> CLASSNAME </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">CLASSNAME OPTIONS</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">  where CLASSNAME is a user-provided Java class</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  OPTIONS is none or any of:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">buildpaths                       attempt to add class files from build tree</span></span>
<span class="line"><span style="color:#A6ACCD;">--config dir                     Hadoop config directory</span></span>
<span class="line"><span style="color:#A6ACCD;">--debug                          turn on shell script debug mode</span></span>
<span class="line"><span style="color:#A6ACCD;">--help                           usage information</span></span>
<span class="line"><span style="color:#A6ACCD;">hostnames list</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">,of,host,names</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">   hosts to use </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> slave mode</span></span>
<span class="line"><span style="color:#A6ACCD;">hosts filename                   list of hosts to use </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> slave mode</span></span>
<span class="line"><span style="color:#A6ACCD;">loglevel level                   </span><span style="color:#82AAFF;">set</span><span style="color:#A6ACCD;"> the log4j level </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> this </span><span style="color:#82AAFF;">command</span></span>
<span class="line"><span style="color:#A6ACCD;">workers                          turn on worker mode</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  SUBCOMMAND is one of:</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    Admin Commands:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">daemonlog     get/set the log level </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> each daemon</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    Client Commands:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">archive       create a Hadoop archive</span></span>
<span class="line"><span style="color:#A6ACCD;">checknative   check native Hadoop and compression libraries availability</span></span>
<span class="line"><span style="color:#A6ACCD;">classpath     prints the class path needed to get the Hadoop jar and the required libraries</span></span>
<span class="line"><span style="color:#A6ACCD;">conftest      validate configuration XML files</span></span>
<span class="line"><span style="color:#A6ACCD;">credential    interact with credential providers</span></span>
<span class="line"><span style="color:#A6ACCD;">distch        distributed metadata changer</span></span>
<span class="line"><span style="color:#A6ACCD;">distcp        copy file or directories recursively</span></span>
<span class="line"><span style="color:#A6ACCD;">dtutil        operations related to delegation tokens</span></span>
<span class="line"><span style="color:#A6ACCD;">envvars       display computed Hadoop environment variables</span></span>
<span class="line"><span style="color:#A6ACCD;">fs            run a generic filesystem user client</span></span>
<span class="line"><span style="color:#A6ACCD;">gridmix       submit a mix of synthetic job, modeling a profiled from production load</span></span>
<span class="line"><span style="color:#A6ACCD;">jar </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">jar</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">     run a jar file. NOTE: please use </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">yarn jar</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> to launch YARN applications, not this command.</span></span>
<span class="line"><span style="color:#A6ACCD;">jnipath       prints the java.library.path</span></span>
<span class="line"><span style="color:#A6ACCD;">kdiag         Diagnose Kerberos Problems</span></span>
<span class="line"><span style="color:#A6ACCD;">kerbname      show auth_to_local principal conversion</span></span>
<span class="line"><span style="color:#A6ACCD;">key           manage keys via the KeyProvider</span></span>
<span class="line"><span style="color:#A6ACCD;">rumenfolder   scale a rumen input trace</span></span>
<span class="line"><span style="color:#A6ACCD;">rumentrace    convert logs into a rumen trace</span></span>
<span class="line"><span style="color:#A6ACCD;">s3guard       manage metadata on S3</span></span>
<span class="line"><span style="color:#A6ACCD;">trace         view and modify Hadoop tracing settings</span></span>
<span class="line"><span style="color:#A6ACCD;">version       print the version</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    Daemon Commands:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">kms           run KMS, the Key Management Server</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">SUBCOMMAND may print </span><span style="color:#82AAFF;">help</span><span style="color:#A6ACCD;"> when invoked w/o parameters or with -h.</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p>\u4EE5\u4E0A\u5C31\u7B97\u5B89\u88C5\u6210\u529F\u3002</p><h4 id="_2-1-2-hadoop-\u76EE\u5F55\u5185\u5BB9" tabindex="-1">2.1.2 hadoop \u76EE\u5F55\u5185\u5BB9 <a class="header-anchor" href="#_2-1-2-hadoop-\u76EE\u5F55\u5185\u5BB9" aria-hidden="true">#</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> hadoop-3.1.3</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@hadoop1207 hadoop-3.1.3</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># ll</span></span>
<span class="line"><span style="color:#A6ACCD;">\u603B\u7528\u91CF 180</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 2 1000 1000    183 9\u6708  12 2019 bin</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 3 1000 1000     20 9\u6708  12 2019 etc</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 2 1000 1000    106 9\u6708  12 2019 include</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 3 1000 1000     20 9\u6708  12 2019 lib</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 4 1000 1000   4096 9\u6708  12 2019 libexec</span></span>
<span class="line"><span style="color:#A6ACCD;">-rw-rw-r--. 1 1000 1000 147145 9\u6708   4 2019 LICENSE.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">-rw-rw-r--. 1 1000 1000  21867 9\u6708   4 2019 NOTICE.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">-rw-rw-r--. 1 1000 1000   1366 9\u6708   4 2019 README.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 3 1000 1000   4096 9\u6708  12 2019 sbin</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 4 1000 1000     31 9\u6708  12 2019 share</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>bin \u76EE\u5F55</strong> \u4E00\u4E9B\u547D\u4EE4\u7684\u6587\u4EF6\u76EE\u5F55</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> bin/</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@hadoop1207 bin</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># ll</span></span>
<span class="line"><span style="color:#A6ACCD;">\u603B\u7528\u91CF 996</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 441936 9\u6708  12 2019 container-executor</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000   8707 9\u6708  12 2019 hadoop</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000  11265 9\u6708  12 2019 hadoop.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000  11026 9\u6708  12 2019 hdfs  			</span><span style="color:#676E95;"># \u548C\u8D44\u6E90\u5B58\u50A8\u76F8\u5173\u7684\u547D\u4EE4</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000   8081 9\u6708  12 2019 hdfs.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000   6237 9\u6708  12 2019 mapred			</span><span style="color:#676E95;"># \u548C\u8BA1\u7B97\u76F8\u5173\u7684\u547D\u4EE4</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000   6311 9\u6708  12 2019 mapred.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 483728 9\u6708  12 2019 test-container-executor</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000  11888 9\u6708  12 2019 yarn				</span><span style="color:#676E95;"># \u548C\u8D44\u6E90\u8C03\u5EA6\u76F8\u5173\u7684\u547D\u4EE4</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000  12840 9\u6708  12 2019 yarn.cmd</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>etc/hadoop \u76EE\u5F55</strong> \u5B58\u50A8\u4E00\u4E9B\u914D\u7F6E\u6587\u4EF6\uFF0C\u914D\u7F6E<code>hdfs</code>,<code>mapre </code>,<code>yarn</code></p><p><strong>sbin \u76EE\u5F55</strong> \u5B58\u50A8\u4E00\u4E9B\u542F\u52A8\u811A\u672C</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> sbin/</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@hadoop1207 sbin</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># ll</span></span>
<span class="line"><span style="color:#A6ACCD;">\u603B\u7528\u91CF 108</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 2756 9\u6708  12 2019 distribute-exclude.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">drwxr-xr-x. 4 1000 1000   36 9\u6708  12 2019 FederationStateStore</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1983 9\u6708  12 2019 hadoop-daemon.sh			</span><span style="color:#676E95;"># \u5355\u8282\u70B9\u670D\u52A1\u5668</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 2522 9\u6708  12 2019 hadoop-daemons.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1542 9\u6708  12 2019 httpfs.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1500 9\u6708  12 2019 kms.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1841 9\u6708  12 2019 mr-jobhistory-daemon.sh	</span><span style="color:#676E95;"># \u542F\u52A8\u5386\u53F2\u670D\u52A1\u5668</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 2086 9\u6708  12 2019 refresh-namenodes.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1779 9\u6708  12 2019 start-all.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 2221 9\u6708  12 2019 start-all.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1880 9\u6708  12 2019 start-balancer.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1401 9\u6708  12 2019 start-dfs.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 5170 9\u6708  12 2019 start-dfs.sh  				</span><span style="color:#676E95;"># hdfs\u96C6\u7FA4\u7684\u542F\u52A8\u547D\u4EE4</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1793 9\u6708  12 2019 start-secure-dns.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1571 9\u6708  12 2019 start-yarn.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 3342 9\u6708  12 2019 start-yarn.sh				</span><span style="color:#676E95;"># \u8D44\u6E90\u8C03\u5EA6\u5668\u547D\u4EE4</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1770 9\u6708  12 2019 stop-all.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 2166 9\u6708  12 2019 stop-all.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1783 9\u6708  12 2019 stop-balancer.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1455 9\u6708  12 2019 stop-dfs.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 3898 9\u6708  12 2019 stop-dfs.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1756 9\u6708  12 2019 stop-secure-dns.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1642 9\u6708  12 2019 stop-yarn.cmd</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 3083 9\u6708  12 2019 stop-yarn.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1982 9\u6708  12 2019 workers.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 1814 9\u6708  12 2019 yarn-daemon.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">-rwxr-xr-x. 1 1000 1000 2328 9\u6708  12 2019 yarn-daemons.sh</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="_2-2-\u672C\u5730\u6A21\u5F0F" tabindex="-1">2.2 \u672C\u5730\u6A21\u5F0F <a class="header-anchor" href="#_2-2-\u672C\u5730\u6A21\u5F0F" aria-hidden="true">#</a></h3><p>\u4E0D\u501F\u52A9<code>hdfs</code>\u5C06\u6587\u4EF6\u5B58\u50A8\u518D\u670D\u52A1\u5668\u5185\u90E8\u3002</p><p>\u521B\u5EFA\u4E00\u4E2A\u6587\u4EF6\uFF0C\u968F\u4FBF\u5199\u4E00\u4E9B\u5185\u5BB9\uFF0C\u7EDF\u8BA1\u6BCF\u4E2A\u5355\u8BCD\u51FA\u73B0\u9891\u7387\u3002</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">cat laoshireninput/word.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">laoshiren</span></span>
<span class="line"><span style="color:#A6ACCD;">xiangdehua</span></span>
<span class="line"><span style="color:#A6ACCD;">laoshiren</span></span>
<span class="line"><span style="color:#A6ACCD;">zhoujielun</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u6267\u884C\u8BA1\u7B97\uFF0C\u5FC5\u987B\u6307\u5B9A\u4E00\u4E2A\u8F93\u5165\u8DEF\u5F84\uFF0C\u4E00\u4E2A\u8F93\u51FA\u8DEF\u5F84</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar wordcount laoshireninput/ ./laoshirenoutput</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> laoshirenoutput/</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@hadoop1207 laoshirenoutput</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># ll</span></span>
<span class="line"><span style="color:#A6ACCD;">\u603B\u7528\u91CF 4</span></span>
<span class="line"><span style="color:#A6ACCD;">-rw-r--r--. 1 root root 38 4\u6708  25 01:18 part-r-00000			</span><span style="color:#676E95;"># \u771F\u6B63\u7684\u6570\u636E</span></span>
<span class="line"><span style="color:#A6ACCD;">-rw-r--r--. 1 root root  0 4\u6708  25 01:18 _SUCCESS				</span><span style="color:#676E95;"># \u8868\u793A\u6807\u8BB0\u5E76\u6CA1\u6709\u6570\u636E</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">cat part-r-00000 </span></span>
<span class="line"><span style="color:#A6ACCD;">laoshiren	2</span></span>
<span class="line"><span style="color:#A6ACCD;">xiangdehua	1</span></span>
<span class="line"><span style="color:#A6ACCD;">zhoujielun	1</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_2-3-\u5B8C\u5168\u5206\u5E03\u5F0F\u96C6\u7FA4" tabindex="-1">2.3 \u5B8C\u5168\u5206\u5E03\u5F0F\u96C6\u7FA4 <a class="header-anchor" href="#_2-3-\u5B8C\u5168\u5206\u5E03\u5F0F\u96C6\u7FA4" aria-hidden="true">#</a></h3><h4 id="_2-3-1-\u51C6\u5907\u5DE5\u4F5C" tabindex="-1">2.3.1 \u51C6\u5907\u5DE5\u4F5C <a class="header-anchor" href="#_2-3-1-\u51C6\u5907\u5DE5\u4F5C" aria-hidden="true">#</a></h4><p>\u5728\u521B\u5EFA2\u4E2A\u5B8C\u5168\u4E00\u81F4\u7684\u865A\u62DF\u673A\uFF0C\u53EF\u4EE5\u4E0D\u88C5<code>JDK</code>\u548C<code>hadoop</code>\uFF0C\u7B49\u540E\u671F\u4F7F\u7528<code>scp</code>\u62F7\u8D1D\u8FC7\u53BB\u3002</p><p><img src="https://img-blog.csdnimg.cn/cfc2f17dea214b3dabecf500548fa1dc.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u62F7\u8D1D<code>JDK</code>\u548C<code>Hadoop</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">scp -r jdk1.8.0_152/ root@192.168.8.202:/root/module</span></span>
<span class="line"><span style="color:#676E95;"># scp \u5B89\u5168\u62F7\u8D1D</span></span>
<span class="line"><span style="color:#676E95;"># -r \u9012\u5F52</span></span>
<span class="line"><span style="color:#676E95;"># \u672C\u5730\u6587\u4EF6</span></span>
<span class="line"><span style="color:#676E95;"># \u7528\u6237@\u4E3B\u673A:\u5BF9\u5E94\u8DEF\u5F84</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">scp -r hadoop-3.1.3/ root@192.168.8.202:/opt/modules</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u4FEE\u6539<code>/etc/hosts</code>\u6587\u4EF6\uFF0C\u8FFD\u52A0\u5982\u4E0B\u5185\u5BB9</p><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">172.31.10.201 hadoop201</span></span>
<span class="line"><span style="color:#A6ACCD;">172.31.10.202 hadoop202</span></span>
<span class="line"><span style="color:#A6ACCD;">172.31.10.203 hadoop203</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u5B89\u88C5 <code>rsync</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">yum install -y rsync </span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u540C\u6B65\u811A\u672C\uFF0C\u7528\u4E8E\u540C\u6B65\u673A\u5668\u914D\u7F6E\u6587\u4EF6</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;"># </span><span style="color:#89DDFF;">-lt</span><span style="color:#A6ACCD;"> 1 </span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> Not Enough Arguement</span><span style="color:#89DDFF;">!</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">exit</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> host </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> hadoop202 hadoop203 hadoop201</span></span>
<span class="line"><span style="color:#89DDFF;">do</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> ==================== </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">host ====================</span></span>
<span class="line"><span style="color:#89DDFF;"> </span><span style="color:#676E95;">#3. \u904D\u5386\u6240\u6709\u76EE\u5F55\uFF0C\u6328\u4E2A\u53D1\u9001</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> file </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">@</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">do</span></span>
<span class="line"><span style="color:#89DDFF;"> </span><span style="color:#676E95;">#4. \u5224\u65AD\u6587\u4EF6\u662F\u5426\u5B58\u5728</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-e</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">file </span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#89DDFF;"> </span><span style="color:#676E95;">#5. \u83B7\u53D6\u7236\u76EE\u5F55</span></span>
<span class="line"><span style="color:#A6ACCD;"> pdir=</span><span style="color:#89DDFF;">$(</span><span style="color:#C3E88D;">cd -P </span><span style="color:#89DDFF;">$(</span><span style="color:#C3E88D;">dirname </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">);</span><span style="color:#C3E88D;"> pwd</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;"> </span><span style="color:#676E95;">#6. \u83B7\u53D6\u5F53\u524D\u6587\u4EF6\u7684\u540D\u79F0</span></span>
<span class="line"><span style="color:#A6ACCD;"> fname=</span><span style="color:#89DDFF;">$(</span><span style="color:#C3E88D;">basename </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;"> ssh </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">host </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mkdir -p </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">pdir</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> rsync -av </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">pdir/</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">fname </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">host:</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">pdir</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">else</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">file does not exists</span><span style="color:#89DDFF;">!</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">fi</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">done</span></span>
<span class="line"><span style="color:#89DDFF;">done</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h4 id="_2-3-2-hadoop-\u914D\u7F6E\u6587\u4EF6" tabindex="-1">2.3.2 Hadoop \u914D\u7F6E\u6587\u4EF6 <a class="header-anchor" href="#_2-3-2-hadoop-\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a></h4><table><thead><tr><th></th><th>hadoop201</th><th>hadoop202</th><th>hadoop203</th></tr></thead><tbody><tr><td>HDFS</td><td>NameNode DataNode</td><td>DataNode</td><td>SNN DataNode</td></tr><tr><td>YARN</td><td>NodeManager</td><td>ResourceManager NodeManager</td><td>NodeManager</td></tr></tbody></table><p>\u9ED8\u8BA4\u914D\u7F6E\u6587\u4EF6</p><p>\u6838\u5FC3\u914D\u7F6E\u6587\u4EF6 <code>core-site.xml</code></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml-stylesheet</span><span style="color:#C792EA;"> type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">text/xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">configuration.xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- \u6307\u5B9A NameNode \u7684\u5730\u5740 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">fs.defaultFS</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hdfs://hadoop201:8020</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- \u6307\u5B9A hadoop \u6570\u636E\u7684\u5B58\u50A8\u76EE\u5F55 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop.tmp.dir</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">/home/module/hadoop-3.1.3/data</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- \u914D\u7F6E HDFS \u7F51\u9875\u767B\u5F55\u4F7F\u7528\u7684\u9759\u6001\u7528\u6237\u4E3A atguigu --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop.http.staticuser.user</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">root</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>HDFS \u914D\u7F6E\u6587\u4EF6<code>hdfs-site.xml</code></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml-stylesheet</span><span style="color:#C792EA;"> type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">text/xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">configuration.xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- nn web \u7AEF\u8BBF\u95EE\u5730\u5740--&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">dfs.namenode.http-address</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop201:9870</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- 2nn web \u7AEF\u8BBF\u95EE\u5730\u5740--&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">dfs.namenode.secondary.http-address</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop203:9868</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><code>YARN</code>\u914D\u7F6E\u6587\u4EF6<code>yarn-site.xml</code></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- \u6307\u5B9A MR \u8D70 shuffle --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.nodemanager.aux-services</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce_shuffle</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- \u6307\u5B9A ResourceManager \u7684\u5730\u5740--&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.resourcemanager.hostname</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop202</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- \u73AF\u5883\u53D8\u91CF\u7684\u7EE7\u627F --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.nodemanager.env-whitelist</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CO</span></span>
<span class="line"><span style="color:#A6ACCD;">            NF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAP</span></span>
<span class="line"><span style="color:#A6ACCD;">            RED_HOME</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.nodemanager.vmem-check-enabled</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">false</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.log-aggregation-enable</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">true</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- \u8BBE\u7F6E\u65E5\u5FD7\u805A\u96C6\u670D\u52A1\u5668\u5730\u5740 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.log.server.url</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">http://hadoop201:19888/jobhistory/logs</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- \u8BBE\u7F6E\u65E5\u5FD7\u4FDD\u7559\u65F6\u95F4\u4E3A 7 \u5929 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.log-aggregation.retain-seconds</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">604800</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>MapReduce \u914D\u7F6E\u6587\u4EF6<code>mapred-site.xml</code></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml-stylesheet</span><span style="color:#C792EA;"> type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">text/xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">configuration.xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- \u6307\u5B9Amapreduce \u7A0B\u5E8F\u8FD0\u884C\u5728yarn --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce.framework.name</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">yarn.app.mapreduce.am.env</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">HADOOP_MAPRED_HOME=/home/module/hadoop-3.1.3</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce.map.env</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">HADOOP_MAPRED_HOME=/home/module/hadoop-3.1.3</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce.reduce.env</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">HADOOP_MAPRED_HOME=/home/module/hadoop-3.1.3</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce.cluster.map.memory.mb</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">-1</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce.cluster.reduce.memory.mb</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">-1</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- \u5386\u53F2\u670D\u52A1\u5668\u7AEF\u5730\u5740 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce.jobhistory.address</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop201:10020</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">&lt;!-- \u5386\u53F2\u670D\u52A1\u5668 web \u7AEF\u5730\u5740 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mapreduce.jobhistory.webapp.address</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop201:19888</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p><code>vi workers</code></p><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop201</span></span>
<span class="line"><span style="color:#A6ACCD;">hadoop202</span></span>
<span class="line"><span style="color:#A6ACCD;">hadoop203</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u5206\u53D1\u914D\u7F6E\u6587\u4EF6</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">xsync /home/module/hadoop-3.1.3/etc/hadoop</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u4FEE\u6539\u542F\u52A8\u6587\u4EF6 <code>sbin/start-dfs.sh</code>\u548C<code>sbin/stop-dfs.sh</code> \u548C<code>sbin/start-yarn.sh</code>\u548C<code>sbin/stop-yarn.sh</code>\uFF0C\u5E76\u5206\u53D1<code>xsync /home/module/hadoop-3.1.3/sbin</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">#!/usr/bin/env bash</span></span>
<span class="line"><span style="color:#A6ACCD;">HDFS_DATANODE_USER=root</span></span>
<span class="line"><span style="color:#A6ACCD;">HADOOP_SECURE_DN_USER=hdfs</span></span>
<span class="line"><span style="color:#A6ACCD;">HDFS_NAMENODE_USER=root</span></span>
<span class="line"><span style="color:#A6ACCD;">HDFS_SECONDARYNAMENODE_USER=root</span></span>
<span class="line"><span style="color:#A6ACCD;">YARN_RESOURCEMANAGER_USER=root</span></span>
<span class="line"><span style="color:#A6ACCD;">HADOOP_SECURE_DN_USER=yarn</span></span>
<span class="line"><span style="color:#A6ACCD;">YARN_NODEMANAGER_USER=root</span></span>
<span class="line"><span style="color:#676E95;"># ...\u7701\u7565</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>\u96C6\u7FA4\u521D\u59CB\u5316</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hdfs namenode -format</span></span>
<span class="line"><span style="color:#676E95;"># \u542F\u52A8hdfs</span></span>
<span class="line"><span style="color:#A6ACCD;">sbin/start-dfs.sh</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u5230<code>hadoop202</code>\u673A\u5668 \u542F\u52A8 <code>resouce manager</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">sbin/start-yarn.sh</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u67E5\u770B<code>http://hadoop201:9870</code>,<a href="http://hadoop201:9870" target="_blank" rel="noreferrer">\u5730\u5740</a></p><p>\u67E5\u770B<code>http://hadoop202:8088</code>,<a href="http://hadoop202:8088" target="_blank" rel="noreferrer">\u5730\u5740</a></p><h4 id="_2-3-3-\u57FA\u7840\u6D4B\u8BD5" tabindex="-1">2.3.3 \u57FA\u7840\u6D4B\u8BD5 <a class="header-anchor" href="#_2-3-3-\u57FA\u7840\u6D4B\u8BD5" aria-hidden="true">#</a></h4><p>\u521B\u5EFA\u76EE\u5F55</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -mkdir /wcinput</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u4E0A\u4F20\u6587\u4EF6</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -put /root/a.txt /wcinput</span></span>
<span class="line"><span style="color:#676E95;"># \u8F93\u51FA</span></span>
<span class="line"><span style="color:#A6ACCD;">2021-05-05 13:15:51,994 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = </span><span style="color:#82AAFF;">false</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/4a44b09ef326419cacf0d9bbc2ddbbae.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u5B9E\u9645\u5B58\u50A8\u5728</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">cat </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">HADOOP_HOME/data/dfs/data/current/BP-1065121377-192.168.8.201-1620119427494/current/finalized/subdir0/subdir0/blk_1073741825</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>wordcount</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar wordcount /wcinput /wcoutput</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u7F16\u5199\u542F\u52A8\u811A\u672C</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">#!/bin/bash</span></span>
<span class="line"><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;"># </span><span style="color:#89DDFF;">-lt</span><span style="color:#A6ACCD;"> 1 </span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">then</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">No Args Input...</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">exit</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">fi</span></span>
<span class="line"><span style="color:#89DDFF;">case</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">1 </span><span style="color:#89DDFF;">in</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">start</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> =================== \u542F\u52A8 hadoop \u96C6\u7FA4 ===================</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> --------------- \u542F\u52A8 hdfs ---------------</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> ssh hadoop201 </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/home/module/hadoop-3.1.3/sbin/start-dfs.sh</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> --------------- \u542F\u52A8 yarn ---------------</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">ssh hadoop202 </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/home/module/hadoop-3.1.3/sbin/start-yarn.sh</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> --------------- \u542F\u52A8 historyserver ---------------</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> ssh hadoop201 </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/home/module/hadoop-3.1.3/bin/mapred --daemon start historyserver</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">stop</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> =================== \u5173\u95ED hadoop \u96C6\u7FA4 ===================</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> --------------- \u5173\u95ED historyserver ---------------</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> ssh hadoop201 </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/home/module/hadoop-3.1.3/bin/mapred --daemon stop historyserver</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> --------------- \u5173\u95ED yarn ---------------</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> ssh hadoop202 </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/home/module/hadoop-3.1.3/sbin/stop-yarn.sh</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> --------------- \u5173\u95ED hdfs ---------------</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> ssh hadoop201 </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/home/module/hadoop-3.1.3/sbin/stop-dfs.sh</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#89DDFF;">*)</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Input Args Error...</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#89DDFF;">esac</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h1 id="hdfs" tabindex="-1">HDFS <a class="header-anchor" href="#hdfs" aria-hidden="true">#</a></h1><h2 id="hdfs-\u4EA7\u751F\u80CC\u666F" tabindex="-1">hdfs \u4EA7\u751F\u80CC\u666F <a class="header-anchor" href="#hdfs-\u4EA7\u751F\u80CC\u666F" aria-hidden="true">#</a></h2><p>\u968F\u7740\u6570\u636E\u91CF\u8D8A\u6765\u8D8A\u5927\uFF0C\u5728\u4E00\u4E2A\u64CD\u4F5C\u7CFB\u7EDF\u5B58\u4E0D\u4E0B\u6240\u6709\u7684\u6570\u636E\uFF0C\u90A3\u4E48\u5C31\u5206\u914D\u5230\u66F4\u591A\u7684\u64CD\u4F5C\u7CFB \u7EDF\u7BA1\u7406\u7684\u78C1\u76D8\u4E2D\uFF0C\u4F46\u662F\u4E0D\u65B9\u4FBF\u7BA1\u7406\u548C\u7EF4\u62A4\uFF0C\u8FEB\u5207\u9700\u8981\u4E00\u79CD\u7CFB\u7EDF\u6765\u7BA1\u7406\u591A\u53F0\u673A\u5668\u4E0A\u7684\u6587\u4EF6\uFF0C\u8FD9 \u5C31\u662F\u5206\u5E03\u5F0F\u6587\u4EF6\u7BA1\u7406\u7CFB\u7EDF\u3002HDFS \u53EA\u662F\u5206\u5E03\u5F0F\u6587\u4EF6\u7BA1\u7406\u7CFB\u7EDF\u4E2D\u7684\u4E00\u79CD\u3002</p><p>HDFS\uFF08Hadoop Distributed File System\uFF09\uFF0C\u5B83\u662F\u4E00\u4E2A\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u7528\u4E8E\u5B58\u50A8\u6587\u4EF6\uFF0C\u901A\u8FC7\u76EE \u5F55\u6811\u6765\u5B9A\u4F4D\u6587\u4EF6\uFF1B\u5176\u6B21\uFF0C\u5B83\u662F\u5206\u5E03\u5F0F\u7684\uFF0C\u7531\u5F88\u591A\u670D\u52A1\u5668\u8054\u5408\u8D77\u6765\u5B9E\u73B0\u5176\u529F\u80FD\uFF0C\u96C6\u7FA4\u4E2D\u7684\u670D\u52A1 \u5668\u6709\u5404\u81EA\u7684\u89D2\u8272\u3002 HDFS \u7684\u4F7F\u7528\u573A\u666F\uFF1A\u9002\u5408\u4E00\u6B21\u5199\u5165\uFF0C\u591A\u6B21\u8BFB\u51FA\u7684\u573A\u666F\u3002\u4E00\u4E2A\u6587\u4EF6\u7ECF\u8FC7\u521B\u5EFA\u3001\u5199\u5165\u548C\u5173\u95ED \u4E4B\u540E\u5C31\u4E0D\u9700\u8981\u6539\u53D8\u3002</p><h3 id="hdfs-\u4F18\u7F3A\u70B9" tabindex="-1">hdfs \u4F18\u7F3A\u70B9 <a class="header-anchor" href="#hdfs-\u4F18\u7F3A\u70B9" aria-hidden="true">#</a></h3><p>\u4F18\u70B9</p><ol><li>\u9AD8\u5BB9\u9519\u6027</li></ol><ul><li>\u6570\u636E\u81EA\u52A8\u4FDD\u5B58\u591A\u4E2A\u526F\u672C\u3002\u5B83\u901A\u8FC7\u589E\u52A0\u526F\u672C\u7684\u5F62\u5F0F\uFF0C\u63D0\u9AD8\u5BB9\u9519\u6027\u3002</li><li>\u67D0\u4E2A\u526F\u672C\u4E22\u5931\u4EE5\u540E\uFF0C\u4ED6\u53EF\u4EE5\u81EA\u52A8\u6062\u590D\u3002</li></ul><ol start="2"><li>\u9002\u5408\u5904\u7406\u5927\u6570\u636E</li></ol><ul><li>\u6570\u636E\u89C4\u6A21\uFF1A\u80FD\u591F\u5904\u7406\u6570\u636E\u89C4\u6A21\u8FBE\u5230GB\u3001TB\u3001\u751A\u81F3PB\u7EA7\u522B\u7684\u6570\u636E\uFF1B</li><li>\u6587\u4EF6\u89C4\u6A21\uFF1A\u80FD\u591F\u5904\u7406\u767E\u4E07\u89C4\u6A21\u4EE5\u4E0A\u7684\u6587\u4EF6\u6570\u91CF\uFF0C\u6570\u91CF\u76F8\u5F53\u4E4B\u5927\u3002</li></ul><ol start="3"><li>\u53EF\u6784\u5EFA\u5728\u5EC9\u4EF7\u673A\u5668\u4E0A\uFF0C\u901A\u8FC7\u591A\u526F\u672C\u673A\u5236\uFF0C\u63D0\u9AD8\u53EF\u9760\u6027\u3002</li></ol><p>\u7F3A\u70B9</p><ul><li><p>\u4E0D\u9002\u5408\u4F4E\u5EF6\u65F6\u6570\u636E\u8BBF\u95EE\uFF0C\u6BD4\u5982\u6BEB\u79D2\u7EA7\u7684\u5B58\u50A8\u6570\u636E\uFF0C\u662F\u505A\u4E0D\u5230\u7684\u3002</p></li><li><p>\u65E0\u6CD5\u9AD8\u6548\u7684\u5BF9\u5927\u91CF\u5C0F\u6587\u4EF6\u8FDB\u884C\u5B58\u50A8\u3002</p><ul><li>\u5B58\u50A8\u5927\u91CF\u5C0F\u6587\u4EF6\u7684\u8BDD\uFF0C\u5B83\u4F1A\u5360\u7528NameNode\u5927\u91CF\u7684\u5185\u5B58\u6765\u5B58\u50A8\u6587\u4EF6\u76EE \u5F55\u548C \u5757\u4FE1\u606F\u3002\u8FD9\u6837\u662F\u4E0D\u53EF\u53D6\u7684\uFF0C\u56E0\u4E3ANameNode\u7684\u5185\u5B58\u603B\u662F\u6709\u9650\u7684\uFF1B</li><li>\u5C0F\u6587\u4EF6\u5B58\u50A8\u7684\u5BFB\u5740\u65F6\u95F4\u4F1A\u8D85\u8FC7\u8BFB\u53D6\u65F6\u95F4\uFF0C\u5B83\u8FDD\u53CD\u4E86HDFS\u7684\u8BBE\u8BA1\u76EE\u6807\u3002</li><li>\u4E0D\u652F\u6301\u5E76\u53D1\u5199\u5165\u3001\u6587\u4EF6\u968F\u673A\u4FEE\u6539\u3002</li></ul></li><li><p>\u4E00\u4E2A\u6587\u4EF6\u53EA\u80FD\u6709\u4E00\u4E2A\u5199\uFF0C\u4E0D\u5141\u8BB8\u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u5199\uFF1B</p></li><li><p>\u4EC5\u652F\u6301\u6570\u636Eappend\uFF08\u8FFD\u52A0\uFF09\uFF0C\u4E0D\u652F\u6301\u6587\u4EF6\u7684\u968F\u673A\u4FEE\u6539</p></li></ul><h3 id="\u7EC4\u6210" tabindex="-1">\u7EC4\u6210 <a class="header-anchor" href="#\u7EC4\u6210" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/910e38c85fc94f068b22dc9650acec7b.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>NameNode(NN)\uFF1A\u5C31\u662FMaster\uFF0C\u5B83\u662F\u4E00\u4E2A\u4E3B\u7BA1\u3001\u7BA1\u7406\u8005\u3002</p><ol><li>\u7BA1\u7406HDFS\u7684\u540D\u79F0\u7A7A\u95F4\uFF1B</li><li>\u914D\u7F6E\u526F\u672C\u7B56\u7565\uFF1B</li><li>\u7BA1\u7406\u6570\u636E\u5757\uFF08Block\uFF09\u6620\u5C04\u4FE1\u606F\uFF1B</li><li>\u5904\u7406\u5BA2\u6237\u7AEF\u8BFB\u5199\u8BF7\u6C42\u3002</li></ol><p>DataNode\uFF1A\u5C31\u662FSlave\u3002NameNode\u4E0B\u8FBE\u547D\u4EE4\uFF0CDataNode\u6267\u884C\u5B9E\u9645\u7684\u64CD\u4F5C\u3002</p><ol><li>\u5B58\u50A8\u5B9E\u9645\u7684\u6570\u636E\u5757\uFF1B</li><li>\u6267\u884C\u6570\u636E\u5757\u7684\u8BFB/\u5199\u64CD\u4F5C\u3002</li></ol><p>Client\uFF1A\u5C31\u662F\u5BA2\u6237\u7AEF\u3002</p><ol><li>\u6587\u4EF6\u5207\u5206\u3002\u6587\u4EF6\u4E0A\u4F20HDFS\u7684\u65F6\u5019\uFF0CClient\u5C06\u6587\u4EF6\u5207\u5206\u6210\u4E00\u4E2A\u4E00\u4E2A\u7684Block\uFF0C\u7136\u540E\u8FDB\u884C\u4E0A\u4F20\uFF1B\uFF08\u6309\u7167NameNode\u6587\u4EF6\u5757\u5206\u5272\uFF09</li><li>\u4E0ENameNode\u4EA4\u4E92\uFF0C\u83B7\u53D6\u6587\u4EF6\u7684\u4F4D\u7F6E\u4FE1\u606F\uFF1B</li><li>\u4E0EDataNode\u4EA4\u4E92\uFF0C\u8BFB\u53D6\u6216\u8005\u5199\u5165\u6570\u636E\uFF1B</li><li>Client\u63D0\u4F9B\u4E00\u4E9B\u547D\u4EE4\u6765\u7BA1\u7406HDFS\uFF0C\u6BD4\u5982NameNode\u683C\u5F0F\u5316\uFF1B</li><li>Client\u53EF\u4EE5\u901A\u8FC7\u4E00\u4E9B\u547D\u4EE4\u6765\u8BBF\u95EEHDFS\uFF0C\u6BD4\u5982\u5BF9HDFS\u589E\u5220\u67E5\u6539\u64CD\u4F5C\uFF1B</li></ol><p>Secondary NameNode\uFF1A\u5E76\u975ENameNode\u7684\u70ED\u5907\u3002\u5F53NameNode\u6302\u6389\u7684\u65F6\u5019\uFF0C\u5B83\u5E76\u4E0D \u80FD\u9A6C\u4E0A\u66FF\u6362NameNode\u5E76\u63D0\u4F9B\u670D\u52A1\u3002</p><ol><li>\u8F85\u52A9NameNode\uFF0C\u5206\u62C5\u5176\u5DE5\u4F5C\u91CF\uFF0C\u6BD4\u5982\u5B9A\u671F\u5408\u5E76Fsimage\u548CEdits\uFF0C\u5E76\u63A8\u9001\u7ED9NameNode \uFF1B</li><li>\u5728\u7D27\u6025\u60C5\u51B5\u4E0B\uFF0C\u53EF\u8F85\u52A9\u6062\u590DNameNode\u3002</li></ol><h3 id="\u6587\u4EF6\u5757\u5927\u5C0F\u95EE\u9898" tabindex="-1">\u6587\u4EF6\u5757\u5927\u5C0F\u95EE\u9898 <a class="header-anchor" href="#\u6587\u4EF6\u5757\u5927\u5C0F\u95EE\u9898" aria-hidden="true">#</a></h3><p>HDFS\u4E2D\u7684\u6587\u4EF6\u5728\u7269\u7406\u4E0A\u662F\u5206\u5757\u5B58\u50A8\uFF08Block\uFF09\uFF0C\u5757\u7684\u5927\u5C0F\u53EF\u4EE5\u901A\u8FC7\u914D\u7F6E\u53C2\u6570 ( dfs.blocksize\uFF09\u6765\u89C4\u5B9A\uFF0C\u9ED8\u8BA4\u5927\u5C0F\u5728Hadoop2.x/3.x\u7248\u672C\u4E2D\u662F128M\uFF0C1.x\u7248\u672C\u4E2D\u662F64M\u3002</p><p><img src="https://img-blog.csdnimg.cn/609c8eab39804f349da7735354134ef2.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u601D\u8003\uFF1A\u4E3A\u4EC0\u4E48\u5757\u7684\u5927\u5C0F\u4E0D\u80FD\u8BBE\u7F6E\u592A\u5C0F\uFF0C\u4E5F\u4E0D\u80FD\u8BBE\u7F6E\u592A\u5927\uFF1F \uFF081\uFF09HDFS\u7684\u5757\u8BBE\u7F6E\u592A\u5C0F\uFF0C\u4F1A\u589E\u52A0\u5BFB\u5740\u65F6\u95F4\uFF0C\u7A0B\u5E8F\u4E00\u76F4\u5728\u627E\u5757\u7684\u5F00\u59CB\u4F4D\u7F6E\uFF1B \uFF082\uFF09\u5982\u679C\u5757\u8BBE\u7F6E\u7684\u592A\u5927\uFF0C\u4ECE\u78C1\u76D8\u4F20\u8F93\u6570\u636E\u7684\u65F6\u95F4\u4F1A\u660E\u663E\u5927\u4E8E\u5B9A\u4F4D\u8FD9\u4E2A\u5757\u5F00 \u59CB\u4F4D\u7F6E\u6240\u9700\u7684\u65F6\u95F4\u3002\u5BFC\u81F4\u7A0B\u5E8F\u5728\u5904\u7406\u8FD9\u5757\u6570\u636E\u65F6\uFF0C\u4F1A\u975E\u5E38\u6162\u3002 \u603B\u7ED3\uFF1AHDFS\u5757\u7684\u5927\u5C0F\u8BBE\u7F6E\u4E3B\u8981\u53D6\u51B3\u4E8E\u78C1\u76D8\u4F20\u8F93\u901F\u7387\u3002</p><h2 id="hdfs\u7684shell\u76F8\u5173\u64CD\u4F5C" tabindex="-1">HDFS\u7684shell\u76F8\u5173\u64CD\u4F5C <a class="header-anchor" href="#hdfs\u7684shell\u76F8\u5173\u64CD\u4F5C" aria-hidden="true">#</a></h2><h3 id="\u57FA\u672C\u8BED\u6CD5" tabindex="-1">\u57FA\u672C\u8BED\u6CD5 <a class="header-anchor" href="#\u57FA\u672C\u8BED\u6CD5" aria-hidden="true">#</a></h3><p><code>hadoop fs \u5177\u4F53\u547D\u4EE4 </code>OR <code>hdfs dfs \u5177\u4F53\u547D\u4EE4</code> \u4E24\u4E2A\u662F\u5B8C\u5168\u76F8\u540C\u7684\u3002</p><p>\u5404\u4E2A\u6A21\u5757\u542F\u52A8\u505C\u6B62HDFS</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">start-dfs.sh , stop-dfs.sh</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u5404\u4E2A\u6A21\u5757\u542F\u52A8\u505C\u6B62yarn</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">start-yarn.sh , stop-yarn.sh</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u9010\u4E00\u542F\u52A8\u548C\u505C\u6B62</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hdfs --daemon start/stop namenode/datanode/secondarynamenode</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">yarn --daemon start/stop resourcemanager/nodemanager</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="\u547D\u4EE4\u5927\u5168" tabindex="-1">\u547D\u4EE4\u5927\u5168 <a class="header-anchor" href="#\u547D\u4EE4\u5927\u5168" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-appendToFile </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localsrc</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">dst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-cat </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-ignoreCrc</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-chgrp </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-R</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> GROUP PATH...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-chmod </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-R</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">MODE</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">,MODE</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">... </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> OCTALMODE</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> PATH...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-chown </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-R</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">OWNER</span><span style="color:#89DDFF;">][</span><span style="color:#A6ACCD;">:</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">GROUP</span><span style="color:#89DDFF;">]]</span><span style="color:#A6ACCD;"> PATH...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-copyFromLocal </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-f</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-p</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localsrc</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">dst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-copyToLocal </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-p</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-ignoreCrc</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-crc</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localdst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-count </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-q</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-cp </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-f</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-p</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">dst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-df </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-h</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-du </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-s</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-h</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-get </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-p</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-ignoreCrc</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-crc</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localdst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-getmerge </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-nl</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localdst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-help </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">cmd ...</span><span style="color:#89DDFF;">]]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-ls </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-d</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-h</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-R</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-mkdir </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-p</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-moveFromLocal </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localsrc</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">dst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-moveToLocal </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localdst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-mv </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">dst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-put </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-f</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-p</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">localsrc</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ... </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">dst</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-rm </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-f</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-r</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">-R</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-skipTrash</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-rmdir </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">--ignore-fail-on-non-empty</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">dir</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">acl_spec</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;]]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-setrep </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-R</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-w</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">rep</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-stat </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">format</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-tail </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-f</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-test -</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">defsz</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-text </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-ignoreCrc</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h4 id="_1-\u4E0A\u4F20\u548C\u4E0B\u8F7D" tabindex="-1">1 \u4E0A\u4F20\u548C\u4E0B\u8F7D <a class="header-anchor" href="#_1-\u4E0A\u4F20\u548C\u4E0B\u8F7D" aria-hidden="true">#</a></h4><ul><li>\u4ECE\u672C\u5730<span style="color:red;">\u526A\u5207\u7C98\u8D34</span>\u5230 HDFS</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -moveFromLocal ./shuguo.txt /sanguo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>\u4ECE\u672C\u5730\u6587\u4EF6\u7CFB\u7EDF\u4E2D\u62F7\u8D1D\u6587\u4EF6\u5230 HDFS \u8DEF\u5F84\u53BB</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -copyFromLocal ./weiguo.txt /sanguo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u7B49\u540C\u4E8E<code>hadoop fs -put filePath dir</code></p><ul><li>\u8FFD\u52A0\u6587\u4EF6\u5230\u5DF2\u5B58\u5728\u7684\u6587\u4EF6\u7684\u672B\u5C3E</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -appendToFile liubei.txt /sanguo/shuguo.txt</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>\u4ECEhdfs \u62F7\u8D1D\u5230\u672C\u5730</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -copyToLocal /sanguo/shuguo.txt ./downloadFile.txt</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u7B49\u540C\u4E8E<code>-get</code></p><h4 id="_2-\u5176\u4ED6\u64CD\u4F5C" tabindex="-1">2 \u5176\u4ED6\u64CD\u4F5C <a class="header-anchor" href="#_2-\u5176\u4ED6\u64CD\u4F5C" aria-hidden="true">#</a></h4><ul><li>list file</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -ls /sanguo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>\u663E\u793A\u6587\u4EF6\u5185\u5BB9</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -cat /sanguo/shuguo.txt</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>\u521B\u5EFA\u8DEF\u5F84</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -mkdir /jinguo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>\u4ECE HDFS \u7684\u4E00\u4E2A\u8DEF\u5F84\u62F7\u8D1D\u5230 HDFS \u7684\u53E6\u4E00\u4E2A\u8DEF\u5F84</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -cp /sanguo/shuguo.txt  /jinguo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>\u79FB\u52A8\u6587\u4EF6</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;"> hadoop fs -mv /sanguo/wuguo.txt /jinguo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>\u663E\u793A\u4E00\u4E2A\u6587\u4EF6\u7684\u672B\u5C3E 1kb \u7684\u6570\u636E</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop fs -tail /jinguo/shuguo.txt</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>\u5220\u9664\u6587\u4EF6\u6216\u6587\u4EF6\u5939</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;"> hadoop fs -rm /sanguo/shuguo.txt</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>\u9012\u5F52\u5220\u9664\u76EE\u5F55\u53CA\u76EE\u5F55\u91CC\u9762\u5185\u5BB9</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;"> hadoop fs -rm -r /sanguo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="hdfs\u7684\u5BA2\u6237\u7AEFapi" tabindex="-1">HDFS\u7684\u5BA2\u6237\u7AEFAPI <a class="header-anchor" href="#hdfs\u7684\u5BA2\u6237\u7AEFapi" aria-hidden="true">#</a></h2><h3 id="\u4F9D\u8D56" tabindex="-1">\u4F9D\u8D56 <a class="header-anchor" href="#\u4F9D\u8D56" aria-hidden="true">#</a></h3><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">project.hadoop.version</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">3.1.3</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">project.hadoop.version</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">org.apache.hadoop</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop-client</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">\${project.hadoop.version}</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="\u57FA\u7840\u914D\u7F6E" tabindex="-1">\u57FA\u7840\u914D\u7F6E <a class="header-anchor" href="#\u57FA\u7840\u914D\u7F6E" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> configuration </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#C792EA;">FileSystem</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Before</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">init</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 1 \u83B7\u53D6\u6587\u4EF6\u7CFB\u7EDF</span></span>
<span class="line"><span style="color:#A6ACCD;">    configuration </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URI</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://hadoop201:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> configuration</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">InterruptedException</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">URISyntaxException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">After</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 3 \u5173\u95ED\u8D44\u6E90</span></span>
<span class="line"><span style="color:#A6ACCD;">        fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="\u521B\u5EFA\u6587\u4EF6\u5939" tabindex="-1">\u521B\u5EFA\u6587\u4EF6\u5939 <a class="header-anchor" href="#\u521B\u5EFA\u6587\u4EF6\u5939" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u521B\u5EFA\u6587\u4EF6\u5939</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">testMkdir</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 2 \u521B\u5EFA\u76EE\u5F55</span></span>
<span class="line"><span style="color:#A6ACCD;">        fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mkdirs</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xiyou/huaguoshan/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="\u4E0A\u4F20\u6587\u4EF6" tabindex="-1">\u4E0A\u4F20\u6587\u4EF6 <a class="header-anchor" href="#\u4E0A\u4F20\u6587\u4EF6" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u4E0A\u4F20\u6587\u4EF6</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">put</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> filePath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">D:</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">IdeaExampleProjects</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">data-ware-house</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">hadoop</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">static</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">image</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">hadoop_0001.jpg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">copyFromLocalFile</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">filePath</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xiyou/huaguoshan</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/ff6e27eb8b8c463db7f400b0dae898c0.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u5C06 hdfs-site.xml \u62F7\u8D1D\u5230\u9879\u76EE\u7684 resources \u8D44\u6E90\u76EE\u5F55\u4E0B</p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml-stylesheet</span><span style="color:#C792EA;"> type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">text/xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">configuration.xsl</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">dfs.replication</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;"> 		</span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">1</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">property</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>\u53C2\u6570\u4F18\u5148\u7EA7\u6392\u5E8F\uFF1A\uFF081\uFF09\u5BA2\u6237\u7AEF\u4EE3\u7801\u4E2D\u8BBE\u7F6E\u7684\u503C <code>configuration.set(&quot;dfs.replication&quot;, &quot;2&quot;);</code> &gt;\uFF082\uFF09ClassPath \u4E0B\u7684\u7528\u6237\u81EA\u5B9A\u4E49\u914D\u7F6E\u6587 \u4EF6 &gt;\uFF083\uFF09\u7136\u540E\u662F\u670D\u52A1\u5668\u7684\u81EA\u5B9A\u4E49\u914D\u7F6E\uFF08xxx-site.xml\uFF09&gt;\uFF084\uFF09\u670D\u52A1\u5668\u7684\u9ED8\u8BA4\u914D\u7F6E\uFF08xxx-default.xml\uFF09</p><h3 id="\u4E0B\u8F7D\u6587\u4EF6" tabindex="-1">\u4E0B\u8F7D\u6587\u4EF6 <a class="header-anchor" href="#\u4E0B\u8F7D\u6587\u4EF6" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u6587\u4EF6\u4E0B\u8F7D</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">testGet</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">copyToLocalFile</span><span style="color:#89DDFF;">(false,</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xiyou/huaguoshan/hadoop_0001.jpg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">d:/sunwukong2.jpg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">true);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/c9219ee3ed134c198ee1b912b5f3f87c.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p><code>useRawLocalFileSystem</code>:\u662F\u5426\u5F00\u542F\u672C\u5730\u6587\u4EF6\u6821\u9A8C\u3002\u8BBE\u7F6E\u4E3Atrue\uFF0C\u4F1A\u751F\u6210\u4E00\u4E2A\u672C\u5730\u6587\u4EF6\uFF0C\u5373\u6587\u4EF6\u540D+.crc\u3002\u5C06\u6587\u4EF6\u52A0\u4E0A\u6821\u9A8C\u7801\uFF0C\u4F20\u8F93\u5230\u5BA2\u6237\u7AEF\uFF0C\u7136\u540E\u5728\u5BA2\u6237\u7AEF\u505ACRC\u52A0\u5BC6\u7B97\u6CD5\u8FDB\u884C\u6821\u9A8C\u3002</p><h3 id="\u5220\u9664\u6587\u4EF6" tabindex="-1">\u5220\u9664\u6587\u4EF6 <a class="header-anchor" href="#\u5220\u9664\u6587\u4EF6" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u6587\u4EF6\u5220\u9664</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">testDelete</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">delete</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xiyou/huaguoshan/hadoop_0002.png</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">                  </span><span style="color:#89DDFF;">true);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/8062cfdade4b4cc8814dc9a57a4abe1c.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h3 id="\u6587\u4EF6\u91CD\u547D\u540D\u548C\u79FB\u52A8" tabindex="-1">\u6587\u4EF6\u91CD\u547D\u540D\u548C\u79FB\u52A8 <a class="header-anchor" href="#\u6587\u4EF6\u91CD\u547D\u540D\u548C\u79FB\u52A8" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u6587\u4EF6\u66F4\u540D\u548C\u79FB\u52A8</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">testMove</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">rename</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xiyou/huaGuoshan/hadoop_0001.jpg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xiyou/huaguoshan/hadoop_0003.jpg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="\u6587\u4EF6\u8BE6\u60C5\u67E5\u770B" tabindex="-1">\u6587\u4EF6\u8BE6\u60C5\u67E5\u770B <a class="header-anchor" href="#\u6587\u4EF6\u8BE6\u60C5\u67E5\u770B" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u6587\u4EF6\u8BE6\u60C5\u67E5\u770B</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">testFileList</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">RemoteIterator</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">LocatedFileStatus</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> fileRemoteIterator </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listFiles</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xiyou</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">while</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">fileRemoteIterator</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">hasNext</span><span style="color:#89DDFF;">())</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">LocatedFileStatus</span><span style="color:#A6ACCD;"> fileStatus </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fileRemoteIterator</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">next</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">========{}=========</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getPath</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Permission: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getPermission</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Owner: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getOwner</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Group: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getGroup</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Len: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLen</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ModificationTime: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">                     fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getModificationTime</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Replication: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getReplication</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">BlockSize: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBlockSize</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">filePathName: {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">                     fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getPath</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">getName</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;">// \u83B7\u53D6\u5757\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">BlockLocation</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> blockLocations </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">                fileStatus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBlockLocations</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">            System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Arrays</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">blockLocations</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>\u7B2C\u4E8C\u4E2A\u53C2\u6570\u8868\u793A\u9012\u5F52</p><p><img src="https://img-blog.csdnimg.cn/9062239c79ee45adb18722034aca1809.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p><code>fileStatus.getBlockLocations() </code>\u8868\u793A\u6587\u4EF6\u7684\u5757\u4FE1\u606F</p><p><img src="https://img-blog.csdnimg.cn/c0501726a3ec4127a50ea8c73a79de60.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h2 id="hdfs\u8BFB\u5199\u6D41\u7A0B" tabindex="-1">HDFS\u8BFB\u5199\u6D41\u7A0B <a class="header-anchor" href="#hdfs\u8BFB\u5199\u6D41\u7A0B" aria-hidden="true">#</a></h2><h3 id="hdfs\u7684\u5199\u6570\u636E\u6D41\u7A0B" tabindex="-1">HDFS\u7684\u5199\u6570\u636E\u6D41\u7A0B <a class="header-anchor" href="#hdfs\u7684\u5199\u6570\u636E\u6D41\u7A0B" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/287d5cb9ebc644d693c9c0152fbf6bbe.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><ol><li>\u5BA2\u6237\u7AEF\u901A\u8FC7 Distributed FileSystem \u6A21\u5757\u5411 NameNode \u8BF7\u6C42\u4E0A\u4F20\u6587\u4EF6\uFF0CNameNode \u68C0\u67E5\u76EE\u6807\u6587\u4EF6\u662F\u5426\u5DF2\u5B58\u5728\uFF0C\u7236\u76EE\u5F55\u662F\u5426\u5B58\u5728\u3002</li><li>NameNode \u8FD4\u56DE\u662F\u5426\u53EF\u4EE5\u4E0A\u4F20\u3002</li><li>\u5BA2\u6237\u7AEF\u8BF7\u6C42\u7B2C\u4E00\u4E2A Block \u4E0A\u4F20\u5230\u54EA\u51E0\u4E2A DataNode \u670D\u52A1\u5668\u4E0A\u3002</li><li>NameNode \u8FD4\u56DE 3 \u4E2A DataNode \u8282\u70B9\uFF0C\u5206\u522B\u4E3A dn1\u3001dn2\u3001dn3\u3002</li><li>\u5BA2\u6237\u7AEF\u901A\u8FC7 FSDataOutputStream \u6A21\u5757\u8BF7\u6C42 dn1 \u4E0A\u4F20\u6570\u636E\uFF0Cdn1 \u6536\u5230\u8BF7\u6C42\u4F1A\u7EE7\u7EED\u8C03\u7528dn2\uFF0C\u7136\u540E dn2 \u8C03\u7528 dn3\uFF0C\u5C06\u8FD9\u4E2A\u901A\u4FE1\u7BA1\u9053\u5EFA\u7ACB\u5B8C\u6210\u3002</li><li>dn1\u3001dn2\u3001dn3 \u9010\u7EA7\u5E94\u7B54\u5BA2\u6237\u7AEF\u3002</li><li>\u5BA2\u6237\u7AEF\u5F00\u59CB\u5F80 dn1 \u4E0A\u4F20\u7B2C\u4E00\u4E2A Block\uFF08\u5148\u4ECE\u78C1\u76D8\u8BFB\u53D6\u6570\u636E\u653E\u5230\u4E00\u4E2A\u672C\u5730\u5185\u5B58\u7F13\u5B58\uFF09\uFF0C\u4EE5 Packet \u4E3A\u5355\u4F4D\uFF0Cdn1 \u6536\u5230\u4E00\u4E2A Packet \u5C31\u4F1A\u4F20\u7ED9 dn2\uFF0Cdn2 \u4F20\u7ED9 dn3\uFF1Bdn1 \u6BCF\u4F20\u4E00\u4E2A packet \u4F1A\u653E\u5165\u4E00\u4E2A\u5E94\u7B54\u961F\u5217\u7B49\u5F85\u5E94\u7B54\u3002</li><li>\u5F53\u4E00\u4E2A Block \u4F20\u8F93\u5B8C\u6210\u4E4B\u540E\uFF0C\u5BA2\u6237\u7AEF\u518D\u6B21\u8BF7\u6C42 NameNode \u4E0A\u4F20\u7B2C\u4E8C\u4E2A Block \u7684\u670D\u52A1\u5668\u3002\uFF08\u91CD\u590D\u6267\u884C 3-7 \u6B65\uFF09\u3002</li></ol><h4 id="\u7F51\u7EDC\u62D3\u6251-\u8282\u70B9\u8DDD\u79BB\u8BA1\u7B97" tabindex="-1">\u7F51\u7EDC\u62D3\u6251-\u8282\u70B9\u8DDD\u79BB\u8BA1\u7B97 <a class="header-anchor" href="#\u7F51\u7EDC\u62D3\u6251-\u8282\u70B9\u8DDD\u79BB\u8BA1\u7B97" aria-hidden="true">#</a></h4><p>\u8282\u70B9\u8DDD\u79BB\uFF1A\u4E24\u4E2A\u8282\u70B9\u5230\u8FBE\u6700\u8FD1\u7684\u5171\u540C\u7956\u5148\u7684\u8DDD\u79BB\u603B\u548C\u3002</p><p><img src="https://img-blog.csdnimg.cn/1f9fbe1830724becb1a2f3b6283dacfb.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h4 id="\u526F\u672C\u8282\u70B9\u9009\u62E9" tabindex="-1">\u526F\u672C\u8282\u70B9\u9009\u62E9 <a class="header-anchor" href="#\u526F\u672C\u8282\u70B9\u9009\u62E9" aria-hidden="true">#</a></h4><blockquote><p>For the common case, when the replication factor is three, HDFS\u2019s placement policy is to <strong>put one replica on the local machine</strong> if the writer is on a datanode, otherwise on a random datanode, <strong>another replica on a node in a different (remote) rack</strong>, and <strong>the last on a different node in the same remote rack</strong>. This policy cuts the inter-rack write traffic which generally improves write performance. The chance of rack failure is far less than that of node failure; this policy does not impact data reliability and availability guarantees. However, it does reduce the aggregate network bandwidth used when reading data since a block is placed in only two unique racks rather than three. With this policy, the replicas of a file do not evenly distribute across the racks. One third of replicas are on one node, two thirds of replicas are on one rack, and the other third are evenly distributed across the remaining racks. This policy improves write performance without compromising data reliability or read performance.</p></blockquote><p><img src="https://img-blog.csdnimg.cn/a727f77317f446c5a3736bddedbb2e1c.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u7B2C\u4E00\u4E2A\u673A\u67B6\u9009\u62E9\u6700\u8FD1\u4E0A\u4F20\u901F\u5EA6\u6700\u5FEB\uFF0C\u7B2C\u4E8C\u4E2A\u9009\u62E9\u9694\u58C1\u4FDD\u8BC1\u53EF\u9760\u6027\uFF0C\u7B2C\u4E09\u4E2A\u518D\u6B21\u517C\u987E\u6548\u7387\u9009\u62E9\u540C\u673A\u67B6\u4E0A\u4E0D\u540C\u8282\u70B9\u3002</p><p><strong>\u6E90\u7801\u8BF4\u660E</strong></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">org.apache.hadoop</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">hadoop-hdfs</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">\${project.hadoop.version}</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>BlockPlacementPolicyDefault.chooseTargetInOrder</code></p><p><img src="https://img-blog.csdnimg.cn/6b1f70a7634145f2aee6a925baf913ea.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p><img src="https://img-blog.csdnimg.cn/d8abe72746954b24aa26be309d303420.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h3 id="hdfs\u7684\u8BFB\u6570\u636E\u6D41\u7A0B" tabindex="-1">HDFS\u7684\u8BFB\u6570\u636E\u6D41\u7A0B <a class="header-anchor" href="#hdfs\u7684\u8BFB\u6570\u636E\u6D41\u7A0B" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/8ae7b3aaf5644411bb08a8a2da143868.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><ol><li>\u5BA2\u6237\u7AEF\u901A\u8FC7 DistributedFileSystem \u5411 NameNode \u8BF7\u6C42\u4E0B\u8F7D\u6587\u4EF6\uFF0CNameNode \u901A\u8FC7\u67E5\u8BE2\u5143\u6570\u636E\uFF0C\u627E\u5230\u6587\u4EF6\u5757\u6240\u5728\u7684 DataNode \u5730\u5740\u3002</li><li>\u6311\u9009\u4E00\u53F0 DataNode\uFF08\u5C31\u8FD1\u539F\u5219\uFF0C\u7136\u540E\u968F\u673A\uFF09\u670D\u52A1\u5668\uFF0C\u8BF7\u6C42\u8BFB\u53D6\u6570\u636E\u3002</li><li>DataNode \u5F00\u59CB\u4F20\u8F93\u6570\u636E\u7ED9\u5BA2\u6237\u7AEF\uFF08\u4ECE\u78C1\u76D8\u91CC\u9762\u8BFB\u53D6\u6570\u636E\u8F93\u5165\u6D41\uFF0C\u4EE5 Packet \u4E3A\u5355\u4F4D\u6765\u505A\u6821\u9A8C\uFF09\u3002</li><li>\u5BA2\u6237\u7AEF\u4EE5 Packet \u4E3A\u5355\u4F4D\u63A5\u6536\uFF0C\u5148\u5728\u672C\u5730\u7F13\u5B58\uFF0C\u7136\u540E\u5199\u5165\u76EE\u6807\u6587\u4EF6\u3002</li></ol><p>\u6CE8\u610F\uFF1A\u5728\u8BFB\u53D6block\u6570\u636E\u7684\u65F6\u5019\u662F\u4E32\u884C\u8BFB\u3002</p><h2 id="nn\u548C2nn\u5DE5\u4F5C\u539F\u7406" tabindex="-1">NN\u548C2NN\u5DE5\u4F5C\u539F\u7406 <a class="header-anchor" href="#nn\u548C2nn\u5DE5\u4F5C\u539F\u7406" aria-hidden="true">#</a></h2><h3 id="\u5DE5\u4F5C\u673A\u5236" tabindex="-1">\u5DE5\u4F5C\u673A\u5236 <a class="header-anchor" href="#\u5DE5\u4F5C\u673A\u5236" aria-hidden="true">#</a></h3><p>NameNode\u7684\u5143\u6570\u636E\u5B58\u50A8\u5728\u5185\u5B58\u8FD8\u662F\u78C1\u76D8\u4E2D\uFF1F\u5982\u679C\u5B58\u50A8\u5728 NameNode \u8282\u70B9\u7684\u78C1\u76D8\u4E2D\uFF0C\u56E0\u4E3A\u7ECF\u5E38\u9700\u8981\u8FDB\u884C\u968F\u673A\u8BBF\u95EE\uFF0C\u8FD8\u6709\u54CD\u5E94\u5BA2\u6237\u8BF7\u6C42\uFF0C\u5FC5\u7136\u662F\u6548\u7387\u8FC7\u4F4E\u3002\u56E0\u6B64\uFF0C\u5143\u6570\u636E\u9700\u8981\u5B58\u653E\u5728\u5185\u5B58\u4E2D\u3002\u4F46\u5982\u679C\u53EA\u5B58\u5728\u5185\u5B58\u4E2D\uFF0C\u4E00\u65E6\u65AD\u7535\uFF0C\u5143\u6570\u636E\u4E22\u5931\uFF0C\u6574\u4E2A\u96C6\u7FA4\u5C31\u65E0\u6CD5\u5DE5\u4F5C\u4E86\u3002\u56E0\u6B64\u4EA7\u751F\u5728\u78C1\u76D8\u4E2D\u5907\u4EFD\u5143\u6570\u636E\u7684 FsImage\u3002</p><p>\u8FD9\u6837\u53C8\u4F1A\u5E26\u6765\u65B0\u7684\u95EE\u9898\uFF0C\u5F53\u5728\u5185\u5B58\u4E2D\u7684\u5143\u6570\u636E\u66F4\u65B0\u65F6\uFF0C\u5982\u679C\u540C\u65F6\u66F4\u65B0 FsImage\uFF0C\u5C31\u4F1A\u5BFC\u81F4\u6548\u7387\u8FC7\u4F4E\uFF0C\u4F46\u5982\u679C\u4E0D\u66F4\u65B0\uFF0C\u5C31\u4F1A\u53D1\u751F\u4E00\u81F4\u6027\u95EE\u9898\uFF0C\u4E00\u65E6 NameNode \u8282\u70B9\u65AD\u7535\uFF0C\u5C31\u4F1A\u4EA7\u751F\u6570\u636E\u4E22\u5931\u3002\u56E0\u6B64\uFF0C\u5F15\u5165 Edits \u6587\u4EF6\uFF08\u53EA\u8FDB\u884C\u8FFD\u52A0\u64CD\u4F5C\uFF0C\u6548\u7387\u5F88\u9AD8\uFF09\u3002\u6BCF\u5F53\u5143\u6570\u636E\u6709\u66F4\u65B0\u6216\u8005\u6DFB\u52A0\u5143\u6570\u636E\u65F6\uFF0C\u4FEE\u6539\u5185\u5B58\u4E2D\u7684\u5143\u6570\u636E\u5E76\u8FFD\u52A0\u5230 Edits \u4E2D\u3002\u8FD9\u6837\uFF0C\u4E00\u65E6 NameNode \u8282\u70B9\u65AD\u7535\uFF0C\u53EF\u4EE5\u901A\u8FC7 FsImage \u548C Edits \u7684\u5408\u5E76\uFF0C\u5408\u6210\u5143\u6570\u636E\u3002</p><p>\u4F46\u662F\uFF0C\u5982\u679C\u957F\u65F6\u95F4\u6DFB\u52A0\u6570\u636E\u5230 Edits \u4E2D\uFF0C\u4F1A\u5BFC\u81F4\u8BE5\u6587\u4EF6\u6570\u636E\u8FC7\u5927\uFF0C\u6548\u7387\u964D\u4F4E\uFF0C\u800C\u4E14\u4E00\u65E6\u65AD\u7535\uFF0C\u6062\u590D\u5143\u6570\u636E\u9700\u8981\u7684\u65F6\u95F4\u8FC7\u957F\u3002\u56E0\u6B64\uFF0C\u9700\u8981\u5B9A\u671F\u8FDB\u884C FsImage \u548C Edits \u7684\u5408\u5E76\uFF0C\u5982\u679C\u8FD9\u4E2A\u64CD\u4F5C\u7531NameNode\u8282\u70B9\u5B8C\u6210\uFF0C\u53C8\u4F1A\u6548\u7387\u8FC7\u4F4E\u3002\u56E0\u6B64\uFF0C\u5F15\u5165\u4E00\u4E2A\u65B0\u7684\u8282\u70B9SecondaryNamenode\uFF0C\u4E13\u95E8\u7528\u4E8E FsImage \u548C Edits \u7684\u5408\u5E76\u3002</p><p><img src="https://img-blog.csdnimg.cn/007ba5160c074fc19efd6e7388e57f6a.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><ul><li>\u7B2C\u4E00\u9636\u6BB5\uFF1ANameNode \u542F\u52A8 <ol><li>\u7B2C\u4E00\u6B21\u542F\u52A8 NameNode \u683C\u5F0F\u5316\u540E\uFF0C\u521B\u5EFA Fsimage \u548C Edits \u6587\u4EF6\u3002\u5982\u679C\u4E0D\u662F\u7B2C\u4E00\u6B21\u542F\u52A8\uFF0C\u76F4\u63A5\u52A0\u8F7D\u7F16\u8F91\u65E5\u5FD7\u548C\u955C\u50CF\u6587\u4EF6\u5230\u5185\u5B58\u3002</li><li>\u5BA2\u6237\u7AEF\u5BF9\u5143\u6570\u636E\u8FDB\u884C\u589E\u5220\u6539\u7684\u8BF7\u6C42\u3002</li><li>NameNode \u8BB0\u5F55\u64CD\u4F5C\u65E5\u5FD7\uFF0C\u66F4\u65B0\u6EDA\u52A8\u65E5\u5FD7\u3002</li><li>NameNode \u5728\u5185\u5B58\u4E2D\u5BF9\u5143\u6570\u636E\u8FDB\u884C\u589E\u5220\u6539\u3002</li></ol></li><li>\u7B2C\u4E8C\u9636\u6BB5\uFF1ASecondary NameNode \u5DE5\u4F5C <ol><li>Secondary NameNode \u8BE2\u95EE NameNode \u662F\u5426\u9700\u8981 CheckPoint\u3002\u76F4\u63A5\u5E26\u56DE NameNode \u662F\u5426\u68C0\u67E5\u7ED3\u679C\u3002</li><li>Secondary NameNode \u8BF7\u6C42\u6267\u884C CheckPoint\u3002</li><li>NameNode \u6EDA\u52A8\u6B63\u5728\u5199\u7684 Edits \u65E5\u5FD7\u3002</li><li>\u5C06\u6EDA\u52A8\u524D\u7684\u7F16\u8F91\u65E5\u5FD7\u548C\u955C\u50CF\u6587\u4EF6\u62F7\u8D1D\u5230 Secondary NameNode</li><li>Secondary NameNode \u52A0\u8F7D\u7F16\u8F91\u65E5\u5FD7\u548C\u955C\u50CF\u6587\u4EF6\u5230\u5185\u5B58\uFF0C\u5E76\u5408\u5E76\u3002</li><li>\u751F\u6210\u65B0\u7684\u955C\u50CF\u6587\u4EF6 fsimage.chkpoint\u3002</li><li>\u62F7\u8D1D fsimage.chkpoint \u5230 NameNode\u3002</li><li>NameNode \u5C06 fsimage.chkpoint \u91CD\u65B0\u547D\u540D\u6210 fsimage\u3002</li></ol></li></ul><h3 id="fsimage\u548Cedits\u89E3\u6790" tabindex="-1">Fsimage\u548CEdits\u89E3\u6790 <a class="header-anchor" href="#fsimage\u548Cedits\u89E3\u6790" aria-hidden="true">#</a></h3><p>NameNode\u88AB\u683C\u5F0F\u5316\u4E4B\u540E\uFF0C\u5C06\u5728/opt/module/hadoop-3.1.3/data/tmp/dfs/name/current \u76EE\u5F55\u4E2D\u4EA7\u751F\u5982\u4E0B\u6587\u4EF6 \uFF081\uFF09Fsimage\u6587\u4EF6\uFF1AHDFS\u6587\u4EF6\u7CFB\u7EDF\u5143\u6570\u636E\u7684\u4E00\u4E2A\u6C38\u4E45\u6027\u7684\u68C0\u67E5\u70B9\uFF0C\u5176\u4E2D\u5305\u542BHDFS\u6587\u4EF6\u7CFB\u7EDF\u7684\u6240\u6709\u76EE\u5F55\u548C\u6587\u4EF6inode\u7684\u5E8F\u5217\u5316\u4FE1\u606F\u3002</p><p>\uFF082\uFF09Edits\u6587\u4EF6\uFF1A\u5B58\u653EHDFS\u6587\u4EF6\u7CFB\u7EDF\u7684\u6240\u6709\u66F4\u65B0\u64CD\u4F5C\u7684\u8DEF\u5F84\uFF0C\u6587\u4EF6\u7CFB\u7EDF\u5BA2\u6237\u7AEF\u6267\u884C\u7684\u6240\u6709\u5199\u64CD\u4F5C\u9996\u5148\u4F1A\u88AB\u8BB0\u5F55\u5230Edits\u6587\u4EF6\u4E2D\u3002</p><p>\uFF083\uFF09seen_txid\u6587\u4EF6\u4FDD\u5B58\u7684\u662F\u4E00\u4E2A\u6570\u5B57\uFF0C\u5C31\u662F\u6700\u540E\u4E00\u4E2Aedits_\u7684\u6570\u5B57\u3002 \uFF084\uFF09\u6BCF \u6B21NameNode\u542F\u52A8\u7684\u65F6\u5019\u90FD\u4F1A\u5C06Fsimage\u6587\u4EF6\u8BFB\u5165\u5185\u5B58\uFF0C\u52A0 \u8F7DEdits\u91CC\u9762\u7684\u66F4\u65B0\u64CD\u4F5C\uFF0C\u4FDD\u8BC1\u5185\u5B58\u4E2D\u7684\u5143\u6570\u636E\u4FE1\u606F\u662F\u6700\u65B0\u7684\u3001\u540C\u6B65\u7684\uFF0C\u53EF\u4EE5\u770B\u6210NameNode\u542F\u52A8\u7684\u65F6\u5019\u5C31\u5C06Fsimage\u548CEdits\u6587\u4EF6\u8FDB\u884C\u4E86\u5408\u5E76\u3002</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hdfs oiv -p XML -i fsimage_0000000000000000025 -o /home/fsimage.xml</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">hdfs oev -p XML -i edits_0000000000000000012-0000000000000000013 -o /home/edits.xml</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="datanode\u5DE5\u4F5C\u673A\u5236" tabindex="-1">DataNode\u5DE5\u4F5C\u673A\u5236 <a class="header-anchor" href="#datanode\u5DE5\u4F5C\u673A\u5236" aria-hidden="true">#</a></h2><p><img src="https://img-blog.csdnimg.cn/563c0646f34e4aa6999342f7fb7e1ef9.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><ol><li>\u4E00\u4E2A\u6570\u636E\u5757\u5728 DataNode \u4E0A\u4EE5\u6587\u4EF6\u5F62\u5F0F\u5B58\u50A8\u5728\u78C1\u76D8\u4E0A\uFF0C\u5305\u62EC\u4E24\u4E2A\u6587\u4EF6\uFF0C\u4E00\u4E2A\u662F\u6570\u636E\u672C\u8EAB\uFF0C\u4E00\u4E2A\u662F\u5143\u6570\u636E\u5305\u62EC\u6570\u636E\u5757\u7684\u957F\u5EA6\uFF0C\u5757\u6570\u636E\u7684\u6821\u9A8C\u548C\uFF0C\u4EE5\u53CA\u65F6\u95F4\u6233\u3002</li><li>DataNode \u542F\u52A8\u540E\u5411 NameNode \u6CE8\u518C\uFF0C\u901A\u8FC7\u540E\uFF0C\u5468\u671F\u6027\uFF086 \u5C0F\u65F6\uFF09\u7684\u5411 NameNode \u4E0A\u62A5\u6240\u6709\u7684\u5757\u4FE1\u606F\u3002</li><li>\u5FC3\u8DF3\u662F\u6BCF 3 \u79D2\u4E00\u6B21\uFF0C\u5FC3\u8DF3\u8FD4\u56DE\u7ED3\u679C\u5E26\u6709 NameNode \u7ED9\u8BE5 DataNode \u7684\u547D\u4EE4\u5982\u590D\u5236\u5757\u6570\u636E\u5230\u53E6\u4E00\u53F0\u673A\u5668\uFF0C\u6216\u5220\u9664\u67D0\u4E2A\u6570\u636E\u5757\u3002\u5982\u679C\u8D85\u8FC7 10 \u5206\u949F\u6CA1\u6709\u6536\u5230\u67D0\u4E2A DataNode \u7684\u5FC3\u8DF3\uFF0C\u5219\u8BA4\u4E3A\u8BE5\u8282\u70B9\u4E0D\u53EF\u7528\u3002</li><li>\u96C6\u7FA4\u8FD0\u884C\u4E2D\u53EF\u4EE5\u5B89\u5168\u52A0\u5165\u548C\u9000\u51FA\u4E00\u4E9B\u673A\u5668\u3002</li></ol><h1 id="mapreduce" tabindex="-1">MapReduce <a class="header-anchor" href="#mapreduce" aria-hidden="true">#</a></h1><h2 id="mapreduce-\u6982\u8FF0" tabindex="-1">MapReduce \u6982\u8FF0 <a class="header-anchor" href="#mapreduce-\u6982\u8FF0" aria-hidden="true">#</a></h2><h3 id="mapreduce-\u5B9A\u4E49" tabindex="-1">MapReduce \u5B9A\u4E49 <a class="header-anchor" href="#mapreduce-\u5B9A\u4E49" aria-hidden="true">#</a></h3><p>MapReduce \u662F\u4E00\u4E2A<strong>\u5206\u5E03\u5F0F\u8FD0\u7B97\u7A0B\u5E8F</strong>\u7684\u7F16\u7A0B\u6846\u67B6\uFF0C\u662F\u7528\u6237\u5F00\u53D1\u201C\u57FA\u4E8E Hadoop \u7684\u6570\u636E\u5206\u6790\u5E94\u7528\u201D\u7684\u6838\u5FC3\u6846\u67B6\u3002MapReduce \u6838\u5FC3\u529F\u80FD\u662F\u5C06<strong>\u7528\u6237\u7F16\u5199\u7684\u4E1A\u52A1\u903B\u8F91\u4EE3\u7801\u548C\u81EA\u5E26\u9ED8\u8BA4\u7EC4\u4EF6</strong>\u6574\u5408\u6210\u4E00\u4E2A\u5B8C\u6574\u7684<strong>\u5206\u5E03\u5F0F\u8FD0\u7B97\u7A0B\u5E8F</strong>\uFF0C\u5E76\u53D1\u8FD0\u884C\u5728\u4E00\u4E2A Hadoop \u96C6\u7FA4\u4E0A\u3002</p><h3 id="mapreduce-\u4F18\u7F3A\u70B9" tabindex="-1">MapReduce \u4F18\u7F3A\u70B9 <a class="header-anchor" href="#mapreduce-\u4F18\u7F3A\u70B9" aria-hidden="true">#</a></h3><h4 id="\u4F18\u70B9" tabindex="-1">\u4F18\u70B9 <a class="header-anchor" href="#\u4F18\u70B9" aria-hidden="true">#</a></h4><ul><li>MapReduce \u6613\u4E8E\u7F16\u7A0B</li></ul><p><strong>\u5B83\u7B80\u5355\u7684\u5B9E\u73B0\u4E00\u4E9B\u63A5\u53E3\uFF0C\u5C31\u53EF\u4EE5\u5B8C\u6210\u4E00\u4E2A\u5206\u5E03\u5F0F\u7A0B\u5E8F</strong>\uFF0C\u8FD9\u4E2A\u5206\u5E03\u5F0F\u7A0B\u5E8F\u53EF\u4EE5\u5206\u5E03\u5230\u5927\u91CF\u5EC9\u4EF7\u7684 PC \u673A\u5668\u4E0A\u8FD0\u884C\u3002\u4E5F\u5C31\u662F\u8BF4\u4F60\u5199\u4E00\u4E2A\u5206\u5E03\u5F0F\u7A0B\u5E8F\uFF0C\u8DDF\u5199\u4E00\u4E2A\u7B80\u5355\u7684\u4E32\u884C\u7A0B\u5E8F\u662F\u4E00\u6A21\u4E00\u6837\u7684\u3002\u5C31\u662F\u56E0\u4E3A\u8FD9\u4E2A\u7279\u70B9\u4F7F\u5F97 MapReduce \u7F16\u7A0B\u53D8\u5F97\u975E\u5E38\u6D41\u884C\u3002</p><ul><li>\u826F\u597D\u7684\u6269\u5C55\u6027</li></ul><p>\u5F53\u4F60\u7684\u8BA1\u7B97\u8D44\u6E90\u4E0D\u80FD\u5F97\u5230\u6EE1\u8DB3\u7684\u65F6\u5019\uFF0C\u4F60\u53EF\u4EE5\u901A\u8FC7<strong>\u7B80\u5355\u7684\u589E\u52A0\u673A\u5668</strong>\u6765\u6269\u5C55\u5B83\u7684\u8BA1\u7B97\u80FD\u529B\u3002</p><ul><li>\u9AD8\u5BB9\u9519\u6027</li></ul><p>MapReduce \u8BBE\u8BA1\u7684\u521D\u8877\u5C31\u662F\u4F7F\u7A0B\u5E8F\u80FD\u591F\u90E8\u7F72\u5728\u5EC9\u4EF7\u7684 PC \u673A\u5668\u4E0A\uFF0C\u8FD9\u5C31\u8981\u6C42\u5B83\u5177\u6709\u5F88\u9AD8\u7684\u5BB9\u9519\u6027\u3002\u6BD4\u5982<strong>\u5176\u4E2D\u4E00\u53F0\u673A\u5668\u6302\u4E86\uFF0C\u5B83\u53EF\u4EE5\u628A\u4E0A\u9762\u7684\u8BA1\u7B97\u4EFB\u52A1\u8F6C\u79FB\u5230\u53E6\u5916\u4E00\u4E2A\u8282\u70B9\u4E0A\u8FD0\u884C\uFF0C\u4E0D\u81F3\u4E8E\u8FD9\u4E2A\u4EFB\u52A1\u8FD0\u884C\u5931\u8D25</strong>\uFF0C\u800C\u4E14\u8FD9\u4E2A\u8FC7\u7A0B\u4E0D\u9700\u8981\u4EBA\u5DE5\u53C2\u4E0E\uFF0C\u800C\u5B8C\u5168\u662F\u7531 Hadoop \u5185\u90E8\u5B8C\u6210\u7684\u3002</p><ul><li>\u9002\u5408 PB \u7EA7\u4EE5\u4E0A\u6D77\u91CF\u6570\u636E\u7684\u79BB\u7EBF\u5904\u7406</li></ul><p>\u53EF\u4EE5\u5B9E\u73B0\u4E0A\u5343\u53F0\u670D\u52A1\u5668\u96C6\u7FA4\u5E76\u53D1\u5DE5\u4F5C\uFF0C\u63D0\u4F9B\u6570\u636E\u5904\u7406\u80FD\u529B\u3002</p><h4 id="\u7F3A\u70B9" tabindex="-1">\u7F3A\u70B9 <a class="header-anchor" href="#\u7F3A\u70B9" aria-hidden="true">#</a></h4><ul><li>\u4E0D\u64C5\u957F\u5B9E\u65F6\u8BA1\u7B97</li></ul><p>MapReduce \u65E0\u6CD5\u50CF MySQL \u4E00\u6837\uFF0C\u5728\u6BEB\u79D2\u6216\u8005\u79D2\u7EA7\u5185\u8FD4\u56DE\u7ED3\u679C\u3002</p><ul><li>\u4E0D\u64C5\u957F\u6D41\u5F0F\u8BA1\u7B97</li></ul><p>\u6D41\u5F0F\u8BA1\u7B97\u7684\u8F93\u5165\u6570\u636E\u662F\u52A8\u6001\u7684\uFF0C\u800C MapReduce \u7684<strong>\u8F93\u5165\u6570\u636E\u96C6\u662F\u9759\u6001\u7684</strong>\uFF0C\u4E0D\u80FD\u52A8\u6001\u53D8\u5316\u3002\u8FD9\u662F\u56E0\u4E3A MapReduce \u81EA\u8EAB\u7684\u8BBE\u8BA1\u7279\u70B9\u51B3\u5B9A\u4E86\u6570\u636E\u6E90\u5FC5\u987B\u662F\u9759\u6001\u7684\u3002</p><ul><li>\u4E0D\u64C5\u957F DAG\uFF08\u6709\u5411\u65E0\u73AF\u56FE\uFF09\u8BA1\u7B97</li></ul><p>\u591A\u4E2A\u5E94\u7528\u7A0B\u5E8F\u5B58\u5728\u4F9D\u8D56\u5173\u7CFB\uFF0C\u540E\u4E00\u4E2A\u5E94\u7528\u7A0B\u5E8F\u7684\u8F93\u5165\u4E3A\u524D\u4E00\u4E2A\u7684\u8F93\u51FA\u3002\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0CMapReduce \u5E76\u4E0D\u662F\u4E0D\u80FD\u505A\uFF0C\u800C\u662F\u4F7F\u7528\u540E\uFF0C<strong>\u6BCF\u4E2A MapReduce \u4F5C\u4E1A\u7684\u8F93\u51FA\u7ED3\u679C\u90FD\u4F1A\u5199\u5165\u5230\u78C1\u76D8\uFF0C\u4F1A\u9020\u6210\u5927\u91CF\u7684\u78C1\u76D8 IO\uFF0C\u5BFC\u81F4\u6027\u80FD\u975E\u5E38\u7684\u4F4E\u4E0B</strong>\u3002</p><h3 id="mapreduce-\u6838\u5FC3\u601D\u60F3" tabindex="-1">MapReduce \u6838\u5FC3\u601D\u60F3 <a class="header-anchor" href="#mapreduce-\u6838\u5FC3\u601D\u60F3" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/8feec7754e67411abedb920d6b45f309.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><ul><li>\u5206\u5E03\u5F0F\u7684\u8FD0\u7B97\u7A0B\u5E8F\u5F80\u5F80\u9700\u8981\u5206\u6210\u81F3\u5C11 2 \u4E2A\u9636\u6BB5\u3002</li><li>\u7B2C\u4E00\u4E2A\u9636\u6BB5\u7684 MapTask \u5E76\u53D1\u5B9E\u4F8B\uFF0C\u5B8C\u5168\u5E76\u884C\u8FD0\u884C\uFF0C\u4E92\u4E0D\u76F8\u5E72\u3002</li><li>\u7B2C\u4E8C\u4E2A\u9636\u6BB5\u7684 ReduceTask \u5E76\u53D1\u5B9E\u4F8B\u4E92\u4E0D\u76F8\u5E72\uFF0C\u4F46\u662F\u4ED6\u4EEC\u7684\u6570\u636E\u4F9D\u8D56\u4E8E\u4E0A\u4E00\u4E2A\u9636\u6BB5\u7684\u6240\u6709 MapTask \u5E76\u53D1\u5B9E\u4F8B\u7684\u8F93\u51FA\u3002</li><li>MapReduce \u7F16\u7A0B\u6A21\u578B\u53EA\u80FD\u5305\u542B\u4E00\u4E2A Map \u9636\u6BB5\u548C\u4E00\u4E2A Reduce \u9636\u6BB5\uFF0C\u5982\u679C\u7528\u6237\u7684\u4E1A\u52A1\u903B\u8F91\u975E\u5E38\u590D\u6742\uFF0C\u90A3\u5C31\u53EA\u80FD\u591A\u4E2A MapReduce \u7A0B\u5E8F\uFF0C\u4E32\u884C\u8FD0\u884C\u3002</li></ul><h3 id="mapreduce-\u8FDB\u7A0B" tabindex="-1">MapReduce \u8FDB\u7A0B <a class="header-anchor" href="#mapreduce-\u8FDB\u7A0B" aria-hidden="true">#</a></h3><p>\u4E00\u4E2A\u5B8C\u6574\u7684 MapReduce \u7A0B\u5E8F\u5728\u5206\u5E03\u5F0F\u8FD0\u884C\u65F6\u6709\u4E09\u7C7B\u5B9E\u4F8B\u8FDB\u7A0B\uFF1A</p><ul><li>MrAppMaster\uFF1A\u8D1F\u8D23\u6574\u4E2A\u7A0B\u5E8F\u7684\u8FC7\u7A0B\u8C03\u5EA6\u53CA\u72B6\u6001\u534F\u8C03\u3002</li><li>MapTask\uFF1A\u8D1F\u8D23 Map \u9636\u6BB5\u7684\u6574\u4E2A\u6570\u636E\u5904\u7406\u6D41\u7A0B\u3002</li><li>ReduceTask\uFF1A\u8D1F\u8D23 Reduce \u9636\u6BB5\u7684\u6574\u4E2A\u6570\u636E\u5904\u7406\u6D41\u7A0B\u3002</li></ul><h3 id="\u5B98\u65B9-wordcount-\u6E90\u7801" tabindex="-1">\u5B98\u65B9 WordCount \u6E90\u7801 <a class="header-anchor" href="#\u5B98\u65B9-wordcount-\u6E90\u7801" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:center;">Java \u7C7B\u578B</th><th style="text-align:center;">Hadoop Writable \u7C7B\u578B</th></tr></thead><tbody><tr><td style="text-align:center;">Boolean</td><td style="text-align:center;">BooleanWritable</td></tr><tr><td style="text-align:center;">Byte</td><td style="text-align:center;">ByteWritable</td></tr><tr><td style="text-align:center;">Int</td><td style="text-align:center;">IntWritable</td></tr><tr><td style="text-align:center;">Float</td><td style="text-align:center;">FloatWritable</td></tr><tr><td style="text-align:center;">Long</td><td style="text-align:center;">LongWritable</td></tr><tr><td style="text-align:center;">Double</td><td style="text-align:center;">DoubleWritable</td></tr><tr><td style="text-align:center;">String</td><td style="text-align:center;">Text</td></tr><tr><td style="text-align:center;">Map</td><td style="text-align:center;">MapWritable</td></tr><tr><td style="text-align:center;">Array</td><td style="text-align:center;">ArrayWritable</td></tr><tr><td style="text-align:center;">Null</td><td style="text-align:center;">NullWritable</td></tr></tbody></table><h3 id="mapreduce-\u7F16\u7A0B\u89C4\u8303" tabindex="-1">MapReduce \u7F16\u7A0B\u89C4\u8303 <a class="header-anchor" href="#mapreduce-\u7F16\u7A0B\u89C4\u8303" aria-hidden="true">#</a></h3><p>\u7528\u6237\u7F16\u5199\u7684\u7A0B\u5E8F\u5206\u6210\u4E09\u4E2A\u90E8\u5206\uFF1AMapper\u3001Reducer \u548C Driver\u3002</p><p>1\uFF0EMapper\u9636\u6BB5</p><ul><li>\u7528\u6237\u81EA\u5B9A\u4E49\u7684Mapper\u8981\u7EE7\u627F\u81EA\u5DF1\u7684\u7236\u7C7B</li><li>Mapper\u7684\u8F93\u5165\u6570\u636E\u662FKV\u5BF9\u7684\u5F62\u5F0F\uFF08KV\u7684\u7C7B\u578B\u53EF\u81EA\u5B9A\u4E49\uFF09</li><li>Mapper\u4E2D\u7684\u4E1A\u52A1\u903B\u8F91\u5199\u5728map()\u65B9\u6CD5\u4E2D</li><li>Mapper\u7684\u8F93\u51FA\u6570\u636E\u662FKV\u5BF9\u7684\u5F62\u5F0F\uFF08KV\u7684\u7C7B\u578B\u53EF\u81EA\u5B9A\u4E49\uFF09</li><li>map()\u65B9\u6CD5\uFF08MapTask\u8FDB\u7A0B\uFF09\u5BF9\u6BCF\u4E00\u4E2A\u8C03\u7528\u4E00\u6B21</li></ul><p>2\uFF0EReducer\u9636\u6BB5</p><ul><li>\u7528\u6237\u81EA\u5B9A\u4E49\u7684Reducer\u8981\u7EE7\u627F\u81EA\u5DF1\u7684\u7236\u7C7B</li><li>Reducer\u7684\u8F93\u5165\u6570\u636E\u7C7B\u578B\u5BF9\u5E94Mapper\u7684\u8F93\u51FA\u6570\u636E\u7C7B\u578B\uFF0C\u4E5F\u662FKV</li><li>Reducer\u7684\u4E1A\u52A1\u903B\u8F91\u5199\u5728reduce()\u65B9\u6CD5\u4E2D</li><li>ReduceTask\u8FDB\u7A0B\u5BF9\u6BCF\u4E00\u7EC4\u76F8\u540Ck\u7684\u7EC4\u8C03\u7528\u4E00\u6B21reduce()\u65B9\u6CD5</li></ul><p>3\uFF0EDriver\u9636\u6BB5 \u76F8\u5F53\u4E8EYARN\u96C6\u7FA4\u7684\u5BA2\u6237\u7AEF\uFF0C\u7528\u4E8E\u63D0\u4EA4\u6211\u4EEC\u6574\u4E2A\u7A0B\u5E8F\u5230YARN\u96C6\u7FA4\uFF0C\u63D0\u4EA4\u7684\u662F\u5C01\u88C5\u4E86MapReduce\u7A0B\u5E8F\u76F8\u5173\u8FD0\u884C\u53C2\u6570\u7684job\u5BF9\u8C61</p><h4 id="mapper" tabindex="-1">Mapper <a class="header-anchor" href="#mapper" aria-hidden="true">#</a></h4><p>\u7EE7\u627F<code>org.apache.hadoop.mapreduce.Mapper</code></p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">package</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">mapreduce</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">IOException</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">classification</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">InterfaceAudience</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">classification</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">InterfaceStability</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">conf</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Configuration</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">RawComparator</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">compress</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">CompressionCodec</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">mapreduce</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">task</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">MapContextImpl</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">InterfaceAudience</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Public</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">InterfaceStability</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Stable</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Mapper</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">KEYIN</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">VALUEIN</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">KEYOUT</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">VALUEOUT</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">abstract</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Context</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">implements</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MapContext</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">KEYIN</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">VALUEIN</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">KEYOUT</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">VALUEOUT</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#676E95;">  /**</span></span>
<span class="line"><span style="color:#676E95;">   * Map\u9636\u6BB5\u5F00\u59CB\u88AB\u8C03\u7528\u4E00\u6B21.</span></span>
<span class="line"><span style="color:#676E95;">   */</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#C792EA;">protected</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setup</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#676E95;">  /**</span></span>
<span class="line"><span style="color:#676E95;">   * \u6BCF\u4E00\u5BF9Key value \u90FD\u4F1A\u8C03\u7528\u5F02\u5E38\uFF0C\u6240\u6709\u7684MRA\u90FD\u5E94\u8BE5\u91CD\u5199\u8FD9\u4E2A\u65B9\u6CD5</span></span>
<span class="line"><span style="color:#676E95;">   */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">SuppressWarnings</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">unchecked</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">protected</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">map</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">KEYIN</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">VALUEIN</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">                     </span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">IOException</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">InterruptedException</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#89DDFF;">((</span><span style="color:#A6ACCD;">KEYOUT</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> key</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">VALUEOUT</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> value</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">  /**</span></span>
<span class="line"><span style="color:#676E95;">   * Map\u9636\u6BB5\u7ED3\u675F\u4E4B\u540E\u6267\u884C\u4E00\u6B21</span></span>
<span class="line"><span style="color:#676E95;">   */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">protected</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">cleanup</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">context</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">run</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">IOException</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">InterruptedException</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  	</span><span style="color:#676E95;">// \u521D\u59CB\u5316\u65B9\u6CD5</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">setup</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">while</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">nextKeyValue</span><span style="color:#89DDFF;">())</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">// map </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#82AAFF;">map</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getCurrentKey</span><span style="color:#89DDFF;">(),</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getCurrentValue</span><span style="color:#89DDFF;">(),</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">finally</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">// \u7ED3\u675F\u65B9\u6CD5</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">cleanup</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">IntWritable</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Text</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">mapreduce</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Mapper</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">IOException</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WordCountMapper</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Mapper</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">Object</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Text</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Text</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">IntWritable</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">    /**</span></span>
<span class="line"><span style="color:#676E95;">     * Mapper&lt;KEYIN, VALUEIN, KEYOUT, VALUEOUT&gt;</span></span>
<span class="line"><span style="color:#676E95;">     *     KEYIN map\u9636\u6BB5 \u8F93\u5165\u7684Key\u7684\u7C7B\u578B</span></span>
<span class="line"><span style="color:#676E95;">     *     VALUEIN map\u9636\u6BB5\u8F93\u5165\u7684value \u7C7B\u578B \u901A\u5E38\u7528String \u4E5F\u5C31\u662F hdfs \u7684 text \u7C7B\u578B</span></span>
<span class="line"><span style="color:#676E95;">     *     KEYOUT \u8F93\u5165\u7684Key \u7C7B\u578B</span></span>
<span class="line"><span style="color:#676E95;">     *     VALUEOUT map \u9636\u6BB5\u8F93\u51FA\u7684Key \u7C7B\u578B</span></span>
<span class="line"><span style="color:#676E95;">     *     map(Key,value,context)</span></span>
<span class="line"><span style="color:#676E95;">     *     context</span></span>
<span class="line"><span style="color:#676E95;">     *</span></span>
<span class="line"><span style="color:#676E95;">     */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Text</span><span style="color:#A6ACCD;"> k </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Text</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">IntWritable</span><span style="color:#A6ACCD;"> v </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">IntWritable</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">protected</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">map</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Text</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">IOException</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">InterruptedException</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 1 \u83B7\u53D6\u4E00\u884C</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> line </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> value</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 2 \u5207\u5272</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> words </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> line</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">split</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 3 \u8F93\u51FA</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> word </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> words</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            k</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">word</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">k</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> v</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h4 id="reducer" tabindex="-1">Reducer <a class="header-anchor" href="#reducer" aria-hidden="true">#</a></h4><p>\u7EE7\u627F<code>org.apache.hadoop.mapreduce.Reducer</code></p><p><img src="https://img-blog.csdnimg.cn/83406ca8165b4af4aac5e3db24b14c40.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u8FD9\u4E2A\u65B9\u6CD5\u5BF9\u6BCF\u4E2A \u952E \u8C03\u7528\u4E00\u6B21\u3002</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">SuppressWarnings</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">unchecked</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#C792EA;">protected</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">reduce</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">KEYIN</span><span style="color:#A6ACCD;"> key</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Iterable</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">VALUEIN</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> values</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> c</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> throws IOException</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> InterruptedException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">for</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">VALUEIN</span><span style="color:#A6ACCD;"> value</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> values</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#89DDFF;">((</span><span style="color:#A6ACCD;">KEYOUT</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> key</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">VALUEOUT</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> value</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Job</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> throws IOException</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> ClassNotFoundException</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> InterruptedException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 1 \u83B7\u53D6\u914D\u7F6E\u4FE1\u606F\u4EE5\u53CA\u83B7\u53D6 job \u5BF9\u8C61</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Job</span><span style="color:#A6ACCD;"> job </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getInstance</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 2 \u5173\u8054\u672C Driver \u7A0B\u5E8F\u7684 jar</span></span>
<span class="line"><span style="color:#A6ACCD;">    job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setJarByClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">WordCountLinuxJobDriver</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 3 \u5173\u8054 Mapper \u548C Reducer \u7684 jar</span></span>
<span class="line"><span style="color:#A6ACCD;">    job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setMapperClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">WordCountMapper</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setReducerClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">WordCountReducer</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 4 \u8BBE\u7F6E Mapper \u8F93\u51FA\u7684 kv \u7C7B\u578B</span></span>
<span class="line"><span style="color:#A6ACCD;">    job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setMapOutputKeyClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Text</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setMapOutputValueClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">IntWritable</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 5 \u8BBE\u7F6E\u6700\u7EC8\u8F93\u51FA kv \u7C7B\u578B</span></span>
<span class="line"><span style="color:#A6ACCD;">    job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setOutputKeyClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Text</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setOutputValueClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">IntWritable</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 6 \u8BBE\u7F6E\u8F93\u5165\u548C\u8F93\u51FA\u8DEF\u5F84</span></span>
<span class="line"><span style="color:#A6ACCD;">    FileInputFormat</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setInputPaths</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">]));</span></span>
<span class="line"><span style="color:#A6ACCD;">    FileOutputFormat</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setOutputPath</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">]));</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 7 \u63D0\u4EA4 job</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">boolean</span><span style="color:#A6ACCD;"> result </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">waitForCompletion</span><span style="color:#89DDFF;">(true);</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">exit</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">result </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><code>hadoop jar xxx.jar xx.xx.xxx /input /output</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">hadoop jar hello-mapreduce.jar com.laoshiren.hello.hdfs.mapreduce.WordCountLinuxJobDriver /laoshiren/wordcount /laoshiren/output</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/7a47ba9403514379be52890ffd3302d4.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u5177\u4F53\u4EE3\u7801\u770B<code>hadoop/hello-mapreduce/../hdfs/mapreduce</code></p><h2 id="\u5E8F\u5217\u5316" tabindex="-1">\u5E8F\u5217\u5316 <a class="header-anchor" href="#\u5E8F\u5217\u5316" aria-hidden="true">#</a></h2><p>\u4E3A\u4EC0\u4E48\u4E0D\u7528 Java \u7684\u5E8F\u5217\u5316? Java \u7684\u5E8F\u5217\u5316\u662F\u4E00\u4E2A\u91CD\u91CF\u7EA7\u5E8F\u5217\u5316\u6846\u67B6\uFF08Serializable\uFF09\uFF0C\u4E00\u4E2A\u5BF9\u8C61\u88AB\u5E8F\u5217\u5316\u540E\uFF0C\u4F1A\u9644\u5E26\u5F88\u591A\u989D\u5916\u7684\u4FE1\u606F\uFF08\u5404\u79CD\u6821\u9A8C\u4FE1\u606F\uFF0CHeader\uFF0C\u7EE7\u627F\u4F53\u7CFB\u7B49\uFF09\uFF0C\u4E0D\u4FBF\u4E8E\u5728\u7F51\u7EDC\u4E2D\u9AD8\u6548\u4F20\u8F93\u3002\u6240\u4EE5\uFF0CHadoop \u81EA\u5DF1\u5F00\u53D1\u4E86\u4E00\u5957\u5E8F\u5217\u5316\u673A\u5236\uFF08Writable\uFF09\u3002</p><p>Hadoop \u5E8F\u5217\u5316\u7279\u70B9\uFF1A</p><ul><li>\u7D27\u51D1 \uFF1A\u9AD8\u6548\u4F7F\u7528\u5B58\u50A8\u7A7A\u95F4\u3002</li><li>\u5FEB\u901F\uFF1A\u8BFB\u5199\u6570\u636E\u7684\u989D\u5916\u5F00\u9500\u5C0F\u3002</li><li>\u4E92\u64CD\u4F5C\uFF1A\u652F\u6301\u591A\u8BED\u8A00\u7684\u4EA4\u4E92</li></ul><h3 id="\u81EA\u5B9A\u4E49\u5E8F\u5217\u5316" tabindex="-1">\u81EA\u5B9A\u4E49\u5E8F\u5217\u5316 <a class="header-anchor" href="#\u81EA\u5B9A\u4E49\u5E8F\u5217\u5316" aria-hidden="true">#</a></h3><p>\u5177\u4F53\u5B9E\u73B0 bean \u5BF9\u8C61\u5E8F\u5217\u5316\u5982\u4E0B \u3002</p><ol><li>\u5FC5\u987B\u5B9E\u73B0 Writable \u63A5\u53E3<code>org.apache.hadoop.io.Writable</code></li><li>\u53CD\u5E8F\u5217\u5316\u65F6\uFF0C\u9700\u8981\u53CD\u5C04\u8C03\u7528\u7A7A\u53C2\u6784\u9020\u51FD\u6570\uFF0C\u6240\u4EE5\u5FC5\u987B\u6709\u7A7A\u53C2\u6784\u9020</li><li>\u91CD\u5199\u5E8F\u5217\u5316\u65B9\u6CD5\uFF0C\u91CD\u5199\u53CD\u5E8F\u5217\u5316\u65B9\u6CD5</li><li>\u6CE8\u610F\u53CD\u5E8F\u5217\u5316\u7684\u987A\u5E8F\u548C\u5E8F\u5217\u5316\u7684\u987A\u5E8F\u5B8C\u5168\u4E00\u81F4</li><li>\u8981\u60F3\u628A\u7ED3\u679C\u663E\u793A\u5728\u6587\u4EF6\u4E2D\uFF0C\u9700\u8981\u91CD\u5199<code>toString()</code>\uFF0C\u53EF\u7528&quot;\\t&quot;\u5206\u5F00\uFF0C\u65B9\u4FBF\u540E\u7EED\u7528\u3002</li><li>\u5982\u679C\u9700\u8981\u5C06\u81EA\u5B9A\u4E49\u7684 bean \u653E\u5728 key \u4E2D\u4F20\u8F93\uFF0C\u5219\u8FD8\u9700\u8981\u5B9E\u73B0 Comparable \u63A5\u53E3\uFF0C\u56E0\u4E3AMapReduce \u6846\u4E2D\u7684 Shuffle \u8FC7\u7A0B\u8981\u6C42\u5BF9 key \u5FC5\u987B\u80FD\u6392\u5E8F\u3002</li></ol><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">write</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataOutput</span><span style="color:#A6ACCD;"> out</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeUTF</span><span style="color:#89DDFF;">(this.</span><span style="color:#A6ACCD;">phoneNo</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeLong</span><span style="color:#89DDFF;">(this.</span><span style="color:#A6ACCD;">upStream</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeLong</span><span style="color:#89DDFF;">(this.</span><span style="color:#A6ACCD;">downloadStream</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeLong</span><span style="color:#89DDFF;">(this.</span><span style="color:#A6ACCD;">totalStream</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">readFields</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataInput</span><span style="color:#A6ACCD;"> in</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">phoneNo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> in</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readUTF</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">upStream </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> in</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readLong</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">downloadStream </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> in</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readLong</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">totalStream </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> in</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readLong</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">toString</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> phoneNo </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\t</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> upStream </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\t</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> downloadStream </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\t</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> totalStream</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>\u5177\u4F53\u4EE3\u7801\u770B<code>hadoop/hello-mapreduce/../hdfs/io</code></p><h2 id="mapreduce\u6846\u67B6\u539F\u7406" tabindex="-1">MapReduce\u6846\u67B6\u539F\u7406 <a class="header-anchor" href="#mapreduce\u6846\u67B6\u539F\u7406" aria-hidden="true">#</a></h2><h3 id="inputformat-\u6570\u636E\u8F93\u5165" tabindex="-1">InputFormat \u6570\u636E\u8F93\u5165 <a class="header-anchor" href="#inputformat-\u6570\u636E\u8F93\u5165" aria-hidden="true">#</a></h3><h4 id="\u5207\u7247\u4E0E-maptask-\u5E76\u884C\u5EA6\u51B3\u5B9A\u673A\u5236" tabindex="-1">\u5207\u7247\u4E0E MapTask \u5E76\u884C\u5EA6\u51B3\u5B9A\u673A\u5236 <a class="header-anchor" href="#\u5207\u7247\u4E0E-maptask-\u5E76\u884C\u5EA6\u51B3\u5B9A\u673A\u5236" aria-hidden="true">#</a></h4><p>\u6570\u636E\u5757\uFF1ABlock \u662F HDFS \u7269\u7406\u4E0A\u628A\u6570\u636E\u5206\u6210\u4E00\u5757\u4E00\u5757\u3002\u6570\u636E\u5757\u662F HDFS \u5B58\u50A8\u6570\u636E\u5355\u4F4D\u3002</p><p>\u6570\u636E\u5207\u7247\uFF1A\u6570\u636E\u5207\u7247\u53EA\u662F\u5728\u903B\u8F91\u4E0A\u5BF9\u8F93\u5165\u8FDB\u884C\u5206\u7247\uFF0C\u5E76\u4E0D\u4F1A\u5728\u78C1\u76D8\u4E0A\u5C06\u5176\u5207\u5206\u6210\u7247\u8FDB\u884C\u5B58\u50A8\u3002\u6570\u636E\u5207\u7247\u662F MapReduce \u7A0B\u5E8F\u8BA1\u7B97\u8F93\u5165\u6570\u636E\u7684\u5355\u4F4D\uFF0C\u4E00\u4E2A\u5207\u7247\u4F1A\u5BF9\u5E94\u542F\u52A8\u4E00\u4E2AMapTask\u3002</p><ol><li>\u4E00\u4E2AJob\u7684Map\u9636\u6BB5\u5E76\u884C\u5EA6\u7531\u5BA2\u6237\u7AEF\u5728\u63D0\u4EA4Job\u65F6\u7684\u5207\u7247\u6570\u51B3\u5B9A</li><li>\u6BCF\u4E00\u4E2ASplit\u5207\u7247\u5206\u914D\u4E00\u4E2AMapTask\u5E76\u884C\u5B9E\u4F8B\u5904\u7406</li><li>\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u5207\u7247\u5927\u5C0F=BlockSize</li><li>\u5207\u7247\u65F6\u4E0D\u8003\u8651\u6570\u636E\u96C6\u6574\u4F53\uFF0C\u800C\u662F\u9010\u4E2A\u9488\u5BF9\u6BCF\u4E00\u4E2A\u6587\u4EF6\u5355\u72EC\u5207\u7247</li></ol><h4 id="job-\u63D0\u4EA4\u6D41\u7A0B\u6E90\u7801\u548C\u5207\u7247\u6E90\u7801\u8BE6\u89E3" tabindex="-1">Job \u63D0\u4EA4\u6D41\u7A0B\u6E90\u7801\u548C\u5207\u7247\u6E90\u7801\u8BE6\u89E3 <a class="header-anchor" href="#job-\u63D0\u4EA4\u6D41\u7A0B\u6E90\u7801\u548C\u5207\u7247\u6E90\u7801\u8BE6\u89E3" aria-hidden="true">#</a></h4><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">waitForCompletion</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#82AAFF;">submit</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#676E95;">// 1 \u5EFA\u7ACB\u8FDE\u63A5</span></span>
<span class="line"><span style="color:#82AAFF;">connect</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#676E95;">// 1\uFF09\u521B\u5EFA\u63D0\u4EA4 Job \u7684\u4EE3\u7406</span></span>
<span class="line"><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Cluster</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">getConfiguration</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#676E95;">// \uFF081\uFF09\u5224\u65AD\u662F\u672C\u5730\u8FD0\u884C\u73AF\u5883\u8FD8\u662F yarn \u96C6\u7FA4\u8FD0\u884C\u73AF\u5883</span></span>
<span class="line"><span style="color:#82AAFF;">initialize</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">jobTrackAddr</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;">// 2 \u63D0\u4EA4 job</span></span>
<span class="line"><span style="color:#A6ACCD;">submitter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">submitJobInternal</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Job</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">this</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> cluster</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;">// 1\uFF09\u521B\u5EFA\u7ED9\u96C6\u7FA4\u63D0\u4EA4\u6570\u636E\u7684 Stag \u8DEF\u5F84</span></span>
<span class="line"><span style="color:#C792EA;">Path</span><span style="color:#A6ACCD;"> jobStagingArea </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> JobSubmissionFiles</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getStagingDir</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">cluster</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;">// 2\uFF09\u83B7\u53D6 jobid \uFF0C\u5E76\u521B\u5EFA Job \u8DEF\u5F84</span></span>
<span class="line"><span style="color:#C792EA;">JobID</span><span style="color:#A6ACCD;"> jobId </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> submitClient</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getNewJobID</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#676E95;">// 3\uFF09\u62F7\u8D1D jar \u5305\u5230\u96C6\u7FA4</span></span>
<span class="line"><span style="color:#82AAFF;">copyAndConfigureFiles</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> submitJobDir</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">rUploader</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">uploadFiles</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> jobSubmitDir</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;">// 4\uFF09\u8BA1\u7B97\u5207\u7247\uFF0C\u751F\u6210\u5207\u7247\u89C4\u5212\u6587\u4EF6</span></span>
<span class="line"><span style="color:#82AAFF;">writeSplits</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> submitJobDir</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">maps </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">writeNewSplits</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">jobSubmitDir</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">input</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getSplits</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;">// 5\uFF09\u5411 Stag \u8DEF\u5F84\u5199 XML \u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#82AAFF;">writeConf</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> submitJobFile</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeXml</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;">// 6\uFF09\u63D0\u4EA4 Job,\u8FD4\u56DE\u63D0\u4EA4\u72B6\u6001</span></span>
<span class="line"><span style="color:#A6ACCD;">status </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> submitClient</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">submitJob</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">jobId</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">submitJobDir</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#89DDFF;">(),</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getCredentials</span><span style="color:#89DDFF;">());</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><ul><li><p>\u7A0B\u5E8F\u5148\u627E\u5230\u4F60\u6570\u636E\u5B58\u50A8\u7684\u76EE\u5F55\u3002</p></li><li><p>\u5F00\u59CB\u904D\u5386\u5904\u7406\uFF08\u89C4\u5212\u5207\u7247\uFF09\u76EE\u5F55\u4E0B\u7684\u6BCF\u4E00\u4E2A\u6587\u4EF6</p></li><li><p>\u904D\u5386\u7B2C\u4E00\u4E2A\u6587\u4EF6ss.txt</p><ul><li>\u83B7\u53D6\u6587\u4EF6\u5927\u5C0Ffs.sizeOf(ss.txt)</li><li>\u8BA1\u7B97\u5207\u7247\u5927\u5C0FcomputeSplitSize(Math.max(minSize,Math.min(maxSize,blocksize)))=blocksize=128M</li><li>\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u5207\u7247\u5927\u5C0F=blocksize</li><li>\u5F00\u59CB\u5207\uFF0C\u5F62\u6210\u7B2C1\u4E2A\u5207\u7247\uFF1Ass.txt\u20140:128M \u7B2C2\u4E2A\u5207\u7247ss.txt\u2014128:256M \u7B2C3\u4E2A\u5207\u7247ss.txt\u2014256M:300M \uFF08\u6BCF\u6B21\u5207\u7247\u65F6\uFF0C\u90FD\u8981\u5224\u65AD\u5207\u5B8C\u5269\u4E0B\u7684\u90E8\u5206\u662F\u5426\u5927\u4E8E\u5757\u76841.1\u500D\uFF0C\u4E0D\u5927\u4E8E1.1\u500D\u5C31\u5212\u5206\u4E00\u5757\u5207\u7247\uFF09</li><li>\u5C06\u5207\u7247\u4FE1\u606F\u5199\u5230\u4E00\u4E2A\u5207\u7247\u89C4\u5212\u6587\u4EF6\u4E2D</li><li>\u6574\u4E2A\u5207\u7247\u7684\u6838\u5FC3\u8FC7\u7A0B\u5728getSplit()\u65B9\u6CD5\u4E2D\u5B8C\u6210</li><li>InputSplit\u53EA\u8BB0\u5F55\u4E86\u5207\u7247\u7684\u5143\u6570\u636E\u4FE1\u606F\uFF0C\u6BD4\u5982\u8D77\u59CB\u4F4D\u7F6E\u3001\u957F\u5EA6\u4EE5\u53CA\u6240\u5728\u7684\u8282\u70B9\u5217\u8868\u7B49\u3002</li></ul></li><li><p>\u63D0\u4EA4\u5207\u7247\u89C4\u5212\u6587\u4EF6\u5230YARN\u4E0A\uFF0CYARN\u4E0A\u7684MrAppMaster\u5C31\u53EF\u4EE5\u6839\u636E\u5207\u7247\u89C4\u5212\u6587\u4EF6\u8BA1\u7B97\u5F00\u542FMapTask\u4E2A\u6570\u3002</p></li></ul><h3 id="mapreduce-\u5DE5\u4F5C\u6D41\u7A0B" tabindex="-1">MapReduce \u5DE5\u4F5C\u6D41\u7A0B <a class="header-anchor" href="#mapreduce-\u5DE5\u4F5C\u6D41\u7A0B" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/070f1205d662436a805a844c2616d29c.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p><img src="https://img-blog.csdnimg.cn/b28473ac4f134e339de05e8c60771b34.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h4 id="partition" tabindex="-1">Partition <a class="header-anchor" href="#partition" aria-hidden="true">#</a></h4><p>\u9ED8\u8BA4\u5206\u533A\u662F\u6839\u636Ekey\u7684hashCode\u5BF9ReduceTasks\u4E2A\u6570\u53D6\u6A21\u5F97\u5230\u7684\u3002\u7528\u6237\u6CA1\u6CD5\u63A7\u5236\u54EA\u4E2Akey\u5B58\u50A8\u5230\u54EA\u4E2A\u5206\u533A\u3002</p><p><img src="https://img-blog.csdnimg.cn/4f06f40936af400abb13dbdb4388675a.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u5177\u4F53\u4EE3\u7801\u770B<code>hadoop/hello-mapreduce/../hdfs/partitioner</code></p><h4 id="outputformat" tabindex="-1">OutputFormat <a class="header-anchor" href="#outputformat" aria-hidden="true">#</a></h4><p>OutputFormat\u662FMapReduce\u8F93\u51FA\u7684\u57FA\u7C7B\uFF0C\u6240\u6709\u5B9E\u73B0MapReduce\u8F93\u51FA\u90FD\u5B9E\u73B0\u4E86 OutputFormat\u63A5\u53E3\u3002</p><p><img src="https://img-blog.csdnimg.cn/7a18f76185e049e58e875cfb36e1ba77.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p><img src="https://img-blog.csdnimg.cn/ddbd66e7321e4a909d85935c6c540844.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u7EE7\u627FOutputFormat \u8FD4\u56DE\u4E00\u4E2ARecordWriter ,\u7136\u540E\u81EA\u5B9A\u4E49RecordWrite\u5C31\u53EF\u4EE5\u5411DB\u7B49\u5199\u3002</p><p><img src="https://img-blog.csdnimg.cn/a187ba3becb8439a9ddd7e6f497d839e.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u5728Driver\u52A0\u4E0A<code>job.setOutputFormatClass(XXXOutputFormat.class);</code></p><p>\u5177\u4F53\u4EE3\u7801\u770B<code>hadoop/hello-mapreduce/../hdfs/outputformat</code></p><h4 id="reduce-join" tabindex="-1">Reduce Join <a class="header-anchor" href="#reduce-join" aria-hidden="true">#</a></h4><p>Map \u7AEF\u7684\u4E3B\u8981\u5DE5\u4F5C\uFF1A\u4E3A\u6765\u81EA\u4E0D\u540C\u8868\u6216\u6587\u4EF6\u7684 key/value \u5BF9\uFF0C\u6253\u6807\u7B7E\u4EE5\u533A\u522B\u4E0D\u540C\u6765\u6E90\u7684\u8BB0\u5F55\u3002\u7136\u540E\u7528\u8FDE\u63A5\u5B57\u6BB5\u4F5C\u4E3A key\uFF0C\u5176\u4F59\u90E8\u5206\u548C\u65B0\u52A0\u7684\u6807\u5FD7\u4F5C\u4E3A value\uFF0C\u6700\u540E\u8FDB\u884C\u8F93\u51FA\u3002 Reduce \u7AEF\u7684\u4E3B\u8981\u5DE5\u4F5C\uFF1A\u5728 Reduce \u7AEF\u4EE5\u8FDE\u63A5\u5B57\u6BB5\u4F5C\u4E3A key \u7684\u5206\u7EC4\u5DF2\u7ECF\u5B8C\u6210\uFF0C\u6211\u4EEC\u53EA\u9700\u8981\u5728\u6BCF\u4E00\u4E2A\u5206\u7EC4\u5F53\u4E2D\u5C06\u90A3\u4E9B\u6765\u6E90\u4E8E\u4E0D\u540C\u6587\u4EF6\u7684\u8BB0\u5F55\uFF08\u5728 Map \u9636\u6BB5\u5DF2\u7ECF\u6253\u6807\u5FD7\uFF09\u5206\u5F00\uFF0C\u6700\u540E\u8FDB\u884C\u5408\u5E76\u5C31 ok \u4E86\u3002</p><p><img src="https://img-blog.csdnimg.cn/d688562abe694052984226c219ba9ca2.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TableBean</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">implements</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Writable</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//\u8BA2\u5355 id</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> id</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//\u4EA7\u54C1 id</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> pid</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//\u4EA7\u54C1\u6570\u91CF</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> amount</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//\u4EA7\u54C1\u540D\u79F0</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> pname</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//\u5224\u65AD\u662F order \u8868\u8FD8\u662F pd \u8868\u7684\u6807\u5FD7\u5B57\u6BB5</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> flag</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>\u5177\u4F53\u4EE3\u7801\u770B<code>hadoop/hello-mapreduce/../hdfs/reducejoin</code></p><h4 id="map-join" tabindex="-1">Map Join <a class="header-anchor" href="#map-join" aria-hidden="true">#</a></h4><p>Map Join \u9002\u7528\u4E8E\u4E00\u5F20\u8868\u5341\u5206\u5C0F\u3001\u4E00\u5F20\u8868\u5F88\u5927\u7684\u573A\u666F\u3002</p><ul><li>\u5728 Mapper \u7684 setup \u9636\u6BB5\uFF0C\u5C06\u6587\u4EF6\u8BFB\u53D6\u5230\u7F13\u5B58\u96C6\u5408\u4E2D\u3002</li><li>\u5728 Driver \u9A71\u52A8\u7C7B\u4E2D\u52A0\u8F7D\u7F13\u5B58\u3002</li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addCacheFile</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URI</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">file:///D:/IdeaExampleProjects/data-ware-house/env/example/join/input/dt.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Mapper</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Map</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> pdMap </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">HashMap</span><span style="color:#89DDFF;">&lt;&gt;();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#C792EA;">protected</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setup</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> throws IOException</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> InterruptedException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//\u901A\u8FC7\u7F13\u5B58\u6587\u4EF6\u5F97\u5230\u5C0F\u8868\u6570\u636E pd.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">URI</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> cacheFiles </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getCacheFiles</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Path</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">cacheFiles</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">]);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//\u83B7\u53D6\u6587\u4EF6\u7CFB\u7EDF\u5BF9\u8C61,\u5E76\u5F00\u6D41</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">FileSystem</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getConfiguration</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">FSDataInputStream</span><span style="color:#A6ACCD;"> fis </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">open</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//\u901A\u8FC7\u5305\u88C5\u6D41\u8F6C\u6362\u4E3A reader,\u65B9\u4FBF\u6309\u884C\u8BFB\u53D6</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">BufferedReader</span><span style="color:#A6ACCD;"> reader </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">BufferedReader</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#82AAFF;">InputStreamReader</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">fis</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> line</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">while</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">StringUtils</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isNotEmpty</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">line </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> reader</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readLine</span><span style="color:#89DDFF;">()))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">//\u5207\u5272\u4E00\u884C</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">//01 \u5C0F\u7C73</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> split </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> line</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">split</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\t</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        pdMap</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">put</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">split</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">],</span><span style="color:#A6ACCD;"> split</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">]);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//\u5173\u6D41</span></span>
<span class="line"><span style="color:#A6ACCD;">    IOUtils</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">closeStream</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">reader</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="mapreduce\u5F00\u53D1\u603B\u7ED3" tabindex="-1">MapReduce\u5F00\u53D1\u603B\u7ED3 <a class="header-anchor" href="#mapreduce\u5F00\u53D1\u603B\u7ED3" aria-hidden="true">#</a></h3><ol><li>\u8F93\u5165\u63A5\u53E3\u662F<code>Inputformat</code><ul><li>\u9ED8\u8BA4\u4F7F\u7528\u7684\u5B9E\u73B0\u7C7B\u662F\uFF1ATextInputFormat \u4E00\u6B21\u8BFB\u4E00\u884C\u6587\u672C\uFF0C\u7136\u540E\u5C06\u8BE5\u884C\u7684\u8D77\u59CB\u504F\u79FB\u91CF\u4F5C\u4E3A key\uFF0C\u884C\u5185\u5BB9\u4F5C\u4E3A value \u8FD4\u56DE\u3002</li></ul></li><li>\u903B\u8F91\u5904\u7406\u7ED3\u6784\u662F<code>Mapper</code><ul><li>\u7528\u6237\u6839\u636E\u4E1A\u52A1\u9700\u6C42\u5B9E\u73B0\u5176\u4E2D\u4E09\u4E2A\u65B9\u6CD5\uFF1Amap() setup() cleanup ()</li></ul></li><li><code>Partitioner</code>\u5206\u533A\uFF0C<code>job.setNumReduceTasks(4);</code><ul><li>\u6709\u9ED8\u8BA4\u5B9E\u73B0 HashPartitioner\uFF0C\u903B\u8F91\u662F\u6839\u636E key \u7684\u54C8\u5E0C\u503C\u548C numReduces \u6765\u8FD4\u56DE\u4E00\u4E2A\u5206\u533A\u53F7\uFF1B<code>key.hashCode()&amp;Integer.MAXVALUE % numReduces</code></li></ul></li><li><code>Comparable</code> \u6392\u5E8F</li><li><code>Combiner</code> \u5408\u5E76</li><li>\u903B\u8F91\u5904\u7406\u63A5\u53E3\uFF1A<code>Reducer</code><ul><li>\u7528\u6237\u6839\u636E\u4E1A\u52A1\u9700\u6C42\u5B9E\u73B0\u5176\u4E2D\u4E09\u4E2A\u65B9\u6CD5\uFF1Areduce() setup() cleanup ()</li></ul></li><li>\u8F93\u51FA\u6570\u636E\u63A5\u53E3\uFF1A<code>OutputFormat</code><ul><li>\u9ED8\u8BA4\u5B9E\u73B0\u7C7B\u662F TextOutputFormat\uFF0C\u529F\u80FD\u903B\u8F91\u662F\uFF1A\u5C06\u6BCF\u4E00\u4E2A KV \u5BF9\uFF0C\u5411\u76EE\u6807\u6587\u672C\u6587\u4EF6\u8F93\u51FA\u4E00\u884C\u3002</li></ul></li></ol><h2 id="\u538B\u7F29" tabindex="-1">\u538B\u7F29 <a class="header-anchor" href="#\u538B\u7F29" aria-hidden="true">#</a></h2><ul><li>\u538B\u7F29\u7684\u597D\u5904\u548C\u574F\u5904 \u538B\u7F29\u7684\u4F18\u70B9\uFF1A\u4EE5\u51CF\u5C11\u78C1\u76D8 IO\u3001\u51CF\u5C11\u78C1\u76D8\u5B58\u50A8\u7A7A\u95F4\u3002 \u538B\u7F29\u7684\u7F3A\u70B9\uFF1A\u589E\u52A0 CPU \u5F00\u9500\u3002</li><li>\u538B\u7F29\u539F\u5219 <ul><li>\u8FD0\u7B97\u5BC6\u96C6\u578B\u7684 Job\uFF0C\u5C11\u7528\u538B\u7F29</li><li>IO \u5BC6\u96C6\u578B\u7684 Job\uFF0C\u591A\u7528\u538B\u7F29</li></ul></li></ul><table><thead><tr><th style="text-align:center;">\u538B\u7F29\u683C\u5F0F</th><th style="text-align:center;">Hadoop \u81EA\u5E26</th><th style="text-align:center;">\u7B97\u6CD5</th><th style="text-align:center;">\u6587\u4EF6\u6269\u5C55\u540D</th><th style="text-align:center;">\u662F\u5426\u53EF\u5207\u7247</th><th style="text-align:center;">\u6362\u6210\u538B\u7F29\u683C\u5F0F\u540E\uFF0C\u539F\u6765\u7684\u7A0B\u5E8F\u662F\u5426\u9700\u8981\u4FEE\u6539</th><th style="text-align:center;">\u901F\u5EA6</th></tr></thead><tbody><tr><td style="text-align:center;">DEFLATE</td><td style="text-align:center;">\u662F</td><td style="text-align:center;">DEFLATE</td><td style="text-align:center;">.deflate</td><td style="text-align:center;">\u5426</td><td style="text-align:center;">\u548C\u6587\u672C\u5904\u7406\u4E00\u6837\uFF0C\u4E0D\u9700\u8981\u4FEE\u6539</td><td style="text-align:center;">\u5FEB</td></tr><tr><td style="text-align:center;">Gzip</td><td style="text-align:center;">\u662F</td><td style="text-align:center;">Gzip</td><td style="text-align:center;">.gz</td><td style="text-align:center;">\u5426</td><td style="text-align:center;">\u548C\u6587\u672C\u5904\u7406\u4E00\u6837\uFF0C\u4E0D\u9700\u8981\u4FEE\u6539</td><td style="text-align:center;">\u4E00\u822C</td></tr><tr><td style="text-align:center;">bzip2</td><td style="text-align:center;">\u662F</td><td style="text-align:center;">bzip2</td><td style="text-align:center;">.bz2</td><td style="text-align:center;">\u662F</td><td style="text-align:center;">\u548C\u6587\u672C\u5904\u7406\u4E00\u6837\uFF0C\u4E0D\u9700\u8981\u4FEE\u6539</td><td style="text-align:center;">\u6162</td></tr><tr><td style="text-align:center;">LZO</td><td style="text-align:center;">\u5426</td><td style="text-align:center;">LZO</td><td style="text-align:center;">.lzo</td><td style="text-align:center;">\u662F</td><td style="text-align:center;">\u9700\u8981\u5EFA\u7D22\u5F15\uFF0C\u8FD8\u9700\u8981\u6307\u5B9A\u8F93\u5165\u683C\u5F0F</td><td style="text-align:center;">\u4E00\u822C</td></tr><tr><td style="text-align:center;">Snappy</td><td style="text-align:center;">\u662F</td><td style="text-align:center;">Snappy</td><td style="text-align:center;">.snappy</td><td style="text-align:center;">\u5426</td><td style="text-align:center;">\u548C\u6587\u672C\u5904\u7406\u4E00\u6837\uFF0C\u4E0D\u9700\u8981\u4FEE\u6539</td><td style="text-align:center;">\u6781\u5FEB</td></tr></tbody></table><h3 id="mapper-\u538B\u7F29" tabindex="-1">Mapper \u538B\u7F29 <a class="header-anchor" href="#mapper-\u538B\u7F29" aria-hidden="true">#</a></h3><p>[\u6587\u4EF6] -&gt; mapper() -&gt; \u538B\u7F29 -&gt; \u4F20\u8F93 -&gt; \u89E3\u538B\u7F29 -&gt; reducer()</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// 1 \u83B7\u53D6\u914D\u7F6E\u4FE1\u606F\u4EE5\u53CA\u83B7\u53D6 job \u5BF9\u8C61</span></span>
<span class="line"><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#676E95;">// \u5F00\u542F map \u7AEF\u8F93\u51FA\u538B\u7F29</span></span>
<span class="line"><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setBoolean</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mapreduce.map.output.compress</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true);</span></span>
<span class="line"><span style="color:#676E95;">// \u8BBE\u7F6E map \u7AEF\u8F93\u51FA\u538B\u7F29\u65B9\u5F0F</span></span>
<span class="line"><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setClass</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mapreduce.map.output.compress.codec</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> BZip2Codec</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> CompressionCodec</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="reduce\u538B\u7F29" tabindex="-1">Reduce\u538B\u7F29 <a class="header-anchor" href="#reduce\u538B\u7F29" aria-hidden="true">#</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// \u8BBE\u7F6E reduce \u7AEF\u8F93\u51FA\u538B\u7F29\u5F00\u542F</span></span>
<span class="line"><span style="color:#A6ACCD;">FileOutputFormat</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setCompressOutput</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true);</span></span>
<span class="line"><span style="color:#676E95;">// \u8BBE\u7F6E\u538B\u7F29\u7684\u65B9\u5F0F</span></span>
<span class="line"><span style="color:#A6ACCD;">FileOutputFormat</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setOutputCompressorClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">job</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> BZip2Codec</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u5177\u4F53\u4EE3\u7801\u770B<code>hadoop/hello-mapreduce/../hdfs/zip</code></p><h1 id="yarn" tabindex="-1">YARN <a class="header-anchor" href="#yarn" aria-hidden="true">#</a></h1><p>Yarn \u662F\u4E00\u4E2A\u8D44\u6E90\u8C03\u5EA6\u5E73\u53F0\uFF0C\u8D1F\u8D23\u4E3A\u8FD0\u7B97\u7A0B\u5E8F\u63D0\u4F9B\u670D\u52A1\u5668\u8FD0\u7B97\u8D44\u6E90\uFF0C\u76F8\u5F53\u4E8E\u4E00\u4E2A\u5206\u5E03\u5F0F\u7684\u64CD\u4F5C\u7CFB\u7EDF\u5E73\u53F0\uFF0C\u800C MapReduce \u7B49\u8FD0\u7B97\u7A0B\u5E8F\u5219\u76F8\u5F53\u4E8E\u8FD0\u884C\u4E8E\u64CD\u4F5C\u7CFB\u7EDF\u4E4B\u4E0A\u7684\u5E94\u7528\u7A0B\u5E8F\u3002</p><h2 id="yarn-\u57FA\u7840\u67B6\u6784" tabindex="-1">Yarn \u57FA\u7840\u67B6\u6784 <a class="header-anchor" href="#yarn-\u57FA\u7840\u67B6\u6784" aria-hidden="true">#</a></h2><p>YARN \u4E3B\u8981\u7531 ResourceManager\u3001NodeManager\u3001ApplicationMaster \u548C Container \u7B49\u7EC4\u4EF6\u6784\u6210\u3002</p><p><strong>ResourceManager \u4E3B\u8981\u4F5C\u7528\u5982\u4E0B</strong></p><ol><li>\u5904\u7406\u5BA2\u6237\u7AEF\u8BF7\u6C42</li><li>\u76D1\u63A7 NodeManager</li><li>\u542F\u52A8\u6216\u76D1\u63A7 ApplicationMaster</li><li>\u8D44\u6E90\u7684\u5206\u914D\u4E0E\u8C03\u5EA6</li></ol><p><strong>NodeManager\uFF08NM\uFF09\u4E3B\u8981\u4F5C\u7528\u5982\u4E0B</strong></p><ol><li>\u7BA1\u7406\u5355\u4E2A\u8282\u70B9\u4E0A\u7684\u8D44\u6E90</li><li>\u5904\u7406\u6765\u81EA ResourceManager \u7684\u547D\u4EE4</li><li>\u5904\u7406\u6765\u81EA ApplicationMaster \u7684\u547D\u4EE4</li></ol><p><strong>ApplicationMaster\uFF08AM\uFF09\u4F5C\u7528\u5982\u4E0B</strong></p><ol><li>\u4E3A\u5E94\u7528\u7A0B\u5E8F\u7533\u8BF7\u8D44\u6E90\u5E76\u5206\u914D\u7ED9\u5185\u90E8\u7684\u4EFB\u52A1</li><li>\u4EFB\u52A1\u7684\u76D1\u63A7\u4E0E\u5BB9\u9519</li></ol><p><strong>Container</strong></p><p>Container \u662F YARN \u4E2D\u7684\u8D44\u6E90\u62BD\u8C61\uFF0C\u5B83\u5C01\u88C5\u4E86\u67D0\u4E2A\u8282\u70B9\u4E0A\u7684\u591A\u7EF4\u5EA6\u8D44\u6E90\uFF0C\u5982\u5185\u5B58\u3001CPU\u3001\u78C1 \u76D8\u3001\u7F51\u7EDC\u7B49\u3002</p><p><img src="https://img-blog.csdnimg.cn/33facb058f114500b3b74ea5d6909943.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h2 id="yarn\u5DE5\u4F5C\u673A\u5236" tabindex="-1">YARN\u5DE5\u4F5C\u673A\u5236 <a class="header-anchor" href="#yarn\u5DE5\u4F5C\u673A\u5236" aria-hidden="true">#</a></h2><p><img src="https://img-blog.csdnimg.cn/58fc20358e96479f860a947dbfa19537.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><ol><li>MR \u7A0B\u5E8F\u63D0\u4EA4\u5230\u5BA2\u6237\u7AEF\u6240\u5728\u7684\u8282\u70B9\u3002<code>Job#waitForCompletion()</code> \u521B\u5EFA YarnRunner</li><li>Yarn \u5411 ResourceManager \u7533\u8BF7\u4E00\u4E2A Application\uFF0CRM \u5C06\u8BE5\u5E94\u7528\u7A0B\u5E8F\u7684\u8D44\u6E90\u8DEF\u5F84\u8FD4\u56DE\u7ED9 YarnRunner \u3002</li><li>\u8BE5\u7A0B\u5E8F\u5C06\u8FD0\u884C\u6240\u9700\u8D44\u6E90\u63D0\u4EA4\u5230 HDFS \u4E0A \u3002</li><li>\u7A0B\u5E8F\u8D44\u6E90\u63D0\u4EA4\u5B8C\u6BD5\u540E\uFF0C\u7533\u8BF7\u8FD0\u884C mrAppMaster \u3002</li><li>RM \u5C06\u7528\u6237\u7684\u8BF7\u6C42\u521D\u59CB\u5316\u6210\u4E00\u4E2A Task \uFF0C\u653E\u5165\u8C03\u5EA6\u961F\u5217\u3002</li><li>\u5176\u4E2D\u4E00\u4E2A NodeManager \u9886\u53D6\u5230 Task \u4EFB\u52A1\u3002</li><li>\u8BE5 NodeManager \u521B\u5EFA\u5BB9\u5668 Container\uFF0C\u5E76\u4EA7\u751F MRAppmaster\u3002</li><li>Container \u4ECE HDFS \u4E0A\u62F7\u8D1D\u8D44\u6E90\u5230\u672C\u5730\u3002</li><li>MRAppmaster \u5411 RM \u7533\u8BF7\u8FD0\u884C MapTask \u8D44\u6E90\u3002</li><li>RM \u5C06\u8FD0\u884C MapTask \u4EFB\u52A1\u5206\u914D\u7ED9\u53E6\u5916\u4E24\u4E2A NodeManager\uFF0C\u53E6\u4E24\u4E2A NodeManager \u5206\u522B\u9886\u53D6\u4EFB\u52A1\u5E76\u521B\u5EFA\u5BB9\u5668\u3002</li><li>MR \u5411\u4E24\u4E2A\u63A5\u6536\u5230\u4EFB\u52A1\u7684 NodeManager \u53D1\u9001\u7A0B\u5E8F\u542F\u52A8\u811A\u672C\uFF0C\u8FD9\u4E24\u4E2A NodeManager\u5206\u522B\u542F\u52A8 MapTask\uFF0CMapTask \u5BF9\u6570\u636E\u5206\u533A\u6392\u5E8F\u3002</li><li>MrAppMaster \u7B49\u5F85\u6240\u6709 MapTask \u8FD0\u884C\u5B8C\u6BD5\u540E\uFF0C\u5411 RM \u7533\u8BF7\u5BB9\u5668\uFF0C\u8FD0\u884C ReduceTask\u3002</li><li>ReduceTask \u5411 MapTask \u83B7\u53D6\u76F8\u5E94\u5206\u533A\u7684\u6570\u636E\u3002</li><li>\u7A0B\u5E8F\u8FD0\u884C\u5B8C\u6BD5\u540E\uFF0CMR \u4F1A\u5411 RM \u7533\u8BF7\u6CE8\u9500\u81EA\u5DF1\u3002</li></ol><h2 id="yarn-\u8C03\u5EA6\u5668\u548C\u8C03\u5EA6\u7B97\u6CD5" tabindex="-1">Yarn \u8C03\u5EA6\u5668\u548C\u8C03\u5EA6\u7B97\u6CD5 <a class="header-anchor" href="#yarn-\u8C03\u5EA6\u5668\u548C\u8C03\u5EA6\u7B97\u6CD5" aria-hidden="true">#</a></h2><p>\u76EE\u524D\uFF0CHadoop \u4F5C\u4E1A\u8C03\u5EA6\u5668\u4E3B\u8981\u6709\u4E09\u79CD\uFF1AFIFO\u3001\u5BB9\u91CF\uFF08Capacity Scheduler\uFF09\u548C\u516C\u5E73\uFF08Fair Scheduler\uFF09\u3002Apache Hadoop3.1.3 \u9ED8\u8BA4\u7684\u8D44\u6E90\u8C03\u5EA6\u5668\u662F Capacity Scheduler\u3002CDH \u6846\u67B6\u9ED8\u8BA4\u8C03\u5EA6\u5668\u662F Fair Scheduler\u3002</p><h3 id="\u5148\u8FDB\u5148\u51FA\u8C03\u5EA6\u5668-fifo" tabindex="-1">\u5148\u8FDB\u5148\u51FA\u8C03\u5EA6\u5668\uFF08FIFO\uFF09 <a class="header-anchor" href="#\u5148\u8FDB\u5148\u51FA\u8C03\u5EA6\u5668-fifo" aria-hidden="true">#</a></h3><p>FIFO \u8C03\u5EA6\u5668\uFF08First In First Out\uFF09\uFF1A\u5355\u961F\u5217\uFF0C\u6839\u636E\u63D0\u4EA4\u4F5C\u4E1A\u7684\u5148\u540E\u987A\u5E8F\uFF0C\u5148\u6765\u5148\u670D\u52A1\u3002</p><h3 id="\u5BB9\u91CF\u8C03\u5EA6\u5668-capacity-scheduler" tabindex="-1">\u5BB9\u91CF\u8C03\u5EA6\u5668\uFF08Capacity Scheduler\uFF09 <a class="header-anchor" href="#\u5BB9\u91CF\u8C03\u5EA6\u5668-capacity-scheduler" aria-hidden="true">#</a></h3><p><img src="https://img-blog.csdnimg.cn/93c2fa56748541ccbe1b73aaa1ee8a65.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><ol><li>\u591A\u961F\u5217\uFF1A\u6BCF\u4E2A\u961F\u5217\u53EF\u914D\u7F6E\u4E00\u5B9A\u7684\u8D44\u6E90\u91CF\uFF0C\u6BCF\u4E2A\u961F\u5217\u91C7\u7528FIFO\u8C03\u5EA6\u7B56\u7565\u3002</li><li>\u5BB9\u91CF\u4FDD\u8BC1\uFF1A\u7BA1\u7406\u5458\u53EF\u4E3A\u6BCF\u4E2A\u961F\u5217\u8BBE\u7F6E\u8D44\u6E90\u6700\u4F4E\u4FDD\u8BC1\u548C\u8D44\u6E90\u4F7F\u7528\u4E0A\u9650</li><li>\u7075\u6D3B\u6027\uFF1A\u5982\u679C\u4E00\u4E2A\u961F\u5217\u4E2D\u7684\u8D44\u6E90\u6709\u5269\u4F59\uFF0C\u53EF\u4EE5\u6682\u65F6\u5171\u4EAB\u7ED9\u90A3\u4E9B\u9700\u8981\u8D44\u6E90\u7684\u961F\u5217\uFF0C\u800C\u4E00\u65E6\u8BE5\u961F\u5217\u6709\u65B0\u7684\u5E94\u7528\u7A0B\u5E8F\u63D0\u4EA4\uFF0C\u5219\u5176\u4ED6\u961F\u5217\u501F\u8C03\u7684\u8D44\u6E90\u4F1A\u5F52\u8FD8\u7ED9\u8BE5\u961F\u5217\u3002</li><li>\u591A\u79DF\u6237\uFF1A <ul><li>\u652F\u6301\u591A\u7528\u6237\u5171\u4EAB\u96C6\u7FA4\u548C\u591A\u5E94\u7528\u7A0B\u5E8F\u540C\u65F6\u8FD0\u884C\u3002</li><li>\u4E3A\u4E86\u9632\u6B62\u540C\u4E00\u4E2A\u7528\u6237\u7684\u4F5C\u4E1A\u72EC\u5360\u961F\u5217\u4E2D\u7684\u8D44\u6E90\uFF0C\u8BE5\u8C03\u5EA6\u5668\u4F1A\u5BF9\u540C\u4E00\u7528\u6237\u63D0\u4EA4\u7684\u4F5C\u4E1A\u6240\u5360\u8D44\u6E90\u91CF\u8FDB\u884C\u9650\u5B9A\u3002</li></ul></li></ol><p><strong>\u5BB9\u91CF\u8C03\u5EA6\u5668\u8D44\u6E90\u5206\u914D\u7B97\u6CD5</strong></p><p><img src="https://img-blog.csdnimg.cn/6625724dffad459ab6204811ec5482b4.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h3 id="\u516C\u5E73\u8C03\u5EA6\u5668-fair-scheduler" tabindex="-1">\u516C\u5E73\u8C03\u5EA6\u5668\uFF08Fair Scheduler\uFF09 <a class="header-anchor" href="#\u516C\u5E73\u8C03\u5EA6\u5668-fair-scheduler" aria-hidden="true">#</a></h3><h2 id="yarn-\u5E38\u7528\u547D\u4EE4" tabindex="-1">Yarn \u5E38\u7528\u547D\u4EE4 <a class="header-anchor" href="#yarn-\u5E38\u7528\u547D\u4EE4" aria-hidden="true">#</a></h2><p>**\u67E5\u8BE2\u4EFB\u52A1\u5217\u8868 **</p><p><code>yarn application -list -appStates finished</code></p><p>states: [NEW, NEW_SAVING, SUBMITTED, ACCEPTED, RUNNING, FINISHED, FAILED, KILLED]</p><p><img src="https://img-blog.csdnimg.cn/f5b65a284a2144bea9bf3faf03d03e8d.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p><strong>\u6740\u6B7B\u5E94\u7528\u7A0B\u5E8F</strong></p><p><code>yarn application -kill [application ID]</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">yarn application -kill application_1640246979505_0001</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">2021-12-23 17:33:02,104 INFO client.RMProxy: Connecting to ResourceManager at hadoop202/172.31.10.202:8032</span></span>
<span class="line"><span style="color:#A6ACCD;">Application application_1640246979505_0001 has already finished </span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>\u67E5\u770B\u65E5\u5FD7</strong></p><p><code>yarn logs -applicationId application_1640246979505_0001</code></p><p><strong>\u67E5\u770B\u5C1D\u8BD5\u8FD0\u884C\u7684\u4EFB\u52A1</strong></p><p><code>yarn applicationattempt -list application_1640246979505_0002</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">2021-12-23 17:42:29,838 INFO client.RMProxy: Connecting to ResourceManager at hadoop202/172.31.10.202:8032</span></span>
<span class="line"><span style="color:#A6ACCD;">Total number of application attempts :1</span></span>
<span class="line"><span style="color:#A6ACCD;">         ApplicationAttempt-Id	               State	                    AM-Container-Id	                       Tracking-URL</span></span>
<span class="line"><span style="color:#A6ACCD;">appattempt_1640246979505_0002_000001	            FINISHED	container_1640246979505_0002_01_000001	http://hadoop202:8088/proxy/application_1640246979505_0002/</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>ApplicationAttemp \u72B6\u6001</strong></p><p><code>yarn applicationattempt -status appattempt_1640246979505_0002_000001</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">2021-12-23 20:17:51,948 INFO client.RMProxy: Connecting to ResourceManager at hadoop202/172.31.10.202:8032</span></span>
<span class="line"><span style="color:#A6ACCD;">Application Attempt Report </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">	ApplicationAttempt-Id </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> appattempt_1640246979505_0002_000001</span></span>
<span class="line"><span style="color:#A6ACCD;">	State </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> FINISHED</span></span>
<span class="line"><span style="color:#A6ACCD;">	AMContainer </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> container_1640246979505_0002_01_000001</span></span>
<span class="line"><span style="color:#A6ACCD;">	Tracking-URL </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> http://hadoop202:8088/proxy/application_1640246979505_0002/</span></span>
<span class="line"><span style="color:#A6ACCD;">	RPC Port </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> 35243</span></span>
<span class="line"><span style="color:#A6ACCD;">	AM Host </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> hadoop203</span></span>
<span class="line"><span style="color:#A6ACCD;">	Diagnostics </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>\u67E5\u770B container \u65E5\u5FD7</strong></p><p><code>yarn logs -applicationId application_1640246979505_0002 -containerId container_1640246979505_0002_01_000001 </code></p><p><strong>yarn node \u67E5\u770B\u8282\u70B9\u72B6\u6001</strong></p><p><code>yarn node -list all</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">2021-12-23 20:19:35,826 INFO client.RMProxy: Connecting to ResourceManager at hadoop202/172.31.10.202:8032</span></span>
<span class="line"><span style="color:#A6ACCD;">Total Nodes:3</span></span>
<span class="line"><span style="color:#A6ACCD;">         Node-Id	     Node-State	Node-Http-Address	Number-of-Running-Containers</span></span>
<span class="line"><span style="color:#A6ACCD;"> hadoop201:35523	        RUNNING	   hadoop201:8042	                           0</span></span>
<span class="line"><span style="color:#A6ACCD;"> hadoop203:39840	        RUNNING	   hadoop203:8042	                           0</span></span>
<span class="line"><span style="color:#A6ACCD;"> hadoop202:40982	        RUNNING	   hadoop202:8042	                           0</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>yarn rmadmin \u66F4\u65B0\u914D\u7F6E</strong></p><p>\u52A0\u8F7D\u961F\u5217\u914D\u7F6E\uFF1A<code>yarn rmadmin -refreshQueues</code></p><p><strong>yarn queue \u67E5\u770B\u961F\u5217</strong></p><p><code>yarn queue -status default</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">2021-12-23 20:22:16,517 INFO client.RMProxy: Connecting to ResourceManager at hadoop202/172.31.10.202:8032</span></span>
<span class="line"><span style="color:#A6ACCD;">Queue Information </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">Queue Name </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> default</span></span>
<span class="line"><span style="color:#A6ACCD;">	State </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> RUNNING</span></span>
<span class="line"><span style="color:#A6ACCD;">	Capacity </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> 100.0%</span></span>
<span class="line"><span style="color:#A6ACCD;">	Current Capacity </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> .0%</span></span>
<span class="line"><span style="color:#A6ACCD;">	Maximum Capacity </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> 100.0%</span></span>
<span class="line"><span style="color:#A6ACCD;">	Default Node Label expression </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">DEFAULT_PARTITION</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">	Accessible Node Labels </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#A6ACCD;">	Preemption </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> disabled</span></span>
<span class="line"><span style="color:#A6ACCD;">	Intra-queue Preemption </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> disabled</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="yarn-\u751F\u4EA7\u73AF\u5883\u6838\u5FC3\u53C2\u6570" tabindex="-1">Yarn \u751F\u4EA7\u73AF\u5883\u6838\u5FC3\u53C2\u6570 <a class="header-anchor" href="#yarn-\u751F\u4EA7\u73AF\u5883\u6838\u5FC3\u53C2\u6570" aria-hidden="true">#</a></h2><h3 id="resourcemanager-\u76F8\u5173" tabindex="-1">ResourceManager \u76F8\u5173 <a class="header-anchor" href="#resourcemanager-\u76F8\u5173" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:left;">\u914D\u7F6E</th><th style="text-align:left;">\u8BF4\u660E</th></tr></thead><tbody><tr><td style="text-align:left;">yarn.resourcemanager.scheduler.class</td><td style="text-align:left;">\u914D\u7F6E\u8C03\u5EA6\u5668\uFF0C\u9ED8\u8BA4\u5BB9\u91CF</td></tr><tr><td style="text-align:left;">yarn.resourcemanager.scheduler.client.thread-count</td><td style="text-align:left;">ResourceManager\u5904\u7406\u8C03\u5EA6\u5668\u8BF7\u6C42\u7684\u7EBF\u7A0B\u6570\u91CF\uFF0C\u9ED8\u8BA450</td></tr></tbody></table><h3 id="nodemanager-\u76F8\u5173" tabindex="-1">NodeManager \u76F8\u5173 <a class="header-anchor" href="#nodemanager-\u76F8\u5173" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:left;">\u914D\u7F6E</th><th style="text-align:left;">\u8BF4\u660E</th></tr></thead><tbody><tr><td style="text-align:left;">yarn.nodemanager.resource.detect-hardware-capabilities</td><td style="text-align:left;">\u662F\u5426\u8BA9yarn\u81EA\u5DF1\u68C0\u6D4B\u786C\u4EF6\u8FDB\u884C\u914D\u7F6E\uFF0C\u9ED8\u8BA4false</td></tr><tr><td style="text-align:left;">yarn.nodemanager.resource.count-logical-processors-as-cores</td><td style="text-align:left;">\u662F\u5426\u5C06\u865A\u62DF\u6838\u6570\u5F53\u4F5CCPU\u6838\u6570\uFF0C\u9ED8\u8BA4false</td></tr><tr><td style="text-align:left;">yarn.nodemanager.resource.pcores-vcores-multiplier</td><td style="text-align:left;">\u865A\u62DF\u6838\u6570\u548C\u7269\u7406\u6838\u6570\u4E58\u6570\uFF0C\u4F8B\u5982\uFF1A4\u68388\u7EBF\u7A0B\uFF0C\u8BE5\u53C2\u6570\u5C31\u5E94\u8BBE\u4E3A2\uFF0C\u9ED8\u8BA41.0</td></tr><tr><td style="text-align:left;">yarn.nodemanager.resource.memory-mb</td><td style="text-align:left;">NodeManager\u4F7F\u7528\u5185\u5B58\uFF0C\u9ED8\u8BA48G</td></tr><tr><td style="text-align:left;">yarn.nodemanager.resource.system-reserved-memory-mb</td><td style="text-align:left;">NodeManager\u4E3A\u7CFB\u7EDF\u4FDD\u7559\u591A\u5C11\u5185\u5B58,\u4EE5\u4E0A\u4E8C\u4E2A\u53C2\u6570\u914D\u7F6E\u4E00\u4E2A\u5373\u53EF</td></tr><tr><td style="text-align:left;">yarn.nodemanager.resource.cpu-vcores</td><td style="text-align:left;">NodeManager\u4F7F\u7528CPU\u6838\u6570\uFF0C\u9ED8\u8BA48\u4E2A</td></tr><tr><td style="text-align:left;">yarn.nodemanager.pmem-check-enabled</td><td style="text-align:left;">\u662F\u5426\u5F00\u542F\u7269\u7406\u5185\u5B58\u68C0\u67E5\u9650\u5236container\uFF0C\u9ED8\u8BA4\u6253\u5F00</td></tr><tr><td style="text-align:left;">yarn.nodemanager.vmem-check-enabled</td><td style="text-align:left;">\u662F\u5426\u5F00\u542F\u865A\u62DF\u5185\u5B58\u68C0\u67E5\u9650\u5236container\uFF0C\u9ED8\u8BA4\u6253\u5F00</td></tr><tr><td style="text-align:left;">yarn.nodemanager.vmem-pmem-ratio</td><td style="text-align:left;">\u865A\u62DF\u5185\u5B58\u7269\u7406\u5185\u5B58\u6BD4\u4F8B\uFF0C\u9ED8\u8BA42.1</td></tr></tbody></table><h3 id="containe-\u76F8\u5173" tabindex="-1">Containe \u76F8\u5173 <a class="header-anchor" href="#containe-\u76F8\u5173" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:left;">\u914D\u7F6E</th><th style="text-align:left;">\u8BF4\u660E</th></tr></thead><tbody><tr><td style="text-align:left;">yarn.scheduler.minimum-allocation-mb</td><td style="text-align:left;">\u5BB9\u5668\u6700\u6700\u5C0F\u5185\u5B58\uFF0C\u9ED8\u8BA41G</td></tr><tr><td style="text-align:left;">yarn.scheduler.maximum-allocation-mb</td><td style="text-align:left;">\u5BB9\u5668\u6700\u6700\u5927\u5185\u5B58\uFF0C\u9ED8\u8BA48G</td></tr><tr><td style="text-align:left;">yarn.scheduler.minimum-allocation-vcores</td><td style="text-align:left;">\u5BB9\u5668\u6700\u5C0FCPU\u6838\u6570\uFF0C\u9ED8\u8BA41\u4E2A</td></tr><tr><td style="text-align:left;">yarn.scheduler.maximum-allocation-vcores</td><td style="text-align:left;">\u5BB9\u5668\u6700\u5927CPU\u6838\u6570\uFF0C\u9ED8\u8BA44\u4E2A</td></tr></tbody></table><h2 id="tools" tabindex="-1">Tools <a class="header-anchor" href="#tools" aria-hidden="true">#</a></h2><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">util</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Tool</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">conf</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Configuration</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WordCountTools</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">implements</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Tool</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">run</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">Job</span><span style="color:#A6ACCD;"> job </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getInstance</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> job</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">waitForCompletion</span><span style="color:#89DDFF;">(true)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setConf</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> conf</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getConf</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> conf</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">conf</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Configuration</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">util</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Tool</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hadoop</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">util</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">ToolRunner</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">util</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Arrays</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WordCountDriver</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Tool</span><span style="color:#A6ACCD;"> tool</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 1. \u521B\u5EFA\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 2. \u5224\u65AD\u662F\u5426\u6709 tool \u63A5\u53E3</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">switch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">]){</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">case</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">wordcount</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">                tool </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">WordCountTools</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">break</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">default:</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">throw</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">RuntimeException</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> No such tool: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> args</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 3. \u7528 Tool \u6267\u884C\u7A0B\u5E8F</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// Arrays.copyOfRange \u5C06\u8001\u6570\u7EC4\u7684\u5143\u7D20\u653E\u5230\u65B0\u6570\u7EC4\u91CC\u9762</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> run </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ToolRunner</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">run</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> tool</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Arrays</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">copyOfRange</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> args</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">        System</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">exit</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">run</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><div class="language-shell script"><button title="Copy Code" class="copy"></button><span class="lang">shell script</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">yarn jar hello-yarn.jar com.laoshiren.hello.yarn.tools.WordCountDriver wordcount /input /output</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div>`,420),o=[e];function r(c,t,i,D,y,F){return n(),a("div",null,o)}const d=s(p,[["render",r]]);export{C as __pageData,d as default};
